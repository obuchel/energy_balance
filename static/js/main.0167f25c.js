/*! For license information please see main.0167f25c.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)s.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:a,_owner:o.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var w=b.prototype=new y;w.constructor=b,m(w,v.prototype),w.isPureReactComponent=!0;var _=Array.isArray,x=Object.prototype.hasOwnProperty,S={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var i,a={},s=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(s=""+t.key),t)x.call(t,i)&&!k.hasOwnProperty(i)&&(a[i]=t[i]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:n,type:e,key:s,ref:o,props:a,_owner:S.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var N=/\/+/g;function T(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,i,a,s){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return s=s(l=e),e=""===a?"."+T(l,0):a,_(s)?(i="",null!=e&&(i=e.replace(N,"$&/")+"/"),I(s,t,i,"",(function(e){return e}))):null!=s&&(C(s)&&(s=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(N,"$&/")+"/")+e)),t.push(s)),1;if(l=0,a=""===a?".":a+":",_(e))for(var c=0;c<e.length;c++){var u=a+T(o=e[c],c);l+=I(o,t,i,u,s)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=I(o=o.value,t,i,u=a+T(o,c++),s);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var r=[],i=0;return I(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function j(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},P={transition:null},R={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:P,ReactCurrentOwner:S};function O(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=s,t.PureComponent=b,t.StrictMode=a,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=O,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),a=e.key,s=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,o=S.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)x.call(t,c)&&!k.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:a,ref:s,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:j}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=O,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,s=i>>>1;r<s;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>a(l,n))c<i&&0>a(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>a(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function _(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,P(x);else{var t=r(u);null!==t&&R(_,t.startTime-e)}}function x(e,n){m=!1,g&&(g=!1,y(C),C=-1),p=!0;var a=f;try{for(w(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!I());){var s=d.callback;if("function"===typeof s){d.callback=null,f=d.priorityLevel;var o=s(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?d.callback=o:d===r(c)&&i(c),w(n)}else i(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&R(_,h.startTime-n),l=!1}return l}finally{d=null,f=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,k=!1,E=null,C=-1,N=5,T=-1;function I(){return!(t.unstable_now()-T<N)}function A(){if(null!==E){var e=t.unstable_now();T=e;var n=!0;try{n=E(!0,e)}finally{n?S():(k=!1,E=null)}}else k=!1}if("function"===typeof b)S=function(){b(A)};else if("undefined"!==typeof MessageChannel){var j=new MessageChannel,D=j.port2;j.port1.onmessage=A,S=function(){D.postMessage(null)}}else S=function(){v(A,0)};function P(e){E=e,k||(k=!0,S())}function R(e,n){C=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,P(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>s?(e.sortIndex=a,n(u,e),null===r(c)&&e===r(u)&&(g?(y(C),C=-1):g=!0,R(_,a-s))):(e.sortIndex=o,n(c,e),m||p||(m=!0,P(x))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),i=n(853);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)s.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,a,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),x=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),N=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function O(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var L,M=Object.assign;function F(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var U=!1;function V(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),a=r.stack.split("\n"),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(1!==s||1!==o)do{if(s--,0>--o||i[s]!==a[o]){var l="\n"+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=s&&0<=o);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function z(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case x:return"Portal";case E:return"Profiler";case k:return"StrictMode";case I:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case N:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case j:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(Ds){return e.body}}function Y(e,t){var n=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function X(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function $(e,t){J(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ae(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function se(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var xe=null,Se=null,ke=null;function Ee(e){if(e=bi(e)){if("function"!==typeof xe)throw Error(a(280));var t=e.stateNode;t&&(t=_i(t),xe(e.stateNode,e.type,t))}}function Ce(e){Se?ke?ke.push(e):ke=[e]:Se=e}function Ne(){if(Se){var e=Se,t=ke;if(ke=Se=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Te(e,t){return e(t)}function Ie(){}var Ae=!1;function je(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Te(e,t,n)}finally{Ae=!1,(null!==Se||null!==ke)&&(Ie(),Ne())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var r=_i(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Pe=!1;if(u)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(ue){Pe=!1}function Oe(e,t,n,r,i,a,s,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Le=!1,Me=null,Fe=!1,Ue=null,Ve={onError:function(e){Le=!0,Me=e}};function ze(e,t,n,r,i,a,s,o,l){Le=!1,Me=null,Oe.apply(Ve,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Be(e)!==e)throw Error(a(188))}function We(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(r=i.return)){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return He(i),e;if(s===r)return He(i),t;s=s.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e),null!==e?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Xe=i.unstable_requestPaint,Je=i.unstable_now,$e=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,at=null;var st=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,s=268435455&n;if(0!==s){var o=s&~i;0!==o?r=ht(o):0!==(a&=s)&&(r=ht(a))}else 0!==(s=n&~i)?r=ht(s):0!==a&&(r=ht(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-st(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-st(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-st(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,xt,St,kt,Et,Ct=!1,Nt=[],Tt=null,It=null,At=null,jt=new Map,Dt=new Map,Pt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":Tt=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":jt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Lt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&xt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Mt(e){var t=yi(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void Et(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&xt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Ut(e,t,n){Ft(e)&&n.delete(t)}function Vt(){Ct=!1,null!==Tt&&Ft(Tt)&&(Tt=null),null!==It&&Ft(It)&&(It=null),null!==At&&Ft(At)&&(At=null),jt.forEach(Ut),Dt.forEach(Ut)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Vt)))}function Bt(e){function t(t){return zt(t,e)}if(0<Nt.length){zt(Nt[0],e);for(var n=1;n<Nt.length;n++){var r=Nt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Tt&&zt(Tt,e),null!==It&&zt(It,e),null!==At&&zt(At,e),jt.forEach(t),Dt.forEach(t),n=0;n<Pt.length;n++)(r=Pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Mt(n),null===n.blockedOn&&Pt.shift()}var qt=w.ReactCurrentBatchConfig,Ht=!0;function Wt(e,t,n,r){var i=bt,a=qt.transition;qt.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=i,qt.transition=a}}function Gt(e,t,n,r){var i=bt,a=qt.transition;qt.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=i,qt.transition=a}}function Kt(e,t,n,r){if(Ht){var i=Yt(e,t,n,r);if(null===i)Hr(e,t,r,Qt,n),Ot(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Tt=Lt(Tt,e,t,n,r,i),!0;case"dragenter":return It=Lt(It,e,t,n,r,i),!0;case"mouseover":return At=Lt(At,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return jt.set(a,Lt(jt.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Dt.set(a,Lt(Dt.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<Rt.indexOf(e)){for(;null!==i;){var a=bi(i);if(null!==a&&_t(a),null===(a=Yt(e,t,n,r))&&Hr(e,t,r,Qt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Qt=null;function Yt(e,t,n,r){if(Qt=null,null!==(e=yi(e=_e(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,$t=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=$t,r=n.length,i="value"in Jt?Jt.value:Jt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var s=r-e;for(t=1;t<=s&&n[r-t]===i[a-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,i,a){for(var s in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var sn,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=an(cn),hn=M({},cn,{view:0,detail:0}),dn=an(hn),fn=M({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(sn=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=sn=0,ln=e),sn)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=an(fn),mn=an(M({},fn,{dataTransfer:0})),gn=an(M({},hn,{relatedTarget:0})),vn=an(M({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=M({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(yn),wn=an(M({},cn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function En(){return kn}var Cn=M({},hn,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Nn=an(Cn),Tn=an(M({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=an(M({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),An=an(M({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),jn=M({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=an(jn),Pn=[9,13,27,32],Rn=u&&"CompositionEvent"in window,On=null;u&&"documentMode"in document&&(On=document.documentMode);var Ln=u&&"TextEvent"in window&&!On,Mn=u&&(!Rn||On&&8<On&&11>=On),Fn=String.fromCharCode(32),Un=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Wn(e,t,n,r){Ce(r),0<(t=Gr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,Kn=null;function Qn(e){Fr(e,0)}function Yn(e){if(K(wi(e)))return e}function Xn(e,t){if("change"===e)return t}var Jn=!1;if(u){var $n;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}$n=Zn}else $n=!1;Jn=$n&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),Kn=Gn=null)}function nr(e){if("value"===e.propertyName&&Yn(Kn)){var t=[];Wn(t,Kn,e,_e(e)),je(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Kn)}function ar(e,t){if("click"===e)return Yn(t)}function sr(e,t){if("input"===e||"change"===e)return Yn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!or(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=ur(n,a);var s=ur(n,r);i&&s&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,vr=null,yr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==Q(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Gr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function _r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var xr={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},Sr={},kr={};function Er(e){if(Sr[e])return Sr[e];if(!xr[e])return e;var t,n=xr[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return Sr[e]=n[t];return e}u&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete xr.animationend.animation,delete xr.animationiteration.animation,delete xr.animationstart.animation),"TransitionEvent"in window||delete xr.transitionend.transition);var Cr=Er("animationend"),Nr=Er("animationiteration"),Tr=Er("animationstart"),Ir=Er("transitionend"),Ar=new Map,jr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Ar.set(e,t),l(t,[e])}for(var Pr=0;Pr<jr.length;Pr++){var Rr=jr[Pr];Dr(Rr.toLowerCase(),"on"+(Rr[0].toUpperCase()+Rr.slice(1)))}Dr(Cr,"onAnimationEnd"),Dr(Nr,"onAnimationIteration"),Dr(Tr,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(Ir,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Mr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,s,o,l,c){if(ze.apply(this,arguments),Le){if(!Le)throw Error(a(198));var u=Me;Le=!1,Me=null,Fe||(Fe=!0,Ue=u)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var s=r.length-1;0<=s;s--){var o=r[s],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;Mr(i,o,c),a=l}else for(s=0;s<r.length;s++){if(l=(o=r[s]).instance,c=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;Mr(i,o,c),a=l}}}if(Fe)throw e=Ue,Fe=!1,Ue=null,e}function Ur(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(qr(t,e,2,!1),n.add(r))}function Vr(e,t,n){var r=0;t&&(r|=4),qr(n,e,r,t)}var zr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[zr]){e[zr]=!0,s.forEach((function(t){"selectionchange"!==t&&(Lr.has(t)||Vr(t,!1,e),Vr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zr]||(t[zr]=!0,Vr("selectionchange",!1,t))}}function qr(e,t,n,r){switch(Xt(t)){case 1:var i=Wt;break;case 4:i=Gt;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var s=r.tag;if(3===s||4===s){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===s)for(s=r.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;s=s.return}for(;null!==o;){if(null===(s=yi(o)))return;if(5===(l=s.tag)||6===l){r=a=s;continue e}o=o.parentNode}}r=r.return}je((function(){var r=a,i=_e(n),s=[];e:{var o=Ar.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Nn;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=In;break;case Cr:case Nr:case Tr:l=vn;break;case Ir:l=An;break;case"scroll":l=dn;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=De(p,d))&&u.push(Wr(p,m,f)))),h)break;p=p.return}0<u.length&&(o=new l(o,c,null,n,i),s.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!yi(c)&&!c[pi])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?yi(c):null)&&(c!==(h=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Tn,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?o:wi(l),f=null==c?o:wi(c),(o=new u(m,p+"leave",l,n,i)).target=h,o.relatedTarget=f,m=null,yi(i)===r&&((u=new u(d,p+"enter",c,n,i)).target=f,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Kr(f))p++;for(f=0,m=d;m;m=Kr(m))f++;for(;0<p-f;)u=Kr(u),p--;for(;0<f-p;)d=Kr(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Kr(u),d=Kr(d)}u=null}else u=null;null!==l&&Qr(s,o,l,u,!1),null!==c&&null!==h&&Qr(s,h,c,u,!0)}if("select"===(l=(o=r?wi(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Xn;else if(Hn(o))if(Jn)g=sr;else{g=ir;var v=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=ar);switch(g&&(g=g(e,r))?Wn(s,g,n,i):(v&&v(e,o,r),"focusout"===e&&(v=o._wrapperState)&&v.controlled&&"number"===o.type&&ee(o,"number",o.value)),v=r?wi(r):window,e){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(gr=v,vr=r,yr=null);break;case"focusout":yr=vr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(s,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(s,n,i)}var y;if(Rn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Bn?Vn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Mn&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Bn&&(y=en()):($t="value"in(Jt=i)?Jt.value:Jt.textContent,Bn=!0)),0<(v=Gr(r,b)).length&&(b=new wn(b,e,null,n,i),s.push({event:b,listeners:v}),y?b.data=y:null!==(y=zn(n))&&(b.data=y))),(y=Ln?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Un=!0,Fn);case"textInput":return(e=t.data)===Fn&&Un?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Rn&&Vn(e,t)?(e=en(),Zt=$t=Jt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),s.push({event:i,listeners:r}),i.data=y))}Fr(s,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=De(e,n))&&r.unshift(Wr(e,a,i)),null!=(a=De(e,t))&&r.push(Wr(e,a,i))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var a=t._reactName,s=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,i?null!=(l=De(n,a))&&s.unshift(Wr(n,l,o)):i||null!=(l=De(n,a))&&s.push(Wr(n,l,o))),n=n.return}0!==s.length&&e.push({event:t,listeners:s})}var Yr=/\r\n?/g,Xr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Yr,"\n").replace(Xr,"")}function $r(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(a(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,si="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(oi)}:ri;function oi(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Bt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,pi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,vi="__reactHandles$"+hi;function yi(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[di])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[di]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function _i(e){return e[fi]||null}var xi=[],Si=-1;function ki(e){return{current:e}}function Ei(e){0>Si||(e.current=xi[Si],xi[Si]=null,Si--)}function Ci(e,t){Si++,xi[Si]=e.current,e.current=t}var Ni={},Ti=ki(Ni),Ii=ki(!1),Ai=Ni;function ji(e,t){var n=e.type.contextTypes;if(!n)return Ni;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Di(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pi(){Ei(Ii),Ei(Ti)}function Ri(e,t,n){if(Ti.current!==Ni)throw Error(a(168));Ci(Ti,t),Ci(Ii,n)}function Oi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,q(e)||"Unknown",i));return M({},n,r)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ni,Ai=Ti.current,Ci(Ti,e),Ci(Ii,Ii.current),!0}function Mi(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Oi(e,t,Ai),r.__reactInternalMemoizedMergedChildContext=e,Ei(Ii),Ei(Ti),Ci(Ti,e)):Ei(Ii),Ci(Ii,n)}var Fi=null,Ui=!1,Vi=!1;function zi(e){null===Fi?Fi=[e]:Fi.push(e)}function Bi(){if(!Vi&&null!==Fi){Vi=!0;var e=0,t=bt;try{var n=Fi;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fi=null,Ui=!1}catch(i){throw null!==Fi&&(Fi=Fi.slice(e+1)),Ke(Ze,Bi),i}finally{bt=t,Vi=!1}}return null}var qi=[],Hi=0,Wi=null,Gi=0,Ki=[],Qi=0,Yi=null,Xi=1,Ji="";function $i(e,t){qi[Hi++]=Gi,qi[Hi++]=Wi,Wi=e,Gi=t}function Zi(e,t,n){Ki[Qi++]=Xi,Ki[Qi++]=Ji,Ki[Qi++]=Yi,Yi=e;var r=Xi;e=Ji;var i=32-st(r)-1;r&=~(1<<i),n+=1;var a=32-st(t)+i;if(30<a){var s=i-i%5;a=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Xi=1<<32-st(t)+i|n<<i|r,Ji=a+e}else Xi=1<<a|n<<i|r,Ji=e}function ea(e){null!==e.return&&($i(e,1),Zi(e,1,0))}function ta(e){for(;e===Wi;)Wi=qi[--Hi],qi[Hi]=null,Gi=qi[--Hi],qi[Hi]=null;for(;e===Yi;)Yi=Ki[--Qi],Ki[Qi]=null,Ji=Ki[--Qi],Ki[Qi]=null,Xi=Ki[--Qi],Ki[Qi]=null}var na=null,ra=null,ia=!1,aa=null;function sa(e,t){var n=Dc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Yi?{id:Xi,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Dc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(ia){var t=ra;if(t){var n=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=ci(n.nextSibling);var r=na;t&&oa(e,t)?sa(r,n):(e.flags=-4097&e.flags|2,ia=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,na=e}}}function ua(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function ha(e){if(e!==na)return!1;if(!ia)return ua(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ra)){if(la(e))throw da(),Error(a(418));for(;t;)sa(e,t),t=ci(t.nextSibling)}if(ua(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?ci(e.stateNode.nextSibling):null;return!0}function da(){for(var e=ra;e;)e=ci(e.nextSibling)}function fa(){ra=na=null,ia=!1}function pa(e){null===aa?aa=[e]:aa.push(e)}var ma=w.ReactCurrentBatchConfig;function ga(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,s=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===s?t.ref:(t=function(e){var t=i.refs;null===e?delete t[s]:t[s]=e},t._stringRef=s,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function va(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ya(e){return(0,e._init)(e._payload)}function ba(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function s(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Fc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===S?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===D&&ya(a)===t.type)?((r=i(t,n.props)).ref=ga(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=ga(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,a){return null===t||7!==t.tag?((t=Lc(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Fc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=ga(e,null,t),n.return=e,n;case x:return(t=Uc(t,e.mode,n)).return=e,t;case D:return d(e,(0,t._init)(t._payload),n)}if(te(t)||O(t))return(t=Lc(t,e.mode,n,null)).return=e,t;va(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===i?c(e,t,n,r):null;case x:return n.key===i?u(e,t,n,r):null;case D:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||O(n))return null!==i?null:h(e,t,n,r,null);va(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case x:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case D:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||O(r))return h(t,e=e.get(n)||null,r,i,null);va(t,r)}return null}function m(i,a,o,l){for(var c=null,u=null,h=a,m=a=0,g=null;null!==h&&m<o.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=f(i,h,o[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(i,h),a=s(v,a,m),null===u?c=v:u.sibling=v,u=v,h=g}if(m===o.length)return n(i,h),ia&&$i(i,m),c;if(null===h){for(;m<o.length;m++)null!==(h=d(i,o[m],l))&&(a=s(h,a,m),null===u?c=h:u.sibling=h,u=h);return ia&&$i(i,m),c}for(h=r(i,h);m<o.length;m++)null!==(g=p(h,i,m,o[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),a=s(g,a,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach((function(e){return t(i,e)})),ia&&$i(i,m),c}function g(i,o,l,c){var u=O(l);if("function"!==typeof u)throw Error(a(150));if(null==(l=u.call(l)))throw Error(a(151));for(var h=u=null,m=o,g=o=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=f(i,m,y.value,c);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(i,m),o=s(b,o,g),null===h?u=b:h.sibling=b,h=b,m=v}if(y.done)return n(i,m),ia&&$i(i,g),u;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(i,y.value,c))&&(o=s(y,o,g),null===h?u=y:h.sibling=y,h=y);return ia&&$i(i,g),u}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=p(m,i,g,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),o=s(y,o,g),null===h?u=y:h.sibling=y,h=y);return e&&m.forEach((function(e){return t(i,e)})),ia&&$i(i,g),u}return function e(r,a,s,l){if("object"===typeof s&&null!==s&&s.type===S&&null===s.key&&(s=s.props.children),"object"===typeof s&&null!==s){switch(s.$$typeof){case _:e:{for(var c=s.key,u=a;null!==u;){if(u.key===c){if((c=s.type)===S){if(7===u.tag){n(r,u.sibling),(a=i(u,s.props.children)).return=r,r=a;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&ya(c)===u.type){n(r,u.sibling),(a=i(u,s.props)).ref=ga(r,u,s),a.return=r,r=a;break e}n(r,u);break}t(r,u),u=u.sibling}s.type===S?((a=Lc(s.props.children,r.mode,l,s.key)).return=r,r=a):((l=Oc(s.type,s.key,s.props,null,r.mode,l)).ref=ga(r,a,s),l.return=r,r=l)}return o(r);case x:e:{for(u=s.key;null!==a;){if(a.key===u){if(4===a.tag&&a.stateNode.containerInfo===s.containerInfo&&a.stateNode.implementation===s.implementation){n(r,a.sibling),(a=i(a,s.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Uc(s,r.mode,l)).return=r,r=a}return o(r);case D:return e(r,a,(u=s._init)(s._payload),l)}if(te(s))return m(r,a,s,l);if(O(s))return g(r,a,s,l);va(r,s)}return"string"===typeof s&&""!==s||"number"===typeof s?(s=""+s,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,s)).return=r,r=a):(n(r,a),(a=Fc(s,r.mode,l)).return=r,r=a),o(r)):n(r,a)}}var wa=ba(!0),_a=ba(!1),xa=ki(null),Sa=null,ka=null,Ea=null;function Ca(){Ea=ka=Sa=null}function Na(e){var t=xa.current;Ei(xa),e._currentValue=t}function Ta(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ia(e,t){Sa=e,Ea=ka=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(wo=!0),e.firstContext=null)}function Aa(e){var t=e._currentValue;if(Ea!==e)if(e={context:e,memoizedValue:t,next:null},null===ka){if(null===Sa)throw Error(a(308));ka=e,Sa.dependencies={lanes:0,firstContext:e}}else ka=ka.next=e;return t}var ja=null;function Da(e){null===ja?ja=[e]:ja.push(e)}function Pa(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Da(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ra(e,r)}function Ra(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Oa=!1;function La(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ma(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ua(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Il)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ra(e,n)}return null===(i=r.interleaved)?(t.next=t,Da(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ra(e,n)}function Va(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function za(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=s:a=a.next=s,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ba(e,t,n,r){var i=e.updateQueue;Oa=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===s?a=c:s.next=c,s=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==s&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==a){var h=i.baseState;for(s=0,u=c=l=null,o=a;;){var d=o.lane,f=o.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(d=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break e;h=M({},h,d);break e;case 2:Oa=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,s|=d;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(d=o).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{s|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Ml|=s,e.lanes=s,e.memoizedState=h}}function qa(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var Ha={},Wa=ki(Ha),Ga=ki(Ha),Ka=ki(Ha);function Qa(e){if(e===Ha)throw Error(a(174));return e}function Ya(e,t){switch(Ci(Ka,t),Ci(Ga,e),Ci(Wa,Ha),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ei(Wa),Ci(Wa,t)}function Xa(){Ei(Wa),Ei(Ga),Ei(Ka)}function Ja(e){Qa(Ka.current);var t=Qa(Wa.current),n=le(t,e.type);t!==n&&(Ci(Ga,e),Ci(Wa,n))}function $a(e){Ga.current===e&&(Ei(Wa),Ei(Ga))}var Za=ki(0);function es(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ts=[];function ns(){for(var e=0;e<ts.length;e++)ts[e]._workInProgressVersionPrimary=null;ts.length=0}var rs=w.ReactCurrentDispatcher,is=w.ReactCurrentBatchConfig,as=0,ss=null,os=null,ls=null,cs=!1,us=!1,hs=0,ds=0;function fs(){throw Error(a(321))}function ps(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function ms(e,t,n,r,i,s){if(as=s,ss=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,rs.current=null===e||null===e.memoizedState?Zs:eo,e=n(r,i),us){s=0;do{if(us=!1,hs=0,25<=s)throw Error(a(301));s+=1,ls=os=null,t.updateQueue=null,rs.current=to,e=n(r,i)}while(us)}if(rs.current=$s,t=null!==os&&null!==os.next,as=0,ls=os=ss=null,cs=!1,t)throw Error(a(300));return e}function gs(){var e=0!==hs;return hs=0,e}function vs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ls?ss.memoizedState=ls=e:ls=ls.next=e,ls}function ys(){if(null===os){var e=ss.alternate;e=null!==e?e.memoizedState:null}else e=os.next;var t=null===ls?ss.memoizedState:ls.next;if(null!==t)ls=t,os=e;else{if(null===e)throw Error(a(310));e={memoizedState:(os=e).memoizedState,baseState:os.baseState,baseQueue:os.baseQueue,queue:os.queue,next:null},null===ls?ss.memoizedState=ls=e:ls=ls.next=e}return ls}function bs(e,t){return"function"===typeof t?t(e):t}function ws(e){var t=ys(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=os,i=r.baseQueue,s=n.pending;if(null!==s){if(null!==i){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(null!==i){s=i.next,r=r.baseState;var l=o=null,c=null,u=s;do{var h=u.lane;if((as&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,o=r):c=c.next=d,ss.lanes|=h,Ml|=h}u=u.next}while(null!==u&&u!==s);null===c?o=r:c.next=l,or(r,t.memoizedState)||(wo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{s=i.lane,ss.lanes|=s,Ml|=s,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function _s(e){var t=ys(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{s=e(s,o.action),o=o.next}while(o!==i);or(s,t.memoizedState)||(wo=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function xs(){}function Ss(e,t){var n=ss,r=ys(),i=t(),s=!or(r.memoizedState,i);if(s&&(r.memoizedState=i,wo=!0),r=r.queue,Ls(Cs.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||null!==ls&&1&ls.memoizedState.tag){if(n.flags|=2048,As(9,Es.bind(null,n,r,i,t),void 0,null),null===Al)throw Error(a(349));0!==(30&as)||ks(n,t,i)}return i}function ks(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Es(e,t,n,r){t.value=n,t.getSnapshot=r,Ns(t)&&Ts(e)}function Cs(e,t,n){return n((function(){Ns(t)&&Ts(e)}))}function Ns(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Ts(e){var t=Ra(e,1);null!==t&&rc(t,e,1,-1)}function Is(e){var t=vs();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bs,lastRenderedState:e},t.queue=e,e=e.dispatch=Qs.bind(null,ss,e),[t.memoizedState,e]}function As(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ss.updateQueue)?(t={lastEffect:null,stores:null},ss.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function js(){return ys().memoizedState}function Ps(e,t,n,r){var i=vs();ss.flags|=e,i.memoizedState=As(1|t,n,void 0,void 0===r?null:r)}function Rs(e,t,n,r){var i=ys();r=void 0===r?null:r;var a=void 0;if(null!==os){var s=os.memoizedState;if(a=s.destroy,null!==r&&ps(r,s.deps))return void(i.memoizedState=As(t,n,a,r))}ss.flags|=e,i.memoizedState=As(1|t,n,a,r)}function Os(e,t){return Ps(8390656,8,e,t)}function Ls(e,t){return Rs(2048,8,e,t)}function Ms(e,t){return Rs(4,2,e,t)}function Fs(e,t){return Rs(4,4,e,t)}function Us(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Vs(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Rs(4,4,Us.bind(null,t,e),n)}function zs(){}function Bs(e,t){var n=ys();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ps(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function qs(e,t){var n=ys();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ps(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Hs(e,t,n){return 0===(21&as)?(e.baseState&&(e.baseState=!1,wo=!0),e.memoizedState=n):(or(n,t)||(n=mt(),ss.lanes|=n,Ml|=n,e.baseState=!0),t)}function Ws(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=is.transition;is.transition={};try{e(!1),t()}finally{bt=n,is.transition=r}}function Gs(){return ys().memoizedState}function Ks(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ys(e))Xs(t,n);else if(null!==(n=Pa(e,t,n,r))){rc(n,e,r,tc()),Js(n,t,r)}}function Qs(e,t,n){var r=nc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ys(e))Xs(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,n);if(i.hasEagerState=!0,i.eagerState=o,or(o,s)){var l=t.interleaved;return null===l?(i.next=i,Da(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Pa(e,t,i,r))&&(rc(n,e,r,i=tc()),Js(n,t,r))}}function Ys(e){var t=e.alternate;return e===ss||null!==t&&t===ss}function Xs(e,t){us=cs=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Js(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var $s={readContext:Aa,useCallback:fs,useContext:fs,useEffect:fs,useImperativeHandle:fs,useInsertionEffect:fs,useLayoutEffect:fs,useMemo:fs,useReducer:fs,useRef:fs,useState:fs,useDebugValue:fs,useDeferredValue:fs,useTransition:fs,useMutableSource:fs,useSyncExternalStore:fs,useId:fs,unstable_isNewReconciler:!1},Zs={readContext:Aa,useCallback:function(e,t){return vs().memoizedState=[e,void 0===t?null:t],e},useContext:Aa,useEffect:Os,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Ps(4194308,4,Us.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ps(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ps(4,2,e,t)},useMemo:function(e,t){var n=vs();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vs();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ks.bind(null,ss,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vs().memoizedState=e},useState:Is,useDebugValue:zs,useDeferredValue:function(e){return vs().memoizedState=e},useTransition:function(){var e=Is(!1),t=e[0];return e=Ws.bind(null,e[1]),vs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ss,i=vs();if(ia){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Al)throw Error(a(349));0!==(30&as)||ks(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,Os(Cs.bind(null,r,s,e),[e]),r.flags|=2048,As(9,Es.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=vs(),t=Al.identifierPrefix;if(ia){var n=Ji;t=":"+t+"R"+(n=(Xi&~(1<<32-st(Xi)-1)).toString(32)+n),0<(n=hs++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ds++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},eo={readContext:Aa,useCallback:Bs,useContext:Aa,useEffect:Ls,useImperativeHandle:Vs,useInsertionEffect:Ms,useLayoutEffect:Fs,useMemo:qs,useReducer:ws,useRef:js,useState:function(){return ws(bs)},useDebugValue:zs,useDeferredValue:function(e){return Hs(ys(),os.memoizedState,e)},useTransition:function(){return[ws(bs)[0],ys().memoizedState]},useMutableSource:xs,useSyncExternalStore:Ss,useId:Gs,unstable_isNewReconciler:!1},to={readContext:Aa,useCallback:Bs,useContext:Aa,useEffect:Ls,useImperativeHandle:Vs,useInsertionEffect:Ms,useLayoutEffect:Fs,useMemo:qs,useReducer:_s,useRef:js,useState:function(){return _s(bs)},useDebugValue:zs,useDeferredValue:function(e){var t=ys();return null===os?t.memoizedState=e:Hs(t,os.memoizedState,e)},useTransition:function(){return[_s(bs)[0],ys().memoizedState]},useMutableSource:xs,useSyncExternalStore:Ss,useId:Gs,unstable_isNewReconciler:!1};function no(e,t){if(e&&e.defaultProps){for(var n in t=M({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function ro(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var io={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),a=Fa(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,i))&&(rc(t,e,i,r),Va(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),a=Fa(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ua(e,a,i))&&(rc(t,e,i,r),Va(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),i=Fa(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Ua(e,i,r))&&(rc(t,e,r,n),Va(t,e,r))}};function ao(e,t,n,r,i,a,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,s):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,a))}function so(e,t,n){var r=!1,i=Ni,a=t.contextType;return"object"===typeof a&&null!==a?a=Aa(a):(i=Di(t)?Ai:Ti.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?ji(e,i):Ni),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=io,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function oo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&io.enqueueReplaceState(t,t.state,null)}function lo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},La(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Aa(a):(a=Di(t)?Ai:Ti.current,i.context=ji(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(ro(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&io.enqueueReplaceState(i,i.state,null),Ba(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function co(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function uo(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ho(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var fo="function"===typeof WeakMap?WeakMap:Map;function po(e,t,n){(n=Fa(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,Gl=r),ho(0,t)},n}function mo(e,t,n){(n=Fa(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ho(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){ho(0,t),"function"!==typeof r&&(null===Kl?Kl=new Set([this]):Kl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function go(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fo;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Cc.bind(null,e,t,n),t.then(e,e))}function vo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fa(-1,1)).tag=2,Ua(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var bo=w.ReactCurrentOwner,wo=!1;function _o(e,t,n,r){t.child=null===e?_a(t,null,n,r):wa(t,e.child,n,r)}function xo(e,t,n,r,i){n=n.render;var a=t.ref;return Ia(t,i),r=ms(e,t,n,r,a,i),n=gs(),null===e||wo?(ia&&n&&ea(t),t.flags|=1,_o(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wo(e,t,i))}function So(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Pc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,ko(e,t,a,r,i))}if(a=e.child,0===(e.lanes&i)){var s=a.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(s,r)&&e.ref===t.ref)return Wo(e,t,i)}return t.flags|=1,(e=Rc(a,r)).ref=t.ref,e.return=t,t.child=e}function ko(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(lr(a,r)&&e.ref===t.ref){if(wo=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,Wo(e,t,i);0!==(131072&e.flags)&&(wo=!0)}}return No(e,t,n,r,i)}function Eo(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ci(Rl,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ci(Rl,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ci(Rl,Pl),Pl|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ci(Rl,Pl),Pl|=r;return _o(e,t,i,n),t.child}function Co(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function No(e,t,n,r,i){var a=Di(n)?Ai:Ti.current;return a=ji(t,a),Ia(t,i),n=ms(e,t,n,r,a,i),r=gs(),null===e||wo?(ia&&r&&ea(t),t.flags|=1,_o(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wo(e,t,i))}function To(e,t,n,r,i){if(Di(n)){var a=!0;Li(t)}else a=!1;if(Ia(t,i),null===t.stateNode)Ho(e,t),so(t,n,r),lo(t,n,r,i),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,c=n.contextType;"object"===typeof c&&null!==c?c=Aa(c):c=ji(t,c=Di(n)?Ai:Ti.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof s.getSnapshotBeforeUpdate;h||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==r||l!==c)&&oo(t,s,r,c),Oa=!1;var d=t.memoizedState;s.state=d,Ba(t,r,s,i),l=t.memoizedState,o!==r||d!==l||Ii.current||Oa?("function"===typeof u&&(ro(t,n,u,r),l=t.memoizedState),(o=Oa||ao(t,n,o,r,d,l,c))?(h||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4194308)):("function"===typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=c,r=o):("function"===typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Ma(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:no(t.type,o),s.props=c,h=t.pendingProps,d=s.context,"object"===typeof(l=n.contextType)&&null!==l?l=Aa(l):l=ji(t,l=Di(n)?Ai:Ti.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(o!==h||d!==l)&&oo(t,s,r,l),Oa=!1,d=t.memoizedState,s.state=d,Ba(t,r,s,i);var p=t.memoizedState;o!==h||d!==p||Ii.current||Oa?("function"===typeof f&&(ro(t,n,f,r),p=t.memoizedState),(c=Oa||ao(t,n,c,r,d,p,l)||!1)?(u||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(r,p,l),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=l,r=c):("function"!==typeof s.componentDidUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Io(e,t,n,r,a,i)}function Io(e,t,n,r,i,a){Co(e,t);var s=0!==(128&t.flags);if(!r&&!s)return i&&Mi(t,n,!1),Wo(e,t,a);r=t.stateNode,bo.current=t;var o=s&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=wa(t,e.child,null,a),t.child=wa(t,null,o,a)):_o(e,t,o,a),t.memoizedState=r.state,i&&Mi(t,n,!0),t.child}function Ao(e){var t=e.stateNode;t.pendingContext?Ri(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ri(0,t.context,!1),Ya(e,t.containerInfo)}function jo(e,t,n,r,i){return fa(),pa(i),t.flags|=256,_o(e,t,n,r),t.child}var Do,Po,Ro,Oo,Lo={dehydrated:null,treeContext:null,retryLane:0};function Mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fo(e,t,n){var r,i=t.pendingProps,s=Za.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&s)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Ci(Za,1&s),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,o?(i=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Mc(l,i,0,null),e=Lc(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Mo(n),t.memoizedState=Lo,e):Uo(t,l));if(null!==(s=e.memoizedState)&&null!==(r=s.dehydrated))return function(e,t,n,r,i,s,o){if(n)return 256&t.flags?(t.flags&=-257,Vo(e,t,o,r=uo(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Mc({mode:"visible",children:r.children},i,0,null),(s=Lc(s,i,o,null)).flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,0!==(1&t.mode)&&wa(t,e.child,null,o),t.child.memoizedState=Mo(o),t.memoizedState=Lo,s);if(0===(1&t.mode))return Vo(e,t,o,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Vo(e,t,o,r=uo(s=Error(a(419)),r,void 0))}if(l=0!==(o&e.childLanes),wo||l){if(null!==(r=Al)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|o))?0:i)&&i!==s.retryLane&&(s.retryLane=i,Ra(e,i),rc(r,e,i,-1))}return gc(),Vo(e,t,o,r=uo(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Tc.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,ra=ci(i.nextSibling),na=t,ia=!0,aa=null,null!==e&&(Ki[Qi++]=Xi,Ki[Qi++]=Ji,Ki[Qi++]=Yi,Xi=e.id,Ji=e.overflow,Yi=t),t=Uo(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,s,n);if(o){o=i.fallback,l=t.mode,r=(s=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Rc(s,c)).subtreeFlags=14680064&s.subtreeFlags,null!==r?o=Rc(r,o):(o=Lc(o,l,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,l=null===(l=e.child.memoizedState)?Mo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Lo,i}return e=(o=e.child).sibling,i=Rc(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Uo(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Vo(e,t,n,r){return null!==r&&pa(r),wa(t,e.child,null,n),(e=Uo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ta(e.return,t,n)}function Bo(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function qo(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(_o(e,t,r.children,n),0!==(2&(r=Za.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,n,t);else if(19===e.tag)zo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ci(Za,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===es(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Bo(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===es(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Bo(t,!0,n,null,a);break;case"together":Bo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ho(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Rc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Rc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Go(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ko(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Qo(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ko(t),null;case 1:case 17:return Di(t.type)&&Pi(),Ko(t),null;case 3:return r=t.stateNode,Xa(),Ei(Ii),Ei(Ti),ns(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ha(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(oc(aa),aa=null))),Po(e,t),Ko(t),null;case 5:$a(t);var i=Qa(Ka.current);if(n=t.type,null!==e&&null!=t.stateNode)Ro(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Ko(t),null}if(e=Qa(Wa.current),ha(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[di]=t,r[fi]=s,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(i=0;i<Or.length;i++)Ur(Or[i],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":X(r,s),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ur("invalid",r);break;case"textarea":ie(r,s),Ur("invalid",r)}for(var l in ye(n,s),i=null,s)if(s.hasOwnProperty(l)){var c=s[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==s.suppressHydrationWarning&&$r(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==s.suppressHydrationWarning&&$r(r.textContent,c,e),i=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":G(r),Z(r,s,!0);break;case"textarea":G(r),se(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[di]=t,e[fi]=r,Do(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),i=r;break;case"iframe":case"object":case"embed":Ur("load",e),i=r;break;case"video":case"audio":for(i=0;i<Or.length;i++)Ur(Or[i],e);i=r;break;case"source":Ur("error",e),i=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),i=r;break;case"details":Ur("toggle",e),i=r;break;case"input":X(e,r),i=Y(e,r),Ur("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=M({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Ur("invalid",e)}for(s in ye(n,i),c=i)if(c.hasOwnProperty(s)){var u=c[s];"style"===s?ge(e,u):"dangerouslySetInnerHTML"===s?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===s?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(o.hasOwnProperty(s)?null!=u&&"onScroll"===s&&Ur("scroll",e):null!=u&&b(e,s,u,l))}switch(n){case"input":G(e),Z(e,r,!1);break;case"textarea":G(e),se(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ne(e,!!r.multiple,s,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ko(t),null;case 6:if(e&&null!=t.stateNode)Oo(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=Qa(Ka.current),Qa(Wa.current),ha(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(s=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:$r(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$r(r.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return Ko(t),null;case 13:if(Ei(Za),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))da(),fa(),t.flags|=98560,s=!1;else if(s=ha(t),null!==r&&null!==r.dehydrated){if(null===e){if(!s)throw Error(a(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(a(317));s[di]=t}else fa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ko(t),s=!1}else null!==aa&&(oc(aa),aa=null),s=!0;if(!s)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Za.current)?0===Ol&&(Ol=3):gc())),null!==t.updateQueue&&(t.flags|=4),Ko(t),null);case 4:return Xa(),Po(e,t),null===e&&Br(t.stateNode.containerInfo),Ko(t),null;case 10:return Na(t.type._context),Ko(t),null;case 19:if(Ei(Za),null===(s=t.memoizedState))return Ko(t),null;if(r=0!==(128&t.flags),null===(l=s.rendering))if(r)Go(s,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=es(e))){for(t.flags|=128,Go(s,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ci(Za,1&Za.current|2),t.child}e=e.sibling}null!==s.tail&&Je()>ql&&(t.flags|=128,r=!0,Go(s,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=es(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Go(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ia)return Ko(t),null}else 2*Je()-s.renderingStartTime>ql&&1073741824!==n&&(t.flags|=128,r=!0,Go(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Je(),t.sibling=null,n=Za.current,Ci(Za,r?1&n|2:1&n),t):(Ko(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(Ko(t),6&t.subtreeFlags&&(t.flags|=8192)):Ko(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Yo(e,t){switch(ta(t),t.tag){case 1:return Di(t.type)&&Pi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xa(),Ei(Ii),Ei(Ti),ns(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return $a(t),null;case 13:if(Ei(Za),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));fa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ei(Za),null;case 4:return Xa(),null;case 10:return Na(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Do=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Po=function(){},Ro=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Qa(Wa.current);var a,s=null;switch(n){case"input":i=Y(e,i),r=Y(e,r),s=[];break;case"select":i=M({},i,{value:void 0}),r=M({},r,{value:void 0}),s=[];break;case"textarea":i=re(e,i),r=re(e,r),s=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ye(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(s||(s=[]),s.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(s=s||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(s=s||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}},Oo=function(e,t,n,r){n!==r&&(t.flags|=4)};var Xo=!1,Jo=!1,$o="function"===typeof WeakSet?WeakSet:Set,Zo=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ec(e,t,r)}else n.current=null}function tl(e,t,n){try{n()}catch(r){Ec(e,t,r)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&tl(t,n,a)}i=i.next}while(i!==r)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[mi],delete t[gi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ol(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ol(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var hl=null,dl=!1;function fl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,n)}catch(o){}switch(n.tag){case 5:Jo||el(n,t);case 6:var r=hl,i=dl;hl=null,fl(e,t,n),dl=i,null!==(hl=r)&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):hl.removeChild(n.stateNode));break;case 18:null!==hl&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Bt(e)):li(hl,n.stateNode));break;case 4:r=hl,i=dl,hl=n.stateNode.containerInfo,dl=!0,fl(e,t,n),hl=r,dl=i;break;case 0:case 11:case 14:case 15:if(!Jo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,s=a.destroy;a=a.tag,void 0!==s&&(0!==(2&a)||0!==(4&a))&&tl(n,t,s),i=i.next}while(i!==r)}fl(e,t,n);break;case 1:if(!Jo&&(el(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Ec(n,t,o)}fl(e,t,n);break;case 21:fl(e,t,n);break;case 22:1&n.mode?(Jo=(r=Jo)||null!==n.memoizedState,fl(e,t,n),Jo=r):fl(e,t,n);break;default:fl(e,t,n)}}function ml(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $o),t.forEach((function(t){var r=Ic.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function gl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:hl=l.stateNode,dl=!1;break e;case 3:case 4:hl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===hl)throw Error(a(160));pl(s,o,i),hl=null,dl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Ec(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),yl(e),4&r){try{rl(3,e,e.return),il(3,e)}catch(g){Ec(e,e.return,g)}try{rl(5,e,e.return)}catch(g){Ec(e,e.return,g)}}break;case 1:gl(t,e),yl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(gl(t,e),yl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(g){Ec(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var s=e.memoizedProps,o=null!==n?n.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===s.type&&null!=s.name&&J(i,s),be(l,o);var u=be(l,s);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):b(i,h,d,u)}switch(l){case"input":$(i,s);break;case"textarea":ae(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?ne(i,!!s.multiple,p,!1):f!==!!s.multiple&&(null!=s.defaultValue?ne(i,!!s.multiple,s.defaultValue,!0):ne(i,!!s.multiple,s.multiple?[]:"",!1))}i[fi]=s}catch(g){Ec(e,e.return,g)}}break;case 6:if(gl(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){Ec(e,e.return,g)}}break;case 3:if(gl(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){Ec(e,e.return,g)}break;case 4:default:gl(t,e),yl(e);break;case 13:gl(t,e),yl(e),8192&(i=e.child).flags&&(s=null!==i.memoizedState,i.stateNode.isHidden=s,!s||null!==i.alternate&&null!==i.alternate.memoizedState||(Bl=Je())),4&r&&ml(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Jo=(u=Jo)||h,gl(t,e),Jo=u):gl(t,e),yl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Zo=e,h=e.child;null!==h;){for(d=Zo=h;null!==Zo;){switch(p=(f=Zo).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:el(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ec(r,n,g)}}break;case 5:el(f,f.return);break;case 22:if(null!==f.memoizedState){xl(d);continue}}null!==p?(p.return=f,Zo=p):xl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"===typeof(s=i.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=d.stateNode,o=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){Ec(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Ec(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:gl(t,e),yl(e),4&r&&ml(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ol(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),ul(e,ll(e),i);break;case 3:case 4:var s=r.stateNode.containerInfo;cl(e,ll(e),s);break;default:throw Error(a(161))}}catch(o){Ec(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){Zo=e,wl(e,t,n)}function wl(e,t,n){for(var r=0!==(1&e.mode);null!==Zo;){var i=Zo,a=i.child;if(22===i.tag&&r){var s=null!==i.memoizedState||Xo;if(!s){var o=i.alternate,l=null!==o&&null!==o.memoizedState||Jo;o=Xo;var c=Jo;if(Xo=s,(Jo=l)&&!c)for(Zo=i;null!==Zo;)l=(s=Zo).child,22===s.tag&&null!==s.memoizedState?Sl(i):null!==l?(l.return=s,Zo=l):Sl(i);for(;null!==a;)Zo=a,wl(a,t,n),a=a.sibling;Zo=i,Xo=o,Jo=c}_l(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Zo=a):_l(e)}}function _l(e){for(;null!==Zo;){var t=Zo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Jo||il(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Jo)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:no(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&qa(t,s,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}qa(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Bt(d)}}}break;default:throw Error(a(163))}Jo||512&t.flags&&al(t)}catch(f){Ec(t,t.return,f)}}if(t===e){Zo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Zo=n;break}Zo=t.return}}function xl(e){for(;null!==Zo;){var t=Zo;if(t===e){Zo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Zo=n;break}Zo=t.return}}function Sl(e){for(;null!==Zo;){var t=Zo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){Ec(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Ec(t,i,l)}}var a=t.return;try{al(t)}catch(l){Ec(t,a,l)}break;case 5:var s=t.return;try{al(t)}catch(l){Ec(t,s,l)}}}catch(l){Ec(t,t.return,l)}if(t===e){Zo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Zo=o;break}Zo=t.return}}var kl,El=Math.ceil,Cl=w.ReactCurrentDispatcher,Nl=w.ReactCurrentOwner,Tl=w.ReactCurrentBatchConfig,Il=0,Al=null,jl=null,Dl=0,Pl=0,Rl=ki(0),Ol=0,Ll=null,Ml=0,Fl=0,Ul=0,Vl=null,zl=null,Bl=0,ql=1/0,Hl=null,Wl=!1,Gl=null,Kl=null,Ql=!1,Yl=null,Xl=0,Jl=0,$l=null,Zl=-1,ec=0;function tc(){return 0!==(6&Il)?Je():-1!==Zl?Zl:Zl=Je()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Il)&&0!==Dl?Dl&-Dl:null!==ma.transition?(0===ec&&(ec=mt()),ec):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function rc(e,t,n,r){if(50<Jl)throw Jl=0,$l=null,Error(a(185));vt(e,n,r),0!==(2&Il)&&e===Al||(e===Al&&(0===(2&Il)&&(Fl|=n),4===Ol&&lc(e,Dl)),ic(e,r),1===n&&0===Il&&0===(1&t.mode)&&(ql=Je()+500,Ui&&Bi()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-st(a),o=1<<s,l=i[s];-1===l?0!==(o&n)&&0===(o&r)||(i[s]=ft(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var r=dt(e,e===Al?Dl:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Ui=!0,zi(e)}(cc.bind(null,e)):zi(cc.bind(null,e)),si((function(){0===(6&Il)&&Bi()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ac(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Zl=-1,ec=0,0!==(6&Il))throw Error(a(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var r=dt(e,e===Al?Dl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var i=Il;Il|=2;var s=mc();for(Al===e&&Dl===t||(Hl=null,ql=Je()+500,fc(e,t));;)try{bc();break}catch(l){pc(e,l)}Ca(),Cl.current=s,Il=i,null!==jl?t=0:(Al=null,Dl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=sc(e,i))),1===t)throw n=Ll,fc(e,0),lc(e,r),ic(e,Je()),n;if(6===t)lc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!or(a(),i))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=vc(e,r))&&(0!==(s=pt(e))&&(r=s,t=sc(e,s))),1===t))throw n=Ll,fc(e,0),lc(e,r),ic(e,Je()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:xc(e,zl,Hl);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=Bl+500-Je())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(xc.bind(null,e,zl,Hl),t);break}xc(e,zl,Hl);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-st(r);s=1<<o,(o=t[o])>i&&(i=o),r&=~s}if(r=i,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*El(r/1960))-r)){e.timeoutHandle=ri(xc.bind(null,e,zl,Hl),r);break}xc(e,zl,Hl);break;default:throw Error(a(329))}}}return ic(e,Je()),e.callbackNode===n?ac.bind(null,e):null}function sc(e,t){var n=Vl;return e.current.memoizedState.isDehydrated&&(fc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=zl,zl=n,null!==t&&oc(t)),e}function oc(e){null===zl?zl=e:zl.push.apply(zl,e)}function lc(e,t){for(t&=~Ul,t&=~Fl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-st(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Il))throw Error(a(327));Sc();var t=dt(e,0);if(0===(1&t))return ic(e,Je()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Ll,fc(e,0),lc(e,t),ic(e,Je()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,zl,Hl),ic(e,Je()),null}function uc(e,t){var n=Il;Il|=1;try{return e(t)}finally{0===(Il=n)&&(ql=Je()+500,Ui&&Bi())}}function hc(e){null!==Yl&&0===Yl.tag&&0===(6&Il)&&Sc();var t=Il;Il|=1;var n=Tl.transition,r=bt;try{if(Tl.transition=null,bt=1,e)return e()}finally{bt=r,Tl.transition=n,0===(6&(Il=t))&&Bi()}}function dc(){Pl=Rl.current,Ei(Rl)}function fc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==jl)for(n=jl.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Pi();break;case 3:Xa(),Ei(Ii),Ei(Ti),ns();break;case 5:$a(r);break;case 4:Xa();break;case 13:case 19:Ei(Za);break;case 10:Na(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Al=e,jl=e=Rc(e.current,null),Dl=Pl=t,Ol=0,Ll=null,Ul=Fl=Ml=0,zl=Vl=null,null!==ja){for(t=0;t<ja.length;t++)if(null!==(r=(n=ja[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var s=a.next;a.next=i,r.next=s}n.pending=r}ja=null}return e}function pc(e,t){for(;;){var n=jl;try{if(Ca(),rs.current=$s,cs){for(var r=ss.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}cs=!1}if(as=0,ls=os=ss=null,us=!1,hs=0,Nl.current=null,null===n||null===n.return){Ol=1,Ll=t,jl=null;break}e:{var s=e,o=n.return,l=n,c=t;if(t=Dl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=vo(o);if(null!==p){p.flags&=-257,yo(p,o,l,0,t),1&p.mode&&go(s,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){go(s,u,t),gc();break e}c=Error(a(426))}else if(ia&&1&l.mode){var v=vo(o);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),yo(v,o,l,0,t),pa(co(c,l));break e}}s=c=co(c,l),4!==Ol&&(Ol=2),null===Vl?Vl=[s]:Vl.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,za(s,po(0,c,t));break e;case 1:l=c;var y=s.type,b=s.stateNode;if(0===(128&s.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Kl||!Kl.has(b)))){s.flags|=65536,t&=-t,s.lanes|=t,za(s,mo(s,l,t));break e}}s=s.return}while(null!==s)}_c(n)}catch(w){t=w,jl===n&&null!==n&&(jl=n=n.return);continue}break}}function mc(){var e=Cl.current;return Cl.current=$s,null===e?$s:e}function gc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Al||0===(268435455&Ml)&&0===(268435455&Fl)||lc(Al,Dl)}function vc(e,t){var n=Il;Il|=2;var r=mc();for(Al===e&&Dl===t||(Hl=null,fc(e,t));;)try{yc();break}catch(i){pc(e,i)}if(Ca(),Il=n,Cl.current=r,null!==jl)throw Error(a(261));return Al=null,Dl=0,Ol}function yc(){for(;null!==jl;)wc(jl)}function bc(){for(;null!==jl&&!Ye();)wc(jl)}function wc(e){var t=kl(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?_c(e):jl=t,Nl.current=null}function _c(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Qo(n,t,Pl)))return void(jl=n)}else{if(null!==(n=Yo(n,t)))return n.flags&=32767,void(jl=n);if(null===e)return Ol=6,void(jl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(jl=t);jl=t=e}while(null!==t);0===Ol&&(Ol=5)}function xc(e,t,n){var r=bt,i=Tl.transition;try{Tl.transition=null,bt=1,function(e,t,n,r){do{Sc()}while(null!==Yl);if(0!==(6&Il))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-st(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,s),e===Al&&(jl=Al=null,Dl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Ql||(Ql=!0,Ac(tt,(function(){return Sc(),null}))),s=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||s){s=Tl.transition,Tl.transition=null;var o=bt;bt=1;var l=Il;Il|=4,Nl.current=null,function(e,t){if(ei=Ht,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch(_){n=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=o+i),d!==s||0!==r&&3!==d.nodeType||(c=o+r),3===d.nodeType&&(o+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=o),f===s&&++h===r&&(c=o),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Ht=!1,Zo=t;null!==Zo;)if(e=(t=Zo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zo=e;else for(;null!==Zo;){t=Zo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:no(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(a(163))}}catch(_){Ec(t,t.return,_)}if(null!==(e=t.sibling)){e.return=t.return,Zo=e;break}Zo=t.return}m=nl,nl=!1}(e,n),vl(n,e),pr(ti),Ht=!!ei,ti=ei=null,e.current=n,bl(n,e,i),Xe(),Il=l,bt=o,Tl.transition=s}else e.current=n;if(Ql&&(Ql=!1,Yl=e,Xl=i),s=e.pendingLanes,0===s&&(Kl=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Wl)throw Wl=!1,e=Gl,Gl=null,e;0!==(1&Xl)&&0!==e.tag&&Sc(),s=e.pendingLanes,0!==(1&s)?e===$l?Jl++:(Jl=0,$l=e):Jl=0,Bi()}(e,t,n,r)}finally{Tl.transition=i,bt=r}return null}function Sc(){if(null!==Yl){var e=wt(Xl),t=Tl.transition,n=bt;try{if(Tl.transition=null,bt=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Xl=0,0!==(6&Il))throw Error(a(331));var i=Il;for(Il|=4,Zo=e.current;null!==Zo;){var s=Zo,o=s.child;if(0!==(16&Zo.flags)){var l=s.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Zo=u;null!==Zo;){var h=Zo;switch(h.tag){case 0:case 11:case 15:rl(8,h,s)}var d=h.child;if(null!==d)d.return=h,Zo=d;else for(;null!==Zo;){var f=(h=Zo).sibling,p=h.return;if(sl(h),h===u){Zo=null;break}if(null!==f){f.return=p,Zo=f;break}Zo=p}}}var m=s.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}Zo=s}}if(0!==(2064&s.subtreeFlags)&&null!==o)o.return=s,Zo=o;else e:for(;null!==Zo;){if(0!==(2048&(s=Zo).flags))switch(s.tag){case 0:case 11:case 15:rl(9,s,s.return)}var y=s.sibling;if(null!==y){y.return=s.return,Zo=y;break e}Zo=s.return}}var b=e.current;for(Zo=b;null!==Zo;){var w=(o=Zo).child;if(0!==(2064&o.subtreeFlags)&&null!==w)w.return=o,Zo=w;else e:for(o=b;null!==Zo;){if(0!==(2048&(l=Zo).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(x){Ec(l,l.return,x)}if(l===o){Zo=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,Zo=_;break e}Zo=l.return}}if(Il=i,Bi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(x){}r=!0}return r}finally{bt=n,Tl.transition=t}}return!1}function kc(e,t,n){e=Ua(e,t=po(0,t=co(n,t),1),1),t=tc(),null!==e&&(vt(e,1,t),ic(e,t))}function Ec(e,t,n){if(3===e.tag)kc(e,e,n);else for(;null!==t;){if(3===t.tag){kc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Kl||!Kl.has(r))){t=Ua(t,e=mo(t,e=co(n,e),1),1),e=tc(),null!==t&&(vt(t,1,e),ic(t,e));break}}t=t.return}}function Cc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Al===e&&(Dl&n)===n&&(4===Ol||3===Ol&&(130023424&Dl)===Dl&&500>Je()-Bl?fc(e,0):Ul|=n),ic(e,t)}function Nc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tc();null!==(e=Ra(e,t))&&(vt(e,t,n),ic(e,n))}function Tc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Nc(e,n)}function Ic(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Nc(e,n)}function Ac(e,t){return Ke(e,t)}function jc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dc(e,t,n,r){return new jc(e,t,n,r)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var n=e.alternate;return null===n?((n=Dc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,i,s){var o=2;if(r=e,"function"===typeof e)Pc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case S:return Lc(n.children,i,s,t);case k:o=8,i|=8;break;case E:return(e=Dc(12,n,t,2|i)).elementType=E,e.lanes=s,e;case I:return(e=Dc(13,n,t,i)).elementType=I,e.lanes=s,e;case A:return(e=Dc(19,n,t,i)).elementType=A,e.lanes=s,e;case P:return Mc(n,i,s,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:o=10;break e;case N:o=9;break e;case T:o=11;break e;case j:o=14;break e;case D:o=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Dc(o,n,t,i)).elementType=e,t.type=r,t.lanes=s,t}function Lc(e,t,n,r){return(e=Dc(7,e,r,t)).lanes=n,e}function Mc(e,t,n,r){return(e=Dc(22,e,r,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Fc(e,t,n){return(e=Dc(6,e,null,t)).lanes=n,e}function Uc(e,t,n){return(t=Dc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,i,a,s,o,l){return e=new Vc(e,t,n,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Dc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},La(a),e}function Bc(e){if(!e)return Ni;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Di(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Di(n))return Oi(e,n,t)}return t}function qc(e,t,n,r,i,a,s,o,l){return(e=zc(n,r,!0,e,0,a,0,o,l)).context=Bc(null),n=e.current,(a=Fa(r=tc(),i=nc(n))).callback=void 0!==t&&null!==t?t:null,Ua(n,a,i),e.current.lanes=i,vt(e,i,r),ic(e,r),e}function Hc(e,t,n,r){var i=t.current,a=tc(),s=nc(i);return n=Bc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fa(a,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ua(i,t,s))&&(rc(e,i,s,a),Va(e,i,s)),s}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}kl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ii.current)wo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return wo=!1,function(e,t,n){switch(t.tag){case 3:Ao(t),fa();break;case 5:Ja(t);break;case 1:Di(t.type)&&Li(t);break;case 4:Ya(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ci(xa,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ci(Za,1&Za.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Fo(e,t,n):(Ci(Za,1&Za.current),null!==(e=Wo(e,t,n))?e.sibling:null);Ci(Za,1&Za.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return qo(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ci(Za,Za.current),r)break;return null;case 22:case 23:return t.lanes=0,Eo(e,t,n)}return Wo(e,t,n)}(e,t,n);wo=0!==(131072&e.flags)}else wo=!1,ia&&0!==(1048576&t.flags)&&Zi(t,Gi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ho(e,t),e=t.pendingProps;var i=ji(t,Ti.current);Ia(t,n),i=ms(null,t,r,e,i,n);var s=gs();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Di(r)?(s=!0,Li(t)):s=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,La(t),i.updater=io,t.stateNode=i,i._reactInternals=t,lo(t,r,e,n),t=Io(null,t,r,!0,s,n)):(t.tag=0,ia&&s&&ea(t),_o(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ho(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===j)return 14}return 2}(r),e=no(r,e),i){case 0:t=No(null,t,r,e,n);break e;case 1:t=To(null,t,r,e,n);break e;case 11:t=xo(null,t,r,e,n);break e;case 14:t=So(null,t,r,no(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,No(e,t,r,i=t.elementType===r?i:no(r,i),n);case 1:return r=t.type,i=t.pendingProps,To(e,t,r,i=t.elementType===r?i:no(r,i),n);case 3:e:{if(Ao(t),null===e)throw Error(a(387));r=t.pendingProps,i=(s=t.memoizedState).element,Ma(e,t),Ba(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated){if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=jo(e,t,r,n,i=co(Error(a(423)),t));break e}if(r!==i){t=jo(e,t,r,n,i=co(Error(a(424)),t));break e}for(ra=ci(t.stateNode.containerInfo.firstChild),na=t,ia=!0,aa=null,n=_a(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fa(),r===i){t=Wo(e,t,n);break e}_o(e,t,r,n)}t=t.child}return t;case 5:return Ja(t),null===e&&ca(t),r=t.type,i=t.pendingProps,s=null!==e?e.memoizedProps:null,o=i.children,ni(r,i)?o=null:null!==s&&ni(r,s)&&(t.flags|=32),Co(e,t),_o(e,t,o,n),t.child;case 6:return null===e&&ca(t),null;case 13:return Fo(e,t,n);case 4:return Ya(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=wa(t,null,r,n):_o(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,xo(e,t,r,i=t.elementType===r?i:no(r,i),n);case 7:return _o(e,t,t.pendingProps,n),t.child;case 8:case 12:return _o(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Ci(xa,r._currentValue),r._currentValue=o,null!==s)if(or(s.value,o)){if(s.children===i.children&&!Ii.current){t=Wo(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var l=s.dependencies;if(null!==l){o=s.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===s.tag){(c=Fa(-1,n&-n)).tag=2;var u=s.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Ta(s.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===s.tag)o=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(o=s.return))throw Error(a(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ta(o,n,t),o=s.sibling}else o=s.child;if(null!==o)o.return=s;else for(o=s;null!==o;){if(o===t){o=null;break}if(null!==(s=o.sibling)){s.return=o.return,o=s;break}o=o.return}s=o}_o(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ia(t,n),r=r(i=Aa(i)),t.flags|=1,_o(e,t,r,n),t.child;case 14:return i=no(r=t.type,t.pendingProps),So(e,t,r,i=no(r.type,i),n);case 15:return ko(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:no(r,i),Ho(e,t),t.tag=1,Di(r)?(e=!0,Li(t)):e=!1,Ia(t,n),so(t,r,i),lo(t,r,i,n),Io(null,t,r,!0,e,n);case 19:return qo(e,t,n);case 22:return Eo(e,t,n)}throw Error(a(156,t.tag))};var Qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Xc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function eu(e,t,n,r,i){var a=n._reactRootContainer;if(a){var s=a;if("function"===typeof i){var o=i;i=function(){var e=Wc(s);o.call(e)}}Hc(t,s,e,i)}else s=function(e,t,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var e=Wc(s);a.call(e)}}var s=qc(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=s,e[pi]=s.current,Br(8===e.nodeType?e.parentNode:e),hc(),s}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var o=r;r=function(){var e=Wc(l);o.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[pi]=l.current,Br(8===e.nodeType?e.parentNode:e),hc((function(){Hc(t,l,n,r)})),l}(n,t,e,i,r);return Wc(s)}Xc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Hc(e,t,null,null)},Xc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hc((function(){Hc(null,e,null,null)})),t[pi]=null}},Xc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Mt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),ic(t,Je()),0===(6&Il)&&(ql=Je()+500,Bi()))}break;case 13:hc((function(){var t=Ra(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),Kc(e,1)}},xt=function(e){if(13===e.tag){var t=Ra(e,134217728);if(null!==t)rc(t,e,134217728,tc());Kc(e,134217728)}},St=function(e){if(13===e.tag){var t=nc(e),n=Ra(e,t);if(null!==n)rc(n,e,t,tc());Kc(e,t)}},kt=function(){return bt},Et=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},xe=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=_i(r);if(!i)throw Error(a(90));K(r),$(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Te=uc,Ie=hc;var tu={usingClientEntryPoint:!1,Events:[bi,wi,_i,Ce,Ne,uc]},nu={findFiberByHostInstance:yi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{it=iu.inject(ru),at=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:x,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(a(299));var n=!1,r="",i=Qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Br(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return hc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(a(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,s="",o=Qc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=qc(t,null,e,1,null!=n?n:null,i,0,s,o),e[pi]=t.current,Br(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Xc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(a(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(a(40));return!!e._reactRootContainer&&(hc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!$c(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return eu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var s={};e=e||[null,t({}),t([]),t(t)];for(var o=2&i&&r;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>s[e]=()=>r[e]));return s.default=()=>r,n.d(a,s),a}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".fd3114fb.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="energy_balance:";n.l=(r,i,a,s)=>{if(e[r])e[r].push(i);else{var o,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+a){o=h;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+a),o.src=r),e[r]=[i];var d=(t,n)=>{o.onerror=o.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((e=>e(n))),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=d.bind(null,o.onerror),o.onload=d.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/energy_balance/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var a=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=a);var s=n.p+n.u(t),o=new Error;n.l(s,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),s=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+s+")",o.name="ChunkLoadError",o.type=a,o.request=s,i[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,a,s=r[0],o=r[1],l=r[2],c=0;if(s.some((t=>0!==e[t]))){for(i in o)n.o(o,i)&&(n.m[i]=o[i]);if(l)l(n)}for(t&&t(r);c<s.length;c++)a=s[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkenergy_balance=self.webpackChunkenergy_balance||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r,i=n(43),a=n.t(i,2),s=n(391);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(r||(r={}));const l="popstate";function c(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function u(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function h(e,t){return{usr:e.state,key:e.key,idx:t}}function d(e,t,n,r){return void 0===n&&(n=null),o({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?p(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function f(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function p(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function m(e,t,n,i){void 0===i&&(i={});let{window:a=document.defaultView,v5Compat:s=!1}=i,u=a.history,p=r.Pop,m=null,g=v();function v(){return(u.state||{idx:null}).idx}function y(){p=r.Pop;let e=v(),t=null==e?null:e-g;g=e,m&&m({action:p,location:w.location,delta:t})}function b(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,n="string"===typeof e?e:f(e);return n=n.replace(/ $/,"%20"),c(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==g&&(g=0,u.replaceState(o({},u.state,{idx:g}),""));let w={get action(){return p},get location(){return e(a,u)},listen(e){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(l,y),m=e,()=>{a.removeEventListener(l,y),m=null}},createHref:e=>t(a,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){p=r.Push;let i=d(w.location,e,t);n&&n(i,e),g=v()+1;let o=h(i,g),l=w.createHref(i);try{u.pushState(o,"",l)}catch(c){if(c instanceof DOMException&&"DataCloneError"===c.name)throw c;a.location.assign(l)}s&&m&&m({action:p,location:w.location,delta:1})},replace:function(e,t){p=r.Replace;let i=d(w.location,e,t);n&&n(i,e),g=v();let a=h(i,g),o=w.createHref(i);u.replaceState(a,"",o),s&&m&&m({action:p,location:w.location,delta:0})},go:e=>u.go(e)};return w}var g;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(g||(g={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function v(e,t,n){return void 0===n&&(n="/"),y(e,t,n,!1)}function y(e,t,n,r){let i=D(("string"===typeof t?p(t):t).pathname||"/",n);if(null==i)return null;let a=b(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(a);let s=null;for(let o=0;null==s&&o<a.length;++o){let e=j(i);s=I(a[o],e,r)}return s}function b(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,a)=>{let s={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};s.relativePath.startsWith("/")&&(c(s.relativePath.startsWith(r),'Absolute route path "'+s.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),s.relativePath=s.relativePath.slice(r.length));let o=M([r,s.relativePath]),l=n.concat(s);e.children&&e.children.length>0&&(c(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),b(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:T(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of w(e.path))i(e,t,r);else i(e,t)})),t}function w(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),a=n.replace(/\?$/,"");if(0===r.length)return i?[a,""]:[a];let s=w(r.join("/")),o=[];return o.push(...s.map((e=>""===e?a:[a,e].join("/")))),i&&o.push(...s),o.map((t=>e.startsWith("/")&&""===t?"/":t))}const _=/^:[\w-]+$/,x=3,S=2,k=1,E=10,C=-2,N=e=>"*"===e;function T(e,t){let n=e.split("/"),r=n.length;return n.some(N)&&(r+=C),t&&(r+=S),n.filter((e=>!N(e))).reduce(((e,t)=>e+(_.test(t)?x:""===t?k:E)),r)}function I(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,i={},a="/",s=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===a?t:t.slice(a.length)||"/",u=A({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),h=e.route;if(!u&&l&&n&&!r[r.length-1].route.index&&(u=A({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!u)return null;Object.assign(i,u.params),s.push({params:i,pathname:M([a,u.pathname]),pathnameBase:F(M([a,u.pathnameBase])),route:h}),"/"!==u.pathnameBase&&(a=M([a,u.pathnameBase]))}return s}function A(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);u("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let a=new RegExp(i,t?void 0:"i");return[a,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],s=a.replace(/(.)\/+$/,"$1"),o=i.slice(1),l=r.reduce(((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=o[n]||"";s=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=i&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{});return{params:l,pathname:a,pathnameBase:s,pattern:e}}function j(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return u(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function D(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function P(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function R(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function O(e,t){let n=R(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function L(e,t,n,r){let i;void 0===r&&(r=!1),"string"===typeof e?i=p(e):(i=o({},e),c(!i.pathname||!i.pathname.includes("?"),P("?","pathname","search",i)),c(!i.pathname||!i.pathname.includes("#"),P("#","pathname","hash",i)),c(!i.search||!i.search.includes("#"),P("#","search","hash",i)));let a,s=""===e||""===i.pathname,l=s?"/":i.pathname;if(null==l)a=n;else{let e=t.length-1;if(!r&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}a=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:i=""}="string"===typeof e?p(e):e,a=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:a,search:U(r),hash:V(i)}}(i,a),h=l&&"/"!==l&&l.endsWith("/"),d=(s||"."===l)&&n.endsWith("/");return u.pathname.endsWith("/")||!h&&!d||(u.pathname+="/"),u}const M=e=>e.join("/").replace(/\/\/+/g,"/"),F=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),U=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",V=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function z(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const B=["post","put","patch","delete"],q=(new Set(B),["get",...B]);new Set(q),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},H.apply(this,arguments)}const W=i.createContext(null);const G=i.createContext(null);const K=i.createContext(null);const Q=i.createContext(null);const Y=i.createContext({outlet:null,matches:[],isDataRoute:!1});const X=i.createContext(null);function J(){return null!=i.useContext(Q)}function $(){return J()||c(!1),i.useContext(Q).location}function Z(e){i.useContext(K).static||i.useLayoutEffect(e)}function ee(){let{isDataRoute:e}=i.useContext(Y);return e?function(){let{router:e}=ue(le.UseNavigateStable),t=de(ce.UseNavigateStable),n=i.useRef(!1);Z((()=>{n.current=!0}));let r=i.useCallback((function(r,i){void 0===i&&(i={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,H({fromRouteId:t},i)))}),[e,t]);return r}():function(){J()||c(!1);let e=i.useContext(W),{basename:t,future:n,navigator:r}=i.useContext(K),{matches:a}=i.useContext(Y),{pathname:s}=$(),o=JSON.stringify(O(a,n.v7_relativeSplatPath)),l=i.useRef(!1);Z((()=>{l.current=!0}));let u=i.useCallback((function(n,i){if(void 0===i&&(i={}),!l.current)return;if("number"===typeof n)return void r.go(n);let a=L(n,JSON.parse(o),s,"path"===i.relative);null==e&&"/"!==t&&(a.pathname="/"===a.pathname?t:M([t,a.pathname])),(i.replace?r.replace:r.push)(a,i.state,i)}),[t,r,o,s,e]);return u}()}function te(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=i.useContext(K),{matches:a}=i.useContext(Y),{pathname:s}=$(),o=JSON.stringify(O(a,r.v7_relativeSplatPath));return i.useMemo((()=>L(e,JSON.parse(o),s,"path"===n)),[e,o,s,n])}function ne(e,t,n,a){J()||c(!1);let{navigator:s}=i.useContext(K),{matches:o}=i.useContext(Y),l=o[o.length-1],u=l?l.params:{},h=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let d,f=$();if(t){var m;let e="string"===typeof t?p(t):t;"/"===h||(null==(m=e.pathname)?void 0:m.startsWith(h))||c(!1),d=e}else d=f;let g=d.pathname||"/",y=g;if("/"!==h){let e=h.replace(/^\//,"").split("/");y="/"+g.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=v(e,{pathname:y});let w=oe(b&&b.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:M([h,s.encodeLocation?s.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:M([h,s.encodeLocation?s.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),o,n,a);return t&&w?i.createElement(Q.Provider,{value:{location:H({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:r.Pop}},w):w}function re(){let e=function(){var e;let t=i.useContext(X),n=he(ce.UseRouteError),r=de(ce.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=z(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r};return i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},t),n?i.createElement("pre",{style:a},n):null,null)}const ie=i.createElement(re,null);class ae extends i.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?i.createElement(Y.Provider,{value:this.props.routeContext},i.createElement(X.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function se(e){let{routeContext:t,match:n,children:r}=e,a=i.useContext(W);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(Y.Provider,{value:t},r)}function oe(e,t,n,r){var a;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var s;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(s=r)&&s.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let o=e,l=null==(a=n)?void 0:a.errors;if(null!=l){let e=o.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||c(!1),o=o.slice(0,Math.min(o.length,e+1))}let u=!1,h=-1;if(n&&r&&r.v7_partialHydration)for(let i=0;i<o.length;i++){let e=o[i];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(h=i),e.route.id){let{loaderData:t,errors:r}=n,i=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||i){u=!0,o=h>=0?o.slice(0,h+1):[o[0]];break}}}return o.reduceRight(((e,r,a)=>{let s,c=!1,d=null,f=null;var p;n&&(s=l&&r.route.id?l[r.route.id]:void 0,d=r.route.errorElement||ie,u&&(h<0&&0===a?(p="route-fallback",!1||fe[p]||(fe[p]=!0),c=!0,f=null):h===a&&(c=!0,f=r.route.hydrateFallbackElement||null)));let m=t.concat(o.slice(0,a+1)),g=()=>{let t;return t=s?d:c?f:r.route.Component?i.createElement(r.route.Component,null):r.route.element?r.route.element:e,i.createElement(se,{match:r,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===a)?i.createElement(ae,{location:n.location,revalidation:n.revalidation,component:d,error:s,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()}),null)}var le=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(le||{}),ce=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ce||{});function ue(e){let t=i.useContext(W);return t||c(!1),t}function he(e){let t=i.useContext(G);return t||c(!1),t}function de(e){let t=function(){let e=i.useContext(Y);return e||c(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||c(!1),n.route.id}const fe={};function pe(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}a.startTransition;function me(e){let{to:t,replace:n,state:r,relative:a}=e;J()||c(!1);let{future:s,static:o}=i.useContext(K),{matches:l}=i.useContext(Y),{pathname:u}=$(),h=ee(),d=L(t,O(l,s.v7_relativeSplatPath),u,"path"===a),f=JSON.stringify(d);return i.useEffect((()=>h(JSON.parse(f),{replace:n,state:r,relative:a})),[h,f,a,n,r]),null}function ge(e){c(!1)}function ve(e){let{basename:t="/",children:n=null,location:a,navigationType:s=r.Pop,navigator:o,static:l=!1,future:u}=e;J()&&c(!1);let h=t.replace(/^\/*/,"/"),d=i.useMemo((()=>({basename:h,navigator:o,static:l,future:H({v7_relativeSplatPath:!1},u)})),[h,u,o,l]);"string"===typeof a&&(a=p(a));let{pathname:f="/",search:m="",hash:g="",state:v=null,key:y="default"}=a,b=i.useMemo((()=>{let e=D(f,h);return null==e?null:{location:{pathname:e,search:m,hash:g,state:v,key:y},navigationType:s}}),[h,f,m,g,v,y,s]);return null==b?null:i.createElement(K.Provider,{value:d},i.createElement(Q.Provider,{children:n,value:b}))}function ye(e){let{children:t,location:n}=e;return ne(be(t),n)}new Promise((()=>{}));i.Component;function be(e,t){void 0===t&&(t=[]);let n=[];return i.Children.forEach(e,((e,r)=>{if(!i.isValidElement(e))return;let a=[...t,r];if(e.type===i.Fragment)return void n.push.apply(n,be(e.props.children,a));e.type!==ge&&c(!1),e.props.index&&e.props.children&&c(!1);let s={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(s.children=be(e.props.children,a)),n.push(s)})),n}var we=n(950),_e=n.t(we,2);function xe(){return xe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xe.apply(this,arguments)}function Se(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const ke=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(Kw){}new Map;const Ee=a.startTransition;_e.flushSync,a.useId;function Ce(e){let{basename:t,children:n,future:r,window:a}=e,s=i.useRef();var o;null==s.current&&(s.current=(void 0===(o={window:a,v5Compat:!0})&&(o={}),m((function(e,t){let{pathname:n,search:r,hash:i}=e.location;return d("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:f(t)}),null,o)));let l=s.current,[c,u]=i.useState({action:l.action,location:l.location}),{v7_startTransition:h}=r||{},p=i.useCallback((e=>{h&&Ee?Ee((()=>u(e))):u(e)}),[u,h]);return i.useLayoutEffect((()=>l.listen(p)),[l,p]),i.useEffect((()=>pe(r)),[r]),i.createElement(ve,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l,future:r})}const Ne="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Te=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ie=i.forwardRef((function(e,t){let n,{onClick:r,relative:a,reloadDocument:s,replace:o,state:l,target:u,to:h,preventScrollReset:d,viewTransition:p}=e,m=Se(e,ke),{basename:g}=i.useContext(K),v=!1;if("string"===typeof h&&Te.test(h)&&(n=h,Ne))try{let e=new URL(window.location.href),t=h.startsWith("//")?new URL(e.protocol+h):new URL(h),n=D(t.pathname,g);t.origin===e.origin&&null!=n?h=n+t.search+t.hash:v=!0}catch(Kw){}let y=function(e,t){let{relative:n}=void 0===t?{}:t;J()||c(!1);let{basename:r,navigator:a}=i.useContext(K),{hash:s,pathname:o,search:l}=te(e,{relative:n}),u=o;return"/"!==r&&(u="/"===o?r:M([r,o])),a.createHref({pathname:u,search:l,hash:s})}(h,{relative:a}),b=function(e,t){let{target:n,replace:r,state:a,preventScrollReset:s,relative:o,viewTransition:l}=void 0===t?{}:t,c=ee(),u=$(),h=te(e,{relative:o});return i.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:f(u)===f(h);c(e,{replace:n,state:a,preventScrollReset:s,relative:o,viewTransition:l})}}),[u,c,h,r,a,n,e,s,o,l])}(h,{replace:o,state:l,target:u,preventScrollReset:d,relative:a,viewTransition:p});return i.createElement("a",xe({},m,{href:n||y,onClick:v||s?r:function(e){r&&r(e),e.defaultPrevented||b(e)},ref:t,target:u}))}));var Ae,je;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ae||(Ae={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(je||(je={}));function De(e){return De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},De(e)}function Pe(e){var t=function(e,t){if("object"!=De(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=De(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==De(t)?t:t+""}function Re(e,t,n){return(t=Pe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){Re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Me={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Fe=["color","size","strokeWidth","absoluteStrokeWidth","children"],Ue=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();var Ve=(e,t)=>{const n=(0,i.forwardRef)(((n,r)=>{let{color:a="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:l,children:c}=n,u=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(n,Fe);return(0,i.createElement)("svg",Le(Le({ref:r},Me),{},{width:s,height:s,stroke:a,strokeWidth:l?24*Number(o)/Number(s):o,className:"lucide lucide-".concat(Ue(e))},u),[...t.map((e=>{let[t,n]=e;return(0,i.createElement)(t,n)})),...(Array.isArray(c)?c:[c])||[]])}));return n.displayName="".concat(e),n};const ze=Ve("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),Be=Ve("Watch",[["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["polyline",{points:"12 10 12 12 13 13",key:"19dquz"}],["path",{d:"m16.13 7.66-.81-4.05a2 2 0 0 0-2-1.61h-2.68a2 2 0 0 0-2 1.61l-.78 4.05",key:"18k57s"}],["path",{d:"m7.88 16.36.8 4a2 2 0 0 0 2 1.61h2.72a2 2 0 0 0 2-1.61l.81-4.05",key:"16ny36"}]]),qe=Ve("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),He=Ve("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),We=Ve("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Ge=Ve("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Ke=Ve("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),Qe=Ve("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),Ye=Ve("Scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]),Xe=Ve("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]),Je=Ve("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),$e=Ve("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Ze=Ve("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),et=Ve("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),tt=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},nt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],a=i+1<e.length,s=a?e[i+1]:0,o=i+2<e.length,l=o?e[i+2]:0,c=t>>2,u=(3&t)<<4|s>>4;let h=(15&s)<<2|l>>6,d=63&l;o||(d=64,a||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(tt(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const a=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&a)}else if(i>239&&i<365){const a=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{const a=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&a)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0;++i;const s=i<e.length?n[e.charAt(i)]:64;++i;const o=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==a||null==s||null==o)throw new rt;const l=t<<2|a>>4;if(r.push(l),64!==s){const e=a<<4&240|s>>2;if(r.push(e),64!==o){const e=s<<6&192|o;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class rt extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const it=function(e){return function(e){const t=tt(e);return nt.encodeByteArray(t,!0)}(e).replace(/\./g,"")},at=function(e){try{return nt.decodeString(e,!0)}catch(Kw){console.error("base64Decode failed: ",Kw)}return null};const st=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,ot=()=>{try{return st()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"/energy_balance",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyCTHvBt2lLe9hCdgkqiDsHLfGTcPUJEuLY",REACT_APP_FIREBASE_AUTH_DOMAIN:"long-covid-8f42d.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"long-covid-8f42d",REACT_APP_FIREBASE_STORAGE_BUCKET:"long-covid-8f42d.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"1066445028663",REACT_APP_FIREBASE_APP_ID:"1:1066445028663:web:28bd3b28e184906feb2eb2",REACT_APP_FITBIT_CLIENT_ID:"23Q9SZ",REACT_APP_FITBIT_REDIRECT_URI:"https://obuchel.github.io/energy_balance/callback",REACT_APP_FITBIT_CLIENT_SECRET:"e30907e711956dbe26501f3af5fb7a6b",REACT_APP_FITBIT_REDIRECT_URI_PROD:"https://obuchel.github.io/energy_balance/fitbit-dashboard",REACT_APP_FITBIT_REDIRECT_URI_DEV:"http://localhost:64556/energy_balance/fitbit/callback"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(Kw){return}const t=e&&at(e[1]);return t&&JSON.parse(t)})()}catch(Kw){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(Kw))}},lt=e=>{var t,n;return null===(n=null===(t=ot())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},ct=()=>{var e;return null===(e=ot())||void 0===e?void 0:e.config},ut=e=>{var t;return null===(t=ot())||void 0===t?void 0:t["_".concat(e)]};class ht{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function dt(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function ft(){return!function(){var e;const t=null===(e=ot())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(Kw){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function pt(){try{return"object"===typeof indexedDB}catch(Kw){return!1}}class mt extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,mt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gt.prototype.create)}}class gt{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(vt,((e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",a="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new mt(n,a,t)}}const vt=/\{\$([^}]+)}/g;function yt(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],a=t[i];if(bt(n)&&bt(a)){if(!yt(n,a))return!1}else if(n!==a)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function bt(e){return null!==e&&"object"===typeof e}function wt(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function _t(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function xt(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class St{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=kt),void 0===r.error&&(r.error=kt),void 0===r.complete&&(r.complete=kt);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(Kw){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(Kw){"undefined"!==typeof console&&console.error&&console.error(Kw)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function kt(){}function Et(e){return e&&e._delegate?e._delegate:e}class Ct{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Nt="[DEFAULT]";class Tt{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new ht;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(Kw){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(Kw){if(r)return null;throw Kw}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Nt})}catch(Kw){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(Kw){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nt;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nt;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nt;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,a]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&a.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const a=this.instances.get(r);return a&&e(a,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===Nt?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(a){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nt;return this.component?this.component.multipleInstances?e:Nt:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class It{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Tt(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const At=[];var jt;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(jt||(jt={}));const Dt={debug:jt.DEBUG,verbose:jt.VERBOSE,info:jt.INFO,warn:jt.WARN,error:jt.ERROR,silent:jt.SILENT},Pt=jt.INFO,Rt={[jt.DEBUG]:"log",[jt.VERBOSE]:"log",[jt.INFO]:"info",[jt.WARN]:"warn",[jt.ERROR]:"error"},Ot=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=Rt[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];console[r]("[".concat(n,"]  ").concat(e.name,":"),...a)};class Lt{constructor(e){this.name=e,this._logLevel=Pt,this._logHandler=Ot,this._userLogHandler=null,At.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in jt))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?Dt[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,jt.DEBUG,...t),this._logHandler(this,jt.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,jt.VERBOSE,...t),this._logHandler(this,jt.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,jt.INFO,...t),this._logHandler(this,jt.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,jt.WARN,...t),this._logHandler(this,jt.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,jt.ERROR,...t),this._logHandler(this,jt.ERROR,...t)}}let Mt,Ft;const Ut=new WeakMap,Vt=new WeakMap,zt=new WeakMap,Bt=new WeakMap,qt=new WeakMap;let Ht={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Vt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||zt.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Kt(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Wt(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Ft||(Ft=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Qt(this),n),Kt(Ut.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Kt(e.apply(Qt(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const a=e.call(Qt(this),t,...r);return zt.set(a,t.sort?t.sort():[t]),Kt(a)}}function Gt(e){return"function"===typeof e?Wt(e):(e instanceof IDBTransaction&&function(e){if(Vt.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",a),e.removeEventListener("abort",a)},i=()=>{t(),r()},a=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",a),e.addEventListener("abort",a)}));Vt.set(e,t)}(e),((e,t)=>t.some((t=>e instanceof t)))(e,Mt||(Mt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Ht):e)}function Kt(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",a)},i=()=>{t(Kt(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",a)}));return t.then((t=>{t instanceof IDBCursor&&Ut.set(t,e)})).catch((()=>{})),qt.set(t,e),t}(e);if(Bt.has(e))return Bt.get(e);const t=Gt(e);return t!==e&&(Bt.set(e,t),qt.set(t,e)),t}const Qt=e=>qt.get(e);const Yt=["get","getKey","getAll","getAllKeys","count"],Xt=["put","add","delete","clear"],Jt=new Map;function $t(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Jt.get(t))return Jt.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Xt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Yt.includes(n))return;const a=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let a=t.store;for(var s=arguments.length,o=new Array(s>1?s-1:0),l=1;l<s;l++)o[l-1]=arguments[l];return r&&(a=a.index(o.shift())),(await Promise.all([a[n](...o),i&&t.done]))[0]};return Jt.set(t,a),a}Ht=(e=>Le(Le({},e),{},{get:(t,n,r)=>$t(t,n)||e.get(t,n,r),has:(t,n)=>!!$t(t,n)||e.has(t,n)}))(Ht);class Zt{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((e=>e)).join(" ")}}const en="@firebase/app",tn="0.10.13",nn=new Lt("@firebase/app"),rn="@firebase/app-compat",an="@firebase/analytics-compat",sn="@firebase/analytics",on="@firebase/app-check-compat",ln="@firebase/app-check",cn="@firebase/auth",un="@firebase/auth-compat",hn="@firebase/database",dn="@firebase/data-connect",fn="@firebase/database-compat",pn="@firebase/functions",mn="@firebase/functions-compat",gn="@firebase/installations",vn="@firebase/installations-compat",yn="@firebase/messaging",bn="@firebase/messaging-compat",wn="@firebase/performance",_n="@firebase/performance-compat",xn="@firebase/remote-config",Sn="@firebase/remote-config-compat",kn="@firebase/storage",En="@firebase/storage-compat",Cn="@firebase/firestore",Nn="@firebase/vertexai-preview",Tn="@firebase/firestore-compat",In="firebase",An="[DEFAULT]",jn={[en]:"fire-core",[rn]:"fire-core-compat",[sn]:"fire-analytics",[an]:"fire-analytics-compat",[ln]:"fire-app-check",[on]:"fire-app-check-compat",[cn]:"fire-auth",[un]:"fire-auth-compat",[hn]:"fire-rtdb",[dn]:"fire-data-connect",[fn]:"fire-rtdb-compat",[pn]:"fire-fn",[mn]:"fire-fn-compat",[gn]:"fire-iid",[vn]:"fire-iid-compat",[yn]:"fire-fcm",[bn]:"fire-fcm-compat",[wn]:"fire-perf",[_n]:"fire-perf-compat",[xn]:"fire-rc",[Sn]:"fire-rc-compat",[kn]:"fire-gcs",[En]:"fire-gcs-compat",[Cn]:"fire-fst",[Tn]:"fire-fst-compat",[Nn]:"fire-vertex","fire-js":"fire-js",[In]:"fire-js-all"},Dn=new Map,Pn=new Map,Rn=new Map;function On(e,t){try{e.container.addComponent(t)}catch(Kw){nn.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),Kw)}}function Ln(e){const t=e.name;if(Rn.has(t))return nn.debug("There were multiple attempts to register component ".concat(t,".")),!1;Rn.set(t,e);for(const n of Dn.values())On(n,e);for(const n of Pn.values())On(n,e);return!0}function Mn(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Fn(e){return void 0!==e.settings}const Un=new gt("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Vn{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ct("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Un.create("app-deleted",{appName:this._name})}}const zn="10.14.1";function Bn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:An,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw Un.create("bad-app-name",{appName:String(i)});if(n||(n=ct()),!n)throw Un.create("no-options");const a=Dn.get(i);if(a){if(yt(n,a.options)&&yt(r,a.config))return a;throw Un.create("duplicate-app",{appName:i})}const s=new It(i);for(const l of Rn.values())s.addComponent(l);const o=new Vn(n,r,s);return Dn.set(i,o),o}function qn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:An;const t=Dn.get(e);if(!t&&e===An&&ct())return Bn();if(!t)throw Un.create("no-app",{appName:e});return t}function Hn(e,t,n){var r;let i=null!==(r=jn[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const a=i.match(/\s|\//),s=t.match(/\s|\//);if(a||s){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return a&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),a&&s&&e.push("and"),s&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void nn.warn(e.join(" "))}Ln(new Ct("".concat(i,"-version"),(()=>({library:i,version:t})),"VERSION"))}const Wn="firebase-heartbeat-store";let Gn=null;function Kn(){return Gn||(Gn=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=indexedDB.open(e,t),o=Kt(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(Kt(s.result),e.oldVersion,e.newVersion,Kt(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{a&&e.addEventListener("close",(()=>a())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Wn)}catch(Kw){console.warn(Kw)}}}).catch((e=>{throw Un.create("idb-open",{originalErrorMessage:e.message})}))),Gn}async function Qn(e,t){try{const n=(await Kn()).transaction(Wn,"readwrite"),r=n.objectStore(Wn);await r.put(t,Yn(e)),await n.done}catch(Kw){if(Kw instanceof mt)nn.warn(Kw.message);else{const t=Un.create("idb-set",{originalErrorMessage:null===Kw||void 0===Kw?void 0:Kw.message});nn.warn(t.message)}}}function Yn(e){return"".concat(e.name,"!").concat(e.options.appId)}class Xn{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new $n(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Jn();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(Kw){nn.warn(Kw)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Jn(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Zn(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Zn(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=it(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(Kw){return nn.warn(Kw),""}}}function Jn(){return(new Date).toISOString().substring(0,10)}class $n{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!pt()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await Kn()).transaction(Wn),n=await t.objectStore(Wn).get(Yn(e));return await t.done,n}catch(Kw){if(Kw instanceof mt)nn.warn(Kw.message);else{const t=Un.create("idb-get",{originalErrorMessage:null===Kw||void 0===Kw?void 0:Kw.message});nn.warn(t.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Qn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Qn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Zn(e){return it(JSON.stringify({version:2,heartbeats:e})).length}var er;er="",Ln(new Ct("platform-logger",(e=>new Zt(e)),"PRIVATE")),Ln(new Ct("heartbeat",(e=>new Xn(e)),"PRIVATE")),Hn(en,tn,er),Hn(en,tn,"esm2017"),Hn("fire-js","");function tr(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function nr(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const rr=nr,ir=new gt("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),ar=new Lt("@firebase/auth");function sr(e){if(ar.logLevel<=jt.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];ar.error("Auth (".concat(zn,"): ").concat(e),...n)}}function or(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw hr(e,...n)}function lr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return hr(e,...n)}function cr(e,t,n){const r=Object.assign(Object.assign({},rr()),{[t]:n});return new gt("auth","Firebase",r).create(t,{appName:e.name})}function ur(e){return cr(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return ir.create(e,...n)}function dr(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw hr(t,...r)}}function fr(e){const t="INTERNAL ASSERTION FAILED: "+e;throw sr(t),new Error(t)}function pr(e,t){e||fr(t)}function mr(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function gr(){return"http:"===vr()||"https:"===vr()}function vr(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function yr(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(gr()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class br{constructor(e,t){this.shortDelay=e,this.longDelay=t,pr(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dt())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return yr()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function wr(e,t){pr(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class _r{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void fr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void fr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void fr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const xr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Sr=new br(3e4,6e4);function kr(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Er(e,t,n,r){return Cr(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let i={},a={};r&&("GET"===t?a=r:i={body:JSON.stringify(r)});const s=wt(Object.assign({key:e.config.apiKey},a)).slice(1),o=await e._getAdditionalHeaders();o["Content-Type"]="application/json",e.languageCode&&(o["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:o},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),_r.fetch()(Tr(e,e.config.apiHost,n,s),l)}))}async function Cr(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},xr),t);try{const t=new Ar(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw jr(e,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const t=i.ok?a.errorMessage:a.error.message,[n,s]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw jr(e,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw jr(e,"email-already-in-use",a);if("USER_DISABLED"===n)throw jr(e,"user-disabled",a);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(s)throw cr(e,o,s);or(e,o)}}catch(Kw){if(Kw instanceof mt)throw Kw;or(e,"network-request-failed",{message:String(Kw)})}}async function Nr(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const a=await Er(e,t,n,r,i);return"mfaPendingCredential"in a&&or(e,"multi-factor-auth-required",{_serverResponse:a}),a}function Tr(e,t,n,r){const i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?wr(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}function Ir(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ar{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(lr(this.auth,"network-request-failed"))),Sr.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function jr(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=lr(e,t,r);return i.customData._tokenResponse=n,i}function Dr(e){return void 0!==e&&void 0!==e.enterprise}class Pr{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Ir(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function Rr(e,t){return Er(e,"GET","/v2/recaptchaConfig",kr(e,t))}async function Or(e,t){return Er(e,"POST","/v1/accounts:lookup",t)}function Lr(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(Kw){}}function Mr(e){return 1e3*Number(e)}function Fr(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return sr("JWT malformed, contained fewer than 3 sections"),null;try{const e=at(n);return e?JSON.parse(e):(sr("Failed to decode base64 JWT payload"),null)}catch(Kw){return sr("Caught error parsing JWT payload as JSON",null===Kw||void 0===Kw?void 0:Kw.toString()),null}}function Ur(e){const t=Fr(e);return dr(t,"internal-error"),dr("undefined"!==typeof t.exp,"internal-error"),dr("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Vr(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(Kw){throw Kw instanceof mt&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(Kw)&&e.auth.currentUser===e&&await e.auth.signOut(),Kw}}class zr{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(Kw){return void((null===Kw||void 0===Kw?void 0:Kw.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class Br{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Lr(this.lastLoginAt),this.creationTime=Lr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function qr(e){var t;const n=e.auth,r=await e.getIdToken(),i=await Vr(e,Or(n,{idToken:r}));dr(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const a=i.users[0];e._notifyReloadListener(a);const s=(null===(t=a.providerUserInfo)||void 0===t?void 0:t.length)?Hr(a.providerUserInfo):[],o=(l=e.providerData,c=s,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const u=e.isAnonymous,h=!(e.email&&a.passwordHash)&&!(null===o||void 0===o?void 0:o.length),d=!!u&&h,f={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new Br(a.createdAt,a.lastLoginAt),isAnonymous:d};Object.assign(e,f)}function Hr(e){return e.map((e=>{var{providerId:t}=e,n=tr(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class Wr{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){dr(e.idToken,"internal-error"),dr("undefined"!==typeof e.idToken,"internal-error"),dr("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Ur(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){dr(0!==e.length,"internal-error");const t=Ur(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(dr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Cr(e,{},(async()=>{const n=wt({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,a=Tr(e,r,"/v1/token","key=".concat(i)),s=await e._getAdditionalHeaders();return s["Content-Type"]="application/x-www-form-urlencoded",_r.fetch()(a,{method:"POST",headers:s,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,a=new Wr;return n&&(dr("string"===typeof n,"internal-error",{appName:e}),a.refreshToken=n),r&&(dr("string"===typeof r,"internal-error",{appName:e}),a.accessToken=r),i&&(dr("number"===typeof i,"internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Wr,this.toJSON())}_performRefresh(){return fr("not implemented")}}function Gr(e,t){dr("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Kr{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=tr(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new zr(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Br(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Vr(this,this.stsTokenManager.getToken(this.auth,e));return dr(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Et(e),r=await n.getIdToken(t),i=Fr(r);dr(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const a="object"===typeof i.firebase?i.firebase:void 0,s=null===a||void 0===a?void 0:a.sign_in_provider;return{claims:i,token:r,authTime:Lr(Mr(i.auth_time)),issuedAtTime:Lr(Mr(i.iat)),expirationTime:Lr(Mr(i.exp)),signInProvider:s||null,signInSecondFactor:(null===a||void 0===a?void 0:a.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Et(e);await qr(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(dr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Kr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){dr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await qr(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fn(this.auth.app))return Promise.reject(ur(this.auth));const e=await this.getIdToken();return await Vr(this,async function(e,t){return Er(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,a,s,o,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(a=t.photoURL)&&void 0!==a?a:void 0,p=null!==(s=t.tenantId)&&void 0!==s?s:void 0,m=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:b,isAnonymous:w,providerData:_,stsTokenManager:x}=t;dr(y&&x,e,"internal-error");const S=Wr.fromJSON(this.name,x);dr("string"===typeof y,e,"internal-error"),Gr(u,e.name),Gr(h,e.name),dr("boolean"===typeof b,e,"internal-error"),dr("boolean"===typeof w,e,"internal-error"),Gr(d,e.name),Gr(f,e.name),Gr(p,e.name),Gr(m,e.name),Gr(g,e.name),Gr(v,e.name);const k=new Kr({uid:y,auth:e,email:h,emailVerified:b,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:S,createdAt:g,lastLoginAt:v});return _&&Array.isArray(_)&&(k.providerData=_.map((e=>Object.assign({},e)))),m&&(k._redirectEventId=m),k}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new Wr;r.updateFromServerResponse(t);const i=new Kr({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await qr(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];dr(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Hr(r.providerUserInfo):[],a=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),s=new Wr;s.updateFromIdToken(n);const o=new Kr({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:a}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Br(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(o,l),o}}const Qr=new Map;function Yr(e){pr(e instanceof Function,"Expected a class definition");let t=Qr.get(e);return t?(pr(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Qr.set(e,t),t)}class Xr{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Xr.type="NONE";const Jr=Xr;function $r(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class Zr{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=$r(this.userKey,r.apiKey,i),this.fullPersistenceKey=$r("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Kr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Zr(Yr(Jr),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||Yr(Jr);const a=$r(n,e.config.apiKey,e.name);let s=null;for(const c of t)try{const t=await c._get(a);if(t){const n=Kr._fromJSON(e,t);c!==i&&(s=n),i=c;break}}catch(l){}const o=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&o.length?(i=o[0],s&&await i._set(a,s.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(a)}catch(l){}}))),new Zr(i,e,n)):new Zr(i,e,n)}}function ei(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ii(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ti(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(si(t))return"Blackberry";if(oi(t))return"Webos";if(ni(t))return"Safari";if((t.includes("chrome/")||ri(t))&&!t.includes("edge/"))return"Chrome";if(ai(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function ti(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt();return/firefox\//i.test(e)}function ni(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ri(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt();return/crios\//i.test(e)}function ii(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt();return/iemobile/i.test(e)}function ai(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt();return/android/i.test(e)}function si(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt();return/blackberry/i.test(e)}function oi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt();return/webos/i.test(e)}function li(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ci(){return function(){const e=dt();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function ui(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt();return li(e)||ai(e)||oi(e)||si(e)||/windows phone/i.test(e)||ii(e)}function hi(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=ei(dt());break;case"Worker":t="".concat(ei(dt()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(zn,"/").concat(r)}class di{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(Kw){r(Kw)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(Kw){t.reverse();for(const r of t)try{r()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===Kw||void 0===Kw?void 0:Kw.message})}}}class fi{constructor(e){var t,n,r,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=a.minPasswordLength)&&void 0!==t?t:6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),void 0!==a.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),void 0!==a.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),void 0!==a.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),void 0!==a.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,a,s;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(i=o.containsUppercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(a=o.containsNumericCharacter)||void 0===a||a),o.isValid&&(o.isValid=null===(s=o.containsNonAlphanumericCharacter)||void 0===s||s),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class pi{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gi(this),this.idTokenSubscription=new gi(this),this.beforeStateQueue=new di(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ir,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Yr(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Zr.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(Kw){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Or(this,{idToken:e}),n=await Kr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Fn(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,a=null===r||void 0===r?void 0:r._redirectEventId,s=await this.tryRedirectSignIn(e);n&&n!==a||!(null===s||void 0===s?void 0:s.user)||(r=s.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(Kw){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(Kw)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return dr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(Kw){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await qr(e)}catch(Kw){if((null===Kw||void 0===Kw?void 0:Kw.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fn(this.app))return Promise.reject(ur(this));const t=e?Et(e):null;return t&&dr(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&dr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return Fn(this.app)?Promise.reject(ur(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fn(this.app)?Promise.reject(ur(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Yr(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Er(e,"GET","/v2/passwordPolicy",kr(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new fi(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new gt("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Er(e,"POST","/v2/accounts:revokeToken",kr(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Yr(e)||this._popupRedirectResolver;dr(t,this,"argument-error"),this.redirectPersistenceManager=await Zr.create(this,[Yr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let a=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(dr(s,this,"internal-error"),s.then((()=>{a||i(this.currentUser)})),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{a=!0,i()}}{const n=e.addObserver(t);return()=>{a=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return dr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hi(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(ar.logLevel<=jt.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];ar.warn("Auth (".concat(zn,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function mi(e){return Et(e)}class gi{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new St(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return dr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let vi={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function yi(e){return vi.loadJS(e)}function bi(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class wi{constructor(e){this.type="recaptcha-enterprise",this.auth=mi(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;Dr(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{Rr(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new Pr(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&Dr(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=vi.recaptchaEnterpriseScript;0!==t.length&&(t+=i),yi(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function _i(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new wi(e);let a;try{a=await i.verify(n)}catch(o){a=await i.verify(n,!0)}const s=Object.assign({},t);return r?Object.assign(s,{captchaResp:a}):Object.assign(s,{captchaResponse:a}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function xi(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await _i(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if(i.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const i=await _i(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}function Si(e,t,n){const r=mi(e);dr(r._canInitEmulator,r,"emulator-config-failed"),dr(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),a=ki(t),{host:s,port:o}=function(e){const t=ki(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Ei(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Ei(t)}}}(t),l=null===o?"":":".concat(o);r.config.emulator={url:"".concat(a,"//").concat(s).concat(l,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:s,port:o,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function ki(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Ei(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Ci{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return fr("not implemented")}_getIdTokenResponse(e){return fr("not implemented")}_linkToIdToken(e,t){return fr("not implemented")}_getReauthenticationResolver(e){return fr("not implemented")}}async function Ni(e,t){return Er(e,"POST","/v1/accounts:signUp",t)}async function Ti(e,t){return Nr(e,"POST","/v1/accounts:signInWithPassword",kr(e,t))}class Ii extends Ci{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Ii(e,t,"password")}static _fromEmailAndCode(e,t){return new Ii(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return xi(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Ti);case"emailLink":return async function(e,t){return Nr(e,"POST","/v1/accounts:signInWithEmailLink",kr(e,t))}(e,{email:this._email,oobCode:this._password});default:or(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return xi(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Ni);case"emailLink":return async function(e,t){return Nr(e,"POST","/v1/accounts:signInWithEmailLink",kr(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:or(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Ai(e,t){return Nr(e,"POST","/v1/accounts:signInWithIdp",kr(e,t))}class ji extends Ci{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ji(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):or("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=tr(t,["providerId","signInMethod"]);if(!n||!r)return null;const a=new ji(n,r);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){return Ai(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Ai(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ai(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=wt(t)}return e}}const Di={USER_NOT_FOUND:"user-not-found"};class Pi extends Ci{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Pi({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Pi({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Nr(e,"POST","/v1/accounts:signInWithPhoneNumber",kr(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Nr(e,"POST","/v1/accounts:signInWithPhoneNumber",kr(e,t));if(n.temporaryProof)throw jr(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Nr(e,"POST","/v1/accounts:signInWithPhoneNumber",kr(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Di)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Pi({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Ri{constructor(e){var t,n,r,i,a,s;const o=_t(xt(e)),l=null!==(t=o.apiKey)&&void 0!==t?t:null,c=null!==(n=o.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=o.mode)&&void 0!==r?r:null);dr(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=o.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(a=o.languageCode)&&void 0!==a?a:null,this.tenantId=null!==(s=o.tenantId)&&void 0!==s?s:null}static parseLink(e){const t=function(e){const t=_t(xt(e)).link,n=t?_t(xt(t)).deep_link_id:null,r=_t(xt(e)).deep_link_id;return(r?_t(xt(r)).link:null)||r||n||t||e}(e);try{return new Ri(t)}catch(n){return null}}}class Oi{constructor(){this.providerId=Oi.PROVIDER_ID}static credential(e,t){return Ii._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Ri.parseLink(t);return dr(n,"argument-error"),Ii._fromEmailAndCode(e,n.code,n.tenantId)}}Oi.PROVIDER_ID="password",Oi.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Oi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Li{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Mi extends Li{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Fi extends Mi{constructor(){super("facebook.com")}static credential(e){return ji._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Fi.credential(t.oauthAccessToken)}catch(n){return null}}}Fi.FACEBOOK_SIGN_IN_METHOD="facebook.com",Fi.PROVIDER_ID="facebook.com";class Ui extends Mi{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ji._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ui.credentialFromTaggedObject(e)}static credentialFromError(e){return Ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return Ui.credential(n,r)}catch(i){return null}}}Ui.GOOGLE_SIGN_IN_METHOD="google.com",Ui.PROVIDER_ID="google.com";class Vi extends Mi{constructor(){super("github.com")}static credential(e){return ji._fromParams({providerId:Vi.PROVIDER_ID,signInMethod:Vi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vi.credentialFromTaggedObject(e)}static credentialFromError(e){return Vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Vi.credential(t.oauthAccessToken)}catch(n){return null}}}Vi.GITHUB_SIGN_IN_METHOD="github.com",Vi.PROVIDER_ID="github.com";class zi extends Mi{constructor(){super("twitter.com")}static credential(e,t){return ji._fromParams({providerId:zi.PROVIDER_ID,signInMethod:zi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return zi.credentialFromTaggedObject(e)}static credentialFromError(e){return zi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return zi.credential(n,r)}catch(i){return null}}}async function Bi(e,t){return Nr(e,"POST","/v1/accounts:signUp",kr(e,t))}zi.TWITTER_SIGN_IN_METHOD="twitter.com",zi.PROVIDER_ID="twitter.com";class qi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await Kr._fromIdTokenResponse(e,n,r),a=Hi(n);return new qi({user:i,providerId:a,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Hi(n);return new qi({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Hi(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Wi extends mt{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Wi.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Wi(e,t,n,r)}}function Gi(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw Wi._fromErrorAndOperation(e,n,t,r);throw n}))}async function Ki(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Vr(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return qi._forOperation(e,"link",r)}async function Qi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(Fn(r.app))return Promise.reject(ur(r));const i="reauthenticate";try{const a=await Vr(e,Gi(r,i,t,e),n);dr(a.idToken,r,"internal-error");const s=Fr(a.idToken);dr(s,r,"internal-error");const{sub:o}=s;return dr(e.uid===o,r,"user-mismatch"),qi._forOperation(e,i,a)}catch(Kw){throw(null===Kw||void 0===Kw?void 0:Kw.code)==="auth/".concat("user-not-found")&&or(r,"user-mismatch"),Kw}}async function Yi(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Fn(e.app))return Promise.reject(ur(e));const r="signIn",i=await Gi(e,r,t),a=await qi._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(a.user),a}async function Xi(e,t){return Yi(mi(e),t)}async function Ji(e){const t=mi(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function $i(e,t,n){if(Fn(e.app))return Promise.reject(ur(e));const r=mi(e),i=xi(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Bi),a=await i.catch((t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&Ji(e),t})),s=await qi._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(s.user),s}function Zi(e){return Et(e).signOut()}new WeakMap;const ea="__sak";class ta{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ea,"1"),this.storage.removeItem(ea),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class na extends ta{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ui(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);ci()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}na.type="LOCAL";const ra=na;class ia extends ta{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ia.type="SESSION";const aa=ia;class sa{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new sa(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,a=this.handlersMap[r];if(!(null===a||void 0===a?void 0:a.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const s=Array.from(a).map((async e=>e(t.origin,i))),o=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(s);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function oa(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}sa.receivers=[];class la{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,a;return new Promise(((s,o)=>{const l=oa("",20);r.port1.start();const c=setTimeout((()=>{o(new Error("unsupported_event"))}),n);a={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),s(t.data.response);break;default:clearTimeout(c),clearTimeout(i),o(new Error("invalid_response"))}}},this.handlers.add(a),r.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{a&&this.removeMessageHandler(a)}))}}function ca(){return window}function ua(){return"undefined"!==typeof ca().WorkerGlobalScope&&"function"===typeof ca().importScripts}const ha="firebaseLocalStorageDb",da="firebaseLocalStorage",fa="fbase_key";class pa{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function ma(e,t){return e.transaction([da],t?"readwrite":"readonly").objectStore(da)}function ga(){const e=indexedDB.open(ha,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(da,{keyPath:fa})}catch(Kw){n(Kw)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(da)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(ha);return new pa(e).toPromise()}(),t(await ga()))}))}))}async function va(e,t,n){const r=ma(e,!0).put({[fa]:t,value:n});return new pa(r).toPromise()}function ya(e,t){const n=ma(e,!0).delete(t);return new pa(n).toPromise()}class ba{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await ga()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(Kw){if(t++>3)throw Kw;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ua()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sa._getInstance(ua()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new la(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ga();return await va(e,ea,"1"),await ya(e,ea),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>va(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=ma(e,!1).get(t),r=await new pa(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>ya(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=ma(e,!1).getAll();return new pa(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}ba.type="LOCAL";const wa=ba;bi("rcb"),new br(3e4,6e4);const _a="recaptcha";async function xa(e,t,n){var r;const i=await n.verify();try{let a;if(dr("string"===typeof i,e,"argument-error"),dr(n.type===_a,e,"argument-error"),a="string"===typeof t?{phoneNumber:t}:t,"session"in a){const t=a.session;if("phoneNumber"in a){dr("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Er(e,"POST","/v2/accounts/mfaEnrollment:start",kr(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{dr("signin"===t.type,e,"internal-error");const n=(null===(r=a.multiFactorHint)||void 0===r?void 0:r.uid)||a.multiFactorUid;dr(n,e,"missing-multi-factor-info");const s=await function(e,t){return Er(e,"POST","/v2/accounts/mfaSignIn:start",kr(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return s.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Er(e,"POST","/v1/accounts:sendVerificationCode",kr(e,t))}(e,{phoneNumber:a.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class Sa{constructor(e){this.providerId=Sa.PROVIDER_ID,this.auth=mi(e)}verifyPhoneNumber(e,t){return xa(this.auth,e,Et(t))}static credential(e,t){return Pi._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Sa.credentialFromTaggedObject(t)}static credentialFromError(e){return Sa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Pi._fromTokenResponse(n,r):null}}function ka(e,t){return t?Yr(t):(dr(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Sa.PROVIDER_ID="phone",Sa.PHONE_SIGN_IN_METHOD="phone";class Ea extends Ci{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ai(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ai(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ai(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ca(e){return Yi(e.auth,new Ea(e),e.bypassAuthState)}function Na(e){const{auth:t,user:n}=e;return dr(n,t,"internal-error"),Qi(n,new Ea(e),e.bypassAuthState)}async function Ta(e){const{auth:t,user:n}=e;return dr(n,t,"internal-error"),Ki(n,new Ea(e),e.bypassAuthState)}class Ia{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(Kw){this.reject(Kw)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:a,type:s}=e;if(a)return void this.reject(a);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(o))}catch(Kw){this.reject(Kw)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ca;case"linkViaPopup":case"linkViaRedirect":return Ta;case"reauthViaPopup":case"reauthViaRedirect":return Na;default:or(this.auth,"internal-error")}}resolve(e){pr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){pr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Aa=new br(2e3,1e4);class ja extends Ia{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,ja.currentPopupAction&&ja.currentPopupAction.cancel(),ja.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return dr(e,this.auth,"internal-error"),e}async onExecution(){pr(1===this.filter.length,"Popup operations only handle one event");const e=oa();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(lr(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(lr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ja.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(lr(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Aa.get())};e()}}ja.currentPopupAction=null;const Da=new Map;class Pa extends Ia{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Da.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=La(t),r=Oa(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(Kw){e=()=>Promise.reject(Kw)}Da.set(this.auth._key(),e)}return this.bypassAuthState||Da.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Ra(e,t){Da.set(e._key(),t)}function Oa(e){return Yr(e._redirectPersistence)}function La(e){return $r("pendingRedirect",e.config.apiKey,e.name)}async function Ma(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Fn(e.app))return Promise.reject(ur(e));const r=mi(e),i=ka(r,t),a=new Pa(r,i,n),s=await a.execute();return s&&!n&&(delete s.user._redirectEventId,await r._persistUserIfCurrent(s.user),await r._setRedirectUser(null,t)),s}class Fa{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Va(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Va(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(lr(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ua(e))}saveEventToCache(e){this.cachedEventUids.add(Ua(e)),this.lastProcessedEventTime=Date.now()}}function Ua(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Va(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const za=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ba=/^https?/;async function qa(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Er(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(Ha(r))return}catch(n){}or(e,"unauthorized-domain")}function Ha(e){const t=mr(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Ba.test(n))return!1;if(za.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Wa=new br(3e4,6e4);function Ga(){const e=ca().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Ka(e){return new Promise(((t,n)=>{var r,i,a;function s(){Ga(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Ga(),n(lr(e,"network-request-failed"))},timeout:Wa.get()})}if(null===(i=null===(r=ca().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(a=ca().gapi)||void 0===a?void 0:a.load)){const t=bi("iframefcb");return ca()[t]=()=>{gapi.load?s():n(lr(e,"network-request-failed"))},yi("".concat(vi.gapiScript,"?onload=").concat(t)).catch((e=>n(e)))}s()}})).catch((e=>{throw Qa=null,e}))}let Qa=null;const Ya=new br(5e3,15e3),Xa={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ja=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function $a(e){const t=e.config;dr(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?wr(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:zn},i=Ja.get(e.config.apiHost);i&&(r.eid=i);const a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),"".concat(n,"?").concat(wt(r).slice(1))}async function Za(e){const t=await function(e){return Qa=Qa||Ka(e),Qa}(e),n=ca().gapi;return dr(n,e,"internal-error"),t.open({where:document.body,url:$a(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Xa,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=lr(e,"network-request-failed"),a=ca().setTimeout((()=>{r(i)}),Ya.get());function s(){ca().clearTimeout(a),n(t)}t.ping(s).then(s,(()=>{r(i)}))}))))}const es={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ts{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(Kw){}}}function ns(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const a=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=Object.assign(Object.assign({},es),{width:r.toString(),height:i.toString(),top:a,left:s}),c=dt().toLowerCase();n&&(o=ri(c)?"_blank":n),ti(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")}),"");if(function(){var e;return li(arguments.length>0&&void 0!==arguments[0]?arguments[0]:dt())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==o)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",o),new ts(null);const h=window.open(t||"",o,u);dr(h,e,"popup-blocked");try{h.focus()}catch(Kw){}return new ts(h)}const rs="__/auth/handler",is="emulator/auth/handler",as=encodeURIComponent("fac");async function ss(e,t,n,r,i,a){dr(e.config.authDomain,e,"auth-domain-config-required"),dr(e.config.apiKey,e,"invalid-api-key");const s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:zn,eventId:i};if(t instanceof Li){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))s[e]=t}if(t instanceof Mi){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(s.scopes=e.join(","))}e.tenantId&&(s.tid=e.tenantId);const o=s;for(const u of Object.keys(o))void 0===o[u]&&delete o[u];const l=await e._getAppCheckToken(),c=l?"#".concat(as,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(rs);return wr(t,is)}(e),"?").concat(wt(o).slice(1)).concat(c)}const os="webStorageSupport";const ls=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=aa,this._completeRedirectFn=Ma,this._overrideRedirectResult=Ra}async _openPopup(e,t,n,r){var i;pr(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return ns(e,await ss(e,t,n,mr(),r),oa())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){ca().location.href=e}(await ss(e,t,n,mr(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(pr(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await Za(e),n=new Fa(e);return t.register("authEvent",(t=>{dr(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(os,{type:os},(n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[os];void 0!==i&&t(!!i),or(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=qa(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ui()||ni()||li()}};var cs="@firebase/auth",us="1.7.9";class hs{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){dr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ds=ut("authIdTokenMaxAge")||300;let fs=null;var ps;vi={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=lr("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},ps="Browser",Ln(new Ct("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=r.options;dr(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:s,authDomain:o,clientPlatform:ps,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hi(ps)},c=new pi(r,i,a,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Yr);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Ln(new Ct("auth-internal",(e=>(e=>new hs(e))(mi(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Hn(cs,us,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(ps)),Hn(cs,us,"esm2017");Hn("firebase","10.14.1","app");var ms,gs,vs="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},ys={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var a=e.g[3],s=t+(a^n&(i^a))+r[0]+3614090360&4294967295;s=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=(n=(i=(a=(t=n+(s<<7&4294967295|s>>>25))+((s=a+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^a&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(a^t))+r[3]+3250441966&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^n&(i^a))+r[4]+4118548399&4294967295)<<7&4294967295|s>>>25))+((s=a+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^a&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(a^t))+r[7]+4249261313&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^n&(i^a))+r[8]+1770035416&4294967295)<<7&4294967295|s>>>25))+((s=a+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^a&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(a^t))+r[11]+2304563134&4294967295)<<22&4294967295|s>>>10))+((s=t+(a^n&(i^a))+r[12]+1804603682&4294967295)<<7&4294967295|s>>>25))+((s=a+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|s>>>20))+((s=i+(n^a&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|s>>>15))+((s=n+(t^i&(a^t))+r[15]+1236535329&4294967295)<<22&4294967295|s>>>10))+((s=t+(i^a&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(a^t))+r[11]+643717713&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(i^a))+r[0]+3921069994&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^a&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(a^t))+r[15]+3634488961&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(i^a))+r[4]+3889429448&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^a&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(a^t))+r[3]+4107603335&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(i^a))+r[8]+1163531501&4294967295)<<20&4294967295|s>>>12))+((s=t+(i^a&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|s>>>27))+((s=a+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|s>>>23))+((s=i+(t^n&(a^t))+r[7]+1735328473&4294967295)<<14&4294967295|s>>>18))+((s=n+(a^t&(i^a))+r[12]+2368359562&4294967295)<<20&4294967295|s>>>12))+((s=t+(n^i^a)+r[5]+4294588738&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|s>>>21))+((s=i+(a^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^a^t)+r[14]+4259657740&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^a)+r[1]+2763975236&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|s>>>21))+((s=i+(a^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^a^t)+r[10]+3200236656&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^a)+r[13]+681279174&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|s>>>21))+((s=i+(a^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^a^t)+r[6]+76029189&4294967295)<<23&4294967295|s>>>9))+((s=t+(n^i^a)+r[9]+3654602809&4294967295)<<4&4294967295|s>>>28))+((s=a+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|s>>>21))+((s=i+(a^t^n)+r[15]+530742520&4294967295)<<16&4294967295|s>>>16))+((s=n+(i^a^t)+r[2]+3299628645&4294967295)<<23&4294967295|s>>>9))+((s=t+(i^(n|~a))+r[0]+4096336452&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(a|~n))+r[14]+2878612391&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~a))+r[12]+1700485571&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(a|~n))+r[10]+4293915773&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|s>>>11))+((s=t+(i^(n|~a))+r[8]+1873313359&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|s>>>22))+((s=i+(t^(a|~n))+r[6]+2734768916&4294967295)<<15&4294967295|s>>>17))+((s=n+(a^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|s>>>11))+((a=(t=n+((s=t+(i^(n|~a))+r[4]+4149444226&4294967295)<<6&4294967295|s>>>26))+((s=a+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|s>>>22))^((i=a+((s=i+(t^(a|~n))+r[2]+718787259&4294967295)<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+a&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var a=0|e[i];r&&a==t||(n[i]=a,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,a=this.h,s=0;s<t;){if(0==a)for(;s<=r;)n(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(i[a++]=e.charCodeAt(s++),a==this.blockSize){n(this,i),a=0;break}}else for(;s<t;)if(i[a++]=e[s++],a==this.blockSize){n(this,i),a=0;break}}this.h=a,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function a(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new r([0|e],0>e?-1:0)})):new r([0|e],0>e?-1:0)}function s(e){if(isNaN(e)||!isFinite(e))return o;if(0>e)return d(s(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var o=a(0),l=a(1),c=a(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(l)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(o,o);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=v(n),r=v(r);var i=y(n,1),a=y(r,1);for(r=y(r,2),n=y(n,2);!u(r);){var c=a.add(r);0>=c.l(e)&&(i=i.add(n),a=c),r=y(r,1),n=y(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=o;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),c=(a=s(n)).j(t);h(c)||0<c.l(e);)c=(a=s(n-=r)).j(t);u(a)&&(a=l),i=i.add(a),e=f(e,c)}return new m(i,e)}function v(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,a=[],s=0;s<i;s++)a[s]=0<t?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new r(a,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+d(this).toString(e);for(var t=s(Math.pow(e,6)),n=this,r="";;){var i=g(n,t).g,a=((0<(n=f(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return a+r;for(;6>a.length;)a="0"+a;r=a+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,a=0;a<=t;a++){var s=i+(65535&this.i(a))+(65535&e.i(a)),o=(s>>>16)+(this.i(a)>>>16)+(e.i(a)>>>16);i=o>>>16,s&=65535,o&=65535,n[a]=o<<16|s}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return o;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(0>this.l(c)&&0>e.l(c))return s(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var a=0;a<e.g.length;a++){var l=this.i(i)>>>16,f=65535&this.i(i),m=e.i(a)>>>16,g=65535&e.i(a);n[2*i+2*a]+=f*g,p(n,2*i+2*a),n[2*i+2*a+1]+=l*g,p(n,2*i+2*a+1),n[2*i+2*a+1]+=f*m,p(n,2*i+2*a+1),n[2*i+2*a+2]+=l*m,p(n,2*i+2*a+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,gs=ys.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=s,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=s(Math.pow(n,8)),i=o,a=0;a<t.length;a+=8){var l=Math.min(8,t.length-a),c=parseInt(t.substring(a,a+l),n);8>l?(l=s(Math.pow(n,l)),i=i.j(l).add(s(c))):i=(i=i.j(r)).add(s(c))}return i},ms=ys.Integer=r}).apply("undefined"!==typeof vs?vs:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var bs,ws,_s,xs,Ss,ks,Es,Cs,Ns="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Ts={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Ns&&Ns];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var a=0;a<e.length-1;a++){var s=e[a];if(!(s in i))break e;i=i[s]}(r=r(a=i[e=e[e.length-1]]))!=a&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e,t){return t}))}}));var r=r||{},i=this||self;function a(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function s(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function d(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(a(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function y(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function b(e){const t={};for(const n in e)t[n]=e[n];return t}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<w.length;t++)n=w[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function x(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function S(e){i.setTimeout((()=>{throw e}),0)}function k(){var e=I;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var E=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new C),(e=>e.reset()));class C{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let N,T=!1,I=new class{constructor(){this.h=this.g=null}add(e,t){const n=E.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},A=()=>{const e=i.Promise.resolve(void 0);N=()=>{e.then(j)}};var j=()=>{for(var e;e=k();){try{e.h.call(e.g)}catch(n){S(n)}var t=E;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}T=!1};function D(){this.s=this.s,this.C=this.C}function P(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}D.prototype.s=!1,D.prototype.ma=function(){this.s||(this.s=!0,this.N())},D.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},P.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function O(e,t){if(P.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var i=!0;break e}catch(a){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:L[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&O.aa.h.call(this)}}h(O,P);var L={2:"touch",3:"pen",4:"mouse"};O.prototype.h=function(){O.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var M="closure_listenable_"+(1e6*Math.random()|0),F=0;function U(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++F,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function z(e){this.src=e,this.g={},this.h=0}function B(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],a=Array.prototype.indexOf.call(i,t,void 0);(r=0<=a)&&Array.prototype.splice.call(i,a,1),r&&(V(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function q(e,t,n,r){for(var i=0;i<e.length;++i){var a=e[i];if(!a.da&&a.listener==t&&a.capture==!!n&&a.ha==r)return i}return-1}z.prototype.add=function(e,t,n,r,i){var a=e.toString();(e=this.g[a])||(e=this.g[a]=[],this.h++);var s=q(e,t,r,i);return-1<s?(t=e[s],n||(t.fa=!1)):((t=new U(t,this.src,a,!!r,i)).fa=n,e.push(t)),t};var H="closure_lm_"+(1e6*Math.random()|0),W={};function G(e,t,n,r,i){if(r&&r.once)return Q(e,t,n,r,i);if(Array.isArray(t)){for(var a=0;a<t.length;a++)G(e,t[a],n,r,i);return null}return n=te(n),e&&e[M]?e.K(t,n,s(r)?!!r.capture:!!r,i):K(e,t,n,!1,r,i)}function K(e,t,n,r,i,a){if(!t)throw Error("Invalid event type");var o=s(i)?!!i.capture:!!i,l=Z(e);if(l||(e[H]=l=new z(e)),(n=l.add(t,n,r,o,a)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=$;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)R||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(J(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Q(e,t,n,r,i){if(Array.isArray(t)){for(var a=0;a<t.length;a++)Q(e,t[a],n,r,i);return null}return n=te(n),e&&e[M]?e.L(t,n,s(r)?!!r.capture:!!r,i):K(e,t,n,!0,r,i)}function Y(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)Y(e,t[a],n,r,i);else r=s(r)?!!r.capture:!!r,n=te(n),e&&e[M]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=q(a=e.g[t],n,r,i))&&(V(a[n]),Array.prototype.splice.call(a,n,1),0==a.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=q(t,n,r,i)),(n=-1<e?t[e]:null)&&X(n))}function X(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[M])B(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(J(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(B(n,e),0==n.h&&(n.src=null,t[H]=null)):V(e)}}}function J(e){return e in W?W[e]:W[e]="on"+e}function $(e,t){if(e.da)e=!0;else{t=new O(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&X(e),e=n.call(r,t)}return e}function Z(e){return(e=e[H])instanceof z?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){D.call(this),this.i=new z(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new P(t,e);else if(t instanceof P)t.target=t.target||e;else{var i=t;_(t=new P(r,e),i)}if(i=!0,n)for(var a=n.length-1;0<=a;a--){var s=t.g=n[a];i=ie(s,r,!0,t)&&i}if(i=ie(s=t.g=e,r,!0,t)&&i,i=ie(s,r,!1,t)&&i,n)for(a=0;a<n.length;a++)i=ie(s=t.g=n[a],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,a=0;a<t.length;++a){var s=t[a];if(s&&!s.da&&s.capture==n){var o=s.listener,l=s.ha||s.src;s.fa&&B(e.i,s),i=!1!==o.call(l,r)&&i}}return i&&!r.defaultPrevented}function ae(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function se(e){e.g=ae((()=>{e.g=null,e.i&&(e.i=!1,se(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(ne,D),ne.prototype[M]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Y(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)V(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class oe extends D{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:se(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){D.call(this),this.h=e,this.g={}}h(le,D);var ce=[];function ue(e){y(e.g,(function(e,t){this.g.hasOwnProperty(t)&&X(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ue(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=i.JSON.stringify,de=i.JSON.parse,fe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){P.call(this,"d")}function be(){P.call(this,"c")}h(ye,P),h(be,P);var we={},_e=null;function xe(){return _e=_e||new ne}function Se(e){P.call(this,we.La,e)}function ke(e){const t=xe();re(t,new Se(t))}function Ee(e,t){P.call(this,we.STAT_EVENT,e),this.stat=t}function Ce(e){const t=xe();re(t,new Ee(t,e))}function Ne(e,t){P.call(this,we.Ma,e),this.size=t}function Te(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout((function(){e()}),t)}function Ie(){this.g=!0}function Ae(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var s=1;s<i.length;s++)i[s]=""}}}return he(n)}catch(o){return t}}(e,n)+(r?" "+r:"")}))}we.La="serverreachability",h(Se,P),we.STAT_EVENT="statevent",h(Ee,P),we.Ma="timingevent",h(Ne,P),Ie.prototype.xa=function(){this.g=!1},Ie.prototype.info=function(){};var je,De={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Pe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Re(){}function Oe(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Le}function Le(){this.i=null,this.g="",this.h=!1}h(Re,pe),Re.prototype.g=function(){return new XMLHttpRequest},Re.prototype.i=function(){return{}},je=new Re;var Me={},Fe={};function Ue(e,t,n){e.L=1,e.v=ht(st(t)),e.m=n,e.P=!0,Ve(e,null)}function Ve(e,t){e.F=Date.now(),qe(e),e.A=st(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Et(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Le,e.g=fn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new oe(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ce[0]=i.toString()),i=ce);for(var a=0;a<i.length;a++){var s=G(n,i[a],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}t=e.H?b(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),ke(),function(e,t,n,r,i,a){e.info((function(){if(e.g)if(a)for(var s="",o=a.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");s=2<=h.length&&"type"==h[1]?s+(u+"=")+c+"&":s+(u+"=redacted&")}}else s=null;else s=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+s}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function ze(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Be(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Fe:(n=Number(t.substring(n,r)),isNaN(n)?Me:(r+=1)+n>t.length?Fe:(t=t.slice(r,r+n),e.C=r+n,t))}function qe(e){e.S=Date.now()+e.I,He(e,e.I)}function He(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Te(c(e.ba,e),t)}function We(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function Ge(e){0==e.j.G||e.J||ln(e.j,e)}function Ke(e){We(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ue(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Qe(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;on(n),Xt(n)}rn(n),Ce(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=Te(c(n.Za,n),6e3));if(1>=$e(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else un(n,11)}else if((e.K||n.g==e)&&on(n),!p(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var a=r.h;a.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(et(a,a.h),a.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ut(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var s=e;if((r=n).qa=dn(r,r.J?r.ia:null,r.W),s.K){tt(r.h,s);var o=s,l=r.L;l&&(o.I=l),o.B&&(We(o),qe(o)),r.g=s}else nn(r);0<n.i.length&&$t(n)}else"stop"!=c[0]&&"close"!=c[0]||un(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?un(n,7):Yt(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}ke()}catch(u){}}Oe.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Wt(e)?t.j():this.Y(e)},Oe.prototype.Y=function(e){try{if(e==this.g)e:{const d=Wt(this.g);var t=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||Gt(this.g)))){this.J||4!=d||7==t||ke(),We(this);var n=this.g.Z();this.X=n;t:if(ze(this)){var r=Gt(this.g);e="";var a=r.length,s=4==Wt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ke(this),Ge(this);var o="";break t}this.h.i=new i.TextDecoder}for(t=0;t<a;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(s&&t==a-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,a,s){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+a+" "+s}))}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Ce(12),Ke(this),Ge(this);break e}Ae(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Qe(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=Be(this,o),e==Fe){4==d&&(this.s=4,Ce(14),n=!1),Ae(this.i,this.l,null,"[Incomplete Response]");break}if(e==Me){this.s=4,Ce(15),Ae(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Ae(this.i,this.l,e,null),Qe(this,e)}if(ze(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=o.length||this.h.h||(this.s=1,Ce(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),an(h),h.M=!0,Ce(11))}}else Ae(this.i,this.l,o,"[Invalid Chunked Response]"),Ke(this),Ge(this)}else Ae(this.i,this.l,o,null),Qe(this,o);4==d&&Ke(this),this.o&&!this.J&&(4==d?ln(this.j,this):(this.o=!1,qe(this)))}else(function(e){const t={};e=(e.g&&2<=Wt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=x(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const a=t[i]||[];t[i]=a,a.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Ce(12)):(this.s=0,Ce(13)),Ke(this),Ge(this)}}}catch(Is){}},Oe.prototype.cancel=function(){this.J=!0,Ke(this)},Oe.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(ke(),Ce(17)),Ke(this),this.s=2,Ge(this)):He(this,this.S-e)};var Ye=class{constructor(e,t){this.g=e,this.map=t}};function Xe(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Je(e){return!!e.h||!!e.g&&e.g.size>=e.j}function $e(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return d(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(a(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(a(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(a(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}Xe.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function at(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof at){this.h=e.h,ot(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new _t;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ct(this,n),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,ot(this,t[1]||"",!0),this.o=dt(t[2]||""),this.g=dt(t[3]||"",!0),lt(this,t[4]),this.l=dt(t[5]||"",!0),ct(this,t[6]||"",!0),this.m=dt(t[7]||"")):(this.h=!1,this.i=new _t(null,this.h))}function st(e){return new at(e)}function ot(e,t,n){e.j=n?dt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ct(e,t,n){t instanceof _t?(e.i=t,function(e,t){t&&!e.j&&(xt(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(St(this,t),Et(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,bt)),e.i=new _t(t,e.h))}function ut(e,t,n){e.i.set(t,n)}function ht(e){return ut(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function dt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}at.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?yt:vt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,wt)),e.join("")};var mt,gt=/[#\/\?@]/g,vt=/[#\?:]/g,yt=/[#\?]/g,bt=/[#\?@]/g,wt=/#/g;function _t(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function xt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var a=e[n].substring(0,r);i=e[n].substring(r+1)}else a=e[n];t(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function St(e,t){xt(e),t=Ct(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function kt(e,t){return xt(e),t=Ct(e,t),e.g.has(t)}function Et(e,t,n){St(e,t),0<n.length&&(e.i=null,e.g.set(Ct(e,t),d(n)),e.h+=n.length)}function Ct(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Nt(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(a){}}function Tt(){this.g=new fe}function It(e,t,n){const r=n||"";try{rt(e,(function(e,n){let i=e;s(e)&&(i=he(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(Kw){throw t.push(r+"type="+encodeURIComponent("_badmap")),Kw}}function At(e){this.l=e.Ub||null,this.j=e.eb||!1}function jt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Dt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Pt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Rt(e)}function Rt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Ot(e){let t="";return y(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Lt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Ot(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ut(e,t,n))}function Mt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=_t.prototype).add=function(e,t){xt(this),this.i=null,e=Ct(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){xt(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){xt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){xt(this);let t=[];if("string"===typeof e)kt(this,e)&&(t=t.concat(this.g.get(Ct(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return xt(this),this.i=null,kt(this,e=Ct(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const a=encodeURIComponent(String(r)),s=this.V(r);for(r=0;r<s.length;r++){var i=a;""!==s[r]&&(i+="="+encodeURIComponent(String(s[r]))),e.push(i)}}return this.i=e.join("&")},h(At,pe),At.prototype.g=function(){return new jt(this.l,this.j)},At.prototype.i=(mt={},function(){return mt}),h(jt,ne),(e=jt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Rt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Pt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Rt(this)),this.g&&(this.readyState=3,Rt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Dt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Pt(this):Rt(this),3==this.readyState&&Dt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Pt(this))},e.Qa=function(e){this.g&&(this.response=e,Pt(this))},e.ga=function(){this.g&&Pt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(jt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(Mt,ne);var Ft=/^https?$/i,Ut=["POST","PUT"];function Vt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,zt(e),qt(e)}function zt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function Bt(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=Wt(e)||2!=e.Z()))if(e.u&&4==Wt(e))ae(e.Ea,0,e);else if(re(e,"readystatechange"),4==Wt(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var a;if(a=0===r){var s=String(e.D).match(it)[1]||null;!s&&i.self&&i.self.location&&(s=i.self.location.protocol.slice(0,-1)),a=!Ft.test(s?s.toLowerCase():"")}n=a}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var o=2<Wt(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",zt(e)}}finally{qt(e)}}}function qt(e,t){if(e.g){Ht(e);const n=e.g,r=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{n.onreadystatechange=r}catch(Kw){}}}function Ht(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function Wt(e){return e.g?e.g.readyState:0}function Gt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Ds){return null}}function Kt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Qt(e){this.Aa=0,this.i=[],this.j=new Ie,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Kt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Kt("baseRetryDelayMs",5e3,e),this.cb=Kt("retryDelaySeedMs",1e4,e),this.Wa=Kt("forwardChannelMaxRetries",2,e),this.wa=Kt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Xe(e&&e.concurrentRequestLimit),this.Da=new Tt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Yt(e){if(Jt(e),3==e.G){var t=e.U++,n=st(e.I);if(ut(n,"SID",e.K),ut(n,"RID",t),ut(n,"TYPE","terminate"),en(e,n),(t=new Oe(e,e.j,t)).L=2,t.v=ht(st(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=fn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),qe(t)}hn(e)}function Xt(e){e.g&&(an(e),e.g.cancel(),e.g=null)}function Jt(e){Xt(e),e.u&&(i.clearTimeout(e.u),e.u=null),on(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function $t(e){if(!Je(e.h)&&!e.s){e.s=!0;var t=e.Ga;N||A(),T||(N(),T=!0),I.add(t,e),e.B=0}}function Zt(e,t){var n;n=t?t.l:e.U++;const r=st(e.I);ut(r,"SID",e.K),ut(r,"RID",n),ut(r,"AID",e.T),en(e,r),e.m&&e.o&&Lt(r,e.m,e.o),n=new Oe(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=tn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),Ue(n,r,t)}function en(e,t){e.H&&y(e.H,(function(e,n){ut(t,n,e)})),e.l&&rt({},(function(e,n){ut(t,n,e)}))}function tn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let a=!0;for(let s=0;s<n;s++){let n=i[s].g;const o=i[s].map;if(n-=t,0>n)t=Math.max(0,i[s].g-100),a=!1;else try{It(o,e,"req"+n+"_")}catch(Is){r&&r(o)}}if(a){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function nn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;N||A(),T||(N(),T=!0),I.add(t,e),e.v=0}}function rn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Te(c(e.Fa,e),cn(e,e.v)),e.v++,!0)}function an(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function sn(e){e.g=new Oe(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=st(e.qa);ut(t,"RID","rpc"),ut(t,"SID",e.K),ut(t,"AID",e.T),ut(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ut(t,"TO",e.ja),ut(t,"TYPE","xmlhttp"),en(e,t),e.m&&e.o&&Lt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ht(st(t)),n.m=null,n.P=!0,Ve(n,e)}function on(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function ln(e,t){var n=null;if(e.g==t){on(e),an(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=xe(),new Ne(r,n)),$t(e)}else nn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!($e(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Te(c(e.Ga,e,t),cn(e,e.B)),e.B++,!0))}(e,t)||2==r&&rn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:un(e,5);break;case 4:un(e,10);break;case 3:un(e,6);break;default:un(e,2)}}function cn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function un(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new at(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||ot(r,"https"),ht(r),t?function(e,t){const n=new Ie;if(i.Image){const r=new Image;r.onload=u(Nt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Nt,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Nt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Nt,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ie;const n=new AbortController,r=setTimeout((()=>{n.abort(),Nt(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?Nt(0,0,!0,t):Nt(0,0,!1,t)})).catch((()=>{clearTimeout(r),Nt(0,0,!1,t)}))}(r.toString(),n)}else Ce(2);e.G=0,e.l&&e.l.sa(t),hn(e),Jt(e)}function hn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.ra()}}function dn(e,t,n){var r=n instanceof at?st(n):new at(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var a=i.location;r=a.protocol,t=t?t+"."+a.hostname:a.hostname,a=+a.port;var s=new at(null);r&&ot(s,r),t&&(s.g=t),a&&lt(s,a),n&&(s.l=n),r=s}return n=e.D,t=e.ya,n&&t&&ut(r,n,t),ut(r,"VER",e.la),en(e,r),r}function fn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Mt(new At({eb:n})):new Mt(e.pa)).Ha(e.J),t}function pn(){}function mn(){}function gn(e,t){ne.call(this),this.g=new Qt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new bn(this)}function vn(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function yn(){be.call(this),this.status=1}function bn(e){this.g=e}(e=Mt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():je.g(),this.v=this.o?me(this.o):me(je),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Vt(this,s)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var a in r)n.set(a,r[a]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),a=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Ut,t,void 0))||r||a||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ht(this),this.u=!0,this.g.send(e),this.u=!1}catch(s){Vt(this,s)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),qt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),qt(this,!0)),Mt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Bt(this):this.bb())},e.bb=function(){Bt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<Wt(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),de(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Qt.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Ce(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=dn(this,null,this.W),$t(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Oe(this,this.j,e);let a=this.o;if(this.S&&(a?(a=b(a),_(a,this.S)):a=this.S),null!==this.m||this.O||(i.H=a,a=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=tn(this,i,t),ut(n=st(this.I),"RID",e),ut(n,"CVER",22),this.D&&ut(n,"X-HTTP-Session-Id",this.D),en(this,n),a&&(this.O?t="headers="+encodeURIComponent(String(Ot(a)))+"&"+t:this.m&&Lt(n,this.m,a)),et(this.h,i),this.Ua&&ut(n,"TYPE","init"),this.P?(ut(n,"$req",t),ut(n,"SID","null"),i.T=!0,Ue(i,n,null)):Ue(i,n,t),this.G=2}}else 3==this.G&&(e?Zt(this,e):0==this.i.length||Je(this.h)||Zt(this))},e.Fa=function(){if(this.u=null,sn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Te(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ce(10),Xt(this),sn(this))},e.Za=function(){null!=this.C&&(this.C=null,Xt(this),rn(this),Ce(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ce(2)):(this.j.info("Failed to ping google.com"),Ce(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=pn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},mn.prototype.g=function(e,t){return new gn(e,t)},h(gn,ne),gn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},gn.prototype.close=function(){Yt(this.g)},gn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=he(e),e=n);t.i.push(new Ye(t.Ya++,e)),3==t.G&&$t(t)},gn.prototype.N=function(){this.g.l=null,delete this.j,Yt(this.g),delete this.g,gn.aa.N.call(this)},h(vn,ye),h(yn,be),h(bn,pn),bn.prototype.ua=function(){re(this.g,"a")},bn.prototype.ta=function(e){re(this.g,new vn(e))},bn.prototype.sa=function(e){re(this.g,new yn)},bn.prototype.ra=function(){re(this.g,"b")},mn.prototype.createWebChannel=mn.prototype.g,gn.prototype.send=gn.prototype.o,gn.prototype.open=gn.prototype.m,gn.prototype.close=gn.prototype.close,Cs=Ts.createWebChannelTransport=function(){return new mn},Es=Ts.getStatEventTarget=function(){return xe()},ks=Ts.Event=we,Ss=Ts.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},De.NO_ERROR=0,De.TIMEOUT=8,De.HTTP_ERROR=6,xs=Ts.ErrorCode=De,Pe.COMPLETE="complete",_s=Ts.EventType=Pe,ge.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,ws=Ts.WebChannel=ge,Ts.FetchXmlHttpFactory=At,Mt.prototype.listenOnce=Mt.prototype.L,Mt.prototype.getLastError=Mt.prototype.Ka,Mt.prototype.getLastErrorCode=Mt.prototype.Ba,Mt.prototype.getStatus=Mt.prototype.Z,Mt.prototype.getResponseJson=Mt.prototype.Oa,Mt.prototype.getResponseText=Mt.prototype.oa,Mt.prototype.send=Mt.prototype.ea,Mt.prototype.setWithCredentials=Mt.prototype.Ha,bs=Ts.XhrIo=Mt}).apply("undefined"!==typeof Ns?Ns:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Is="@firebase/firestore";class As{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}As.UNAUTHENTICATED=new As(null),As.GOOGLE_CREDENTIALS=new As("google-credentials-uid"),As.FIRST_PARTY=new As("first-party-uid"),As.MOCK_USER=new As("mock-user");let js="10.14.0";const Ds=new Lt("@firebase/firestore");function Ps(){return Ds.logLevel}function Rs(e){if(Ds.logLevel<=jt.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ms);Ds.debug("Firestore (".concat(js,"): ").concat(e),...i)}}function Os(e){if(Ds.logLevel<=jt.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ms);Ds.error("Firestore (".concat(js,"): ").concat(e),...i)}}function Ls(e){if(Ds.logLevel<=jt.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ms);Ds.warn("Firestore (".concat(js,"): ").concat(e),...i)}}function Ms(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function Fs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(js,") INTERNAL ASSERTION FAILED: ")+e;throw Os(t),new Error(t)}function Us(e,t){e||Fs()}function Vs(e,t){return e}const zs={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Bs extends mt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class qs{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Hs{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class Ws{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(As.UNAUTHENTICATED)))}shutdown(){}}class Gs{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Ks{constructor(e){this.t=e,this.currentUser=As.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Us(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new qs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new qs,e.enqueueRetryable((()=>r(this.currentUser)))};const a=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},s=e=>{Rs("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((e=>s(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?s(e):(Rs("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new qs)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Rs("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Us("string"==typeof t.accessToken),new Hs(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Us(null===e||"string"==typeof e),new As(e)}}class Qs{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=As.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Ys{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Qs(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(As.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Xs{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Js{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Us(void 0===this.o);const n=e=>{null!=e.error&&Rs("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.R;return this.R=e.token,Rs("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{Rs("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):Rs("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Us("string"==typeof e.token),this.R=e.token,new Xs(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function $s(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Zs{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=$s(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function eo(e,t){return e<t?-1:e>t?1:0}function to(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}class no{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Bs(zs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Bs(zs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Bs(zs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Bs(zs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return no.fromMillis(Date.now())}static fromDate(e){return no.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new no(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?eo(this.nanoseconds,e.nanoseconds):eo(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ro{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ro(e)}static min(){return new ro(new no(0,0))}static max(){return new ro(new no(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class io{constructor(e,t,n){void 0===t?t=0:t>e.length&&Fs(),void 0===n?n=e.length-t:n>e.length-t&&Fs(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===io.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof io?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ao extends io{construct(e,t,n){return new ao(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new Bs(zs.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter((e=>e.length>0)))}return new ao(e)}static emptyPath(){return new ao([])}}const so=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class oo extends io{construct(e,t,n){return new oo(e,t,n)}static isValidIdentifier(e){return so.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),oo.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new oo(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Bs(zs.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let a=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Bs(zs.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Bs(zs.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(a=!a,r++):"."!==t||a?(n+=t,r++):(i(),r++)}if(i(),a)throw new Bs(zs.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new oo(t)}static emptyPath(){return new oo([])}}class lo{constructor(e){this.path=e}static fromPath(e){return new lo(ao.fromString(e))}static fromName(e){return new lo(ao.fromString(e).popFirst(5))}static empty(){return new lo(ao.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ao.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return ao.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new lo(new ao(e.slice()))}}class co{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}co.UNKNOWN_ID=-1;function uo(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=ro.fromTimestamp(1e9===r?new no(n+1,0):new no(n,r));return new fo(i,lo.empty(),t)}function ho(e){return new fo(e.readTime,e.key,-1)}class fo{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new fo(ro.min(),lo.empty(),-1)}static max(){return new fo(ro.max(),lo.empty(),-1)}}function po(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=lo.comparator(e.documentKey,t.documentKey),0!==n?n:eo(e.largestBatchId,t.largestBatchId))}const mo="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class go{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function vo(e){if(e.code!==zs.FAILED_PRECONDITION||e.message!==mo)throw e;Rs("LocalStore","Unexpectedly lost primary lease")}class yo{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Fs(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new yo(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof yo?t:yo.resolve(t)}catch(e){return yo.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):yo.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):yo.reject(t)}static resolve(e){return new yo(((t,n)=>{t(e)}))}static reject(e){return new yo(((t,n)=>{n(e)}))}static waitFor(e){return new yo(((t,n)=>{let r=0,i=0,a=!1;e.forEach((e=>{++r,e.next((()=>{++i,a&&i===r&&t()}),(e=>n(e)))})),a=!0,i===r&&t()}))}static or(e){let t=yo.resolve(!1);for(const n of e)t=t.next((e=>e?yo.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new yo(((n,r)=>{const i=e.length,a=new Array(i);let s=0;for(let o=0;o<i;o++){const l=o;t(e[l]).next((e=>{a[l]=e,++s,s===i&&n(a)}),(e=>r(e)))}}))}static doWhile(e,t){return new yo(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}function bo(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function wo(e){return"IndexedDbTransactionError"===e.name}class _o{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function xo(e){return null==e}function So(e){return 0===e&&1/e==-1/0}function ko(e){return"number"==typeof e&&Number.isInteger(e)&&!So(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}_o.oe=-1;const Eo=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Co=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],No=Co,To=[...No,"indexConfiguration","indexState","indexEntries"];function Io(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Ao(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function jo(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Do{constructor(e,t){this.comparator=e,this.root=t||Ro.EMPTY}insert(e,t){return new Do(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Ro.BLACK,null,null))}remove(e){return new Do(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ro.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push("".concat(t,":").concat(n)),!1))),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Po(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Po(this.root,e,this.comparator,!1)}getReverseIterator(){return new Po(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Po(this.root,e,this.comparator,!0)}}class Po{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ro{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Ro.RED,this.left=null!=r?r:Ro.EMPTY,this.right=null!=i?i:Ro.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Ro(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Ro.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Ro.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ro.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ro.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Fs();if(this.right.isRed())throw Fs();const e=this.left.check();if(e!==this.right.check())throw Fs();return e+(this.isRed()?0:1)}}Ro.EMPTY=null,Ro.RED=!0,Ro.BLACK=!1,Ro.EMPTY=new class{constructor(){this.size=0}get key(){throw Fs()}get value(){throw Fs()}get color(){throw Fs()}get left(){throw Fs()}get right(){throw Fs()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Ro(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Oo{constructor(e){this.comparator=e,this.data=new Do(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Lo(this.data.getIterator())}getIteratorFrom(e){return new Lo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Oo))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Oo(this.comparator);return t.data=e,t}}class Lo{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Mo{constructor(e){this.fields=e,e.sort(oo.comparator)}static empty(){return new Mo([])}unionWith(e){let t=new Oo(oo.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Mo(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return to(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Fo extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Uo{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Fo("Invalid base64 string: "+e):e}}(e);return new Uo(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Uo(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return eo(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Uo.EMPTY_BYTE_STRING=new Uo("");const Vo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zo(e){if(Us(!!e),"string"==typeof e){let t=0;const n=Vo.exec(e);if(Us(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Bo(e.seconds),nanos:Bo(e.nanos)}}function Bo(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function qo(e){return"string"==typeof e?Uo.fromBase64String(e):Uo.fromUint8Array(e)}function Ho(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Wo(e){const t=e.mapValue.fields.__previous_value__;return Ho(t)?Wo(t):t}function Go(e){const t=zo(e.mapValue.fields.__local_write_time__.timestampValue);return new no(t.seconds,t.nanos)}class Ko{constructor(e,t,n,r,i,a,s,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=s,this.longPollingOptions=o,this.useFetchStreams=l}}class Qo{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Qo("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Qo&&e.projectId===this.projectId&&e.database===this.database}}const Yo={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Xo(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Ho(e)?4:dl(e)?9007199254740991:ul(e)?10:11:Fs()}function Jo(e,t){if(e===t)return!0;const n=Xo(e);if(n!==Xo(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Go(e).isEqual(Go(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=zo(e.timestampValue),r=zo(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return qo(e.bytesValue).isEqual(qo(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Bo(e.geoPointValue.latitude)===Bo(t.geoPointValue.latitude)&&Bo(e.geoPointValue.longitude)===Bo(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Bo(e.integerValue)===Bo(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Bo(e.doubleValue),r=Bo(t.doubleValue);return n===r?So(n)===So(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return to(e.arrayValue.values||[],t.arrayValue.values||[],Jo);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Io(n)!==Io(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Jo(n[i],r[i])))return!1;return!0}(e,t);default:return Fs()}}function $o(e,t){return void 0!==(e.values||[]).find((e=>Jo(e,t)))}function Zo(e,t){if(e===t)return 0;const n=Xo(e),r=Xo(t);if(n!==r)return eo(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return eo(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Bo(e.integerValue||e.doubleValue),r=Bo(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return el(e.timestampValue,t.timestampValue);case 4:return el(Go(e),Go(t));case 5:return eo(e.stringValue,t.stringValue);case 6:return function(e,t){const n=qo(e),r=qo(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=eo(n[i],r[i]);if(0!==e)return e}return eo(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=eo(Bo(e.latitude),Bo(t.latitude));return 0!==n?n:eo(Bo(e.longitude),Bo(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return tl(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,a;const s=e.fields||{},o=t.fields||{},l=null===(n=s.value)||void 0===n?void 0:n.arrayValue,c=null===(r=o.value)||void 0===r?void 0:r.arrayValue,u=eo((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(a=null==c?void 0:c.values)||void 0===a?void 0:a.length)||0);return 0!==u?u:tl(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Yo.mapValue&&t===Yo.mapValue)return 0;if(e===Yo.mapValue)return 1;if(t===Yo.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(let s=0;s<r.length&&s<a.length;++s){const e=eo(r[s],a[s]);if(0!==e)return e;const t=Zo(n[r[s]],i[a[s]]);if(0!==t)return t}return eo(r.length,a.length)}(e.mapValue,t.mapValue);default:throw Fs()}}function el(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return eo(e,t);const n=zo(e),r=zo(t),i=eo(n.seconds,r.seconds);return 0!==i?i:eo(n.nanos,r.nanos)}function tl(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=Zo(n[i],r[i]);if(e)return e}return eo(n.length,r.length)}function nl(e){return rl(e)}function rl(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=zo(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return qo(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return lo.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=rl(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(rl(e.fields[i]));return n+"}"}(e.mapValue):Fs()}function il(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function al(e){return!!e&&"integerValue"in e}function sl(e){return!!e&&"arrayValue"in e}function ol(e){return!!e&&"nullValue"in e}function ll(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function cl(e){return!!e&&"mapValue"in e}function ul(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function hl(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Ao(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=hl(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=hl(e.arrayValue.values[n]);return t}return Object.assign({},e)}function dl(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class fl{constructor(e){this.value=e}static empty(){return new fl({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!cl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hl(t)}setAll(e){let t=oo.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=hl(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());cl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Jo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];cl(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Ao(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new fl(hl(this.value))}}function pl(e){const t=[];return Ao(e.fields,((e,n)=>{const r=new oo([e]);if(cl(n)){const e=pl(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new Mo(t)}class ml{constructor(e,t,n,r,i,a,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=a,this.documentState=s}static newInvalidDocument(e){return new ml(e,0,ro.min(),ro.min(),ro.min(),fl.empty(),0)}static newFoundDocument(e,t,n,r){return new ml(e,1,t,ro.min(),n,r,0)}static newNoDocument(e,t){return new ml(e,2,t,ro.min(),ro.min(),fl.empty(),0)}static newUnknownDocument(e,t){return new ml(e,3,t,ro.min(),ro.min(),fl.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ro.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=fl.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=fl.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ro.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ml&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ml(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class gl{constructor(e,t){this.position=e,this.inclusive=t}}function vl(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const a=t[i],s=e.position[i];if(r=a.field.isKeyField()?lo.comparator(lo.fromName(s.referenceValue),n.key):Zo(s,n.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function yl(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Jo(e.position[n],t.position[n]))return!1;return!0}class bl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function wl(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class _l{}class xl extends _l{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Al(e,t,n):"array-contains"===t?new Rl(e,n):"in"===t?new Ol(e,n):"not-in"===t?new Ll(e,n):"array-contains-any"===t?new Ml(e,n):new xl(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new jl(e,n):new Dl(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Zo(t,this.value)):null!==t&&Xo(this.value)===Xo(t)&&this.matchesComparison(Zo(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Fs()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Sl extends _l{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Sl(e,t)}matches(e){return kl(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function kl(e){return"and"===e.op}function El(e){return Cl(e)&&kl(e)}function Cl(e){for(const t of e.filters)if(t instanceof Sl)return!1;return!0}function Nl(e){if(e instanceof xl)return e.field.canonicalString()+e.op.toString()+nl(e.value);if(El(e))return e.filters.map((e=>Nl(e))).join(",");{const t=e.filters.map((e=>Nl(e))).join(",");return"".concat(e.op,"(").concat(t,")")}}function Tl(e,t){return e instanceof xl?function(e,t){return t instanceof xl&&e.op===t.op&&e.field.isEqual(t.field)&&Jo(e.value,t.value)}(e,t):e instanceof Sl?function(e,t){return t instanceof Sl&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&Tl(n,t.filters[r])),!0)}(e,t):void Fs()}function Il(e){return e instanceof xl?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(nl(e.value))}(e):e instanceof Sl?function(e){return e.op.toString()+" {"+e.getFilters().map(Il).join(" ,")+"}"}(e):"Filter"}class Al extends xl{constructor(e,t,n){super(e,t,n),this.key=lo.fromName(n.referenceValue)}matches(e){const t=lo.comparator(e.key,this.key);return this.matchesComparison(t)}}class jl extends xl{constructor(e,t){super(e,"in",t),this.keys=Pl("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Dl extends xl{constructor(e,t){super(e,"not-in",t),this.keys=Pl("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Pl(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>lo.fromName(e.referenceValue)))}class Rl extends xl{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return sl(t)&&$o(t.arrayValue,this.value)}}class Ol extends xl{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&$o(this.value.arrayValue,t)}}class Ll extends xl{constructor(e,t){super(e,"not-in",t)}matches(e){if($o(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!$o(this.value.arrayValue,t)}}class Ml extends xl{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!sl(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>$o(this.value.arrayValue,e)))}}class Fl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=a,this.endAt=s,this.ue=null}}function Ul(e){return new Fl(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Vl(e){const t=Vs(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Nl(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),xo(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>nl(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>nl(e))).join(",")),t.ue=e}return t.ue}function zl(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!wl(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Tl(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!yl(e.startAt,t.startAt)&&yl(e.endAt,t.endAt)}function Bl(e){return lo.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class ql{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=a,this.startAt=s,this.endAt=o,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Hl(e,t,n,r,i,a,s,o){return new ql(e,t,n,r,i,a,s,o)}function Wl(e){return new ql(e)}function Gl(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Kl(e){return null!==e.collectionGroup}function Ql(e){const t=Vs(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Oo(oo.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new bl(r,n))})),e.has(oo.keyField().canonicalString())||t.ce.push(new bl(oo.keyField(),n))}return t.ce}function Yl(e){const t=Vs(e);return t.le||(t.le=Xl(t,Ql(e))),t.le}function Xl(e,t){if("F"===e.limitType)return Ul(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new bl(e.field,t)}));const n=e.endAt?new gl(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new gl(e.startAt.position,e.startAt.inclusive):null;return Ul(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Jl(e,t){const n=e.filters.concat([t]);return new ql(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function $l(e,t,n){return new ql(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Zl(e,t){return zl(Yl(e),Yl(t))&&e.limitType===t.limitType}function ec(e){return"".concat(Vl(Yl(e)),"|lt:").concat(e.limitType)}function tc(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((e=>Il(e))).join(", "),"]")),xo(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e))).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>nl(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>nl(e))).join(",")),"Target(".concat(t,")")}(Yl(e)),"; limitType=").concat(e.limitType,")")}function nc(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):lo.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Ql(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=vl(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Ql(e),t))&&!(e.endAt&&!function(e,t,n){const r=vl(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Ql(e),t))}(e,t)}function rc(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function ic(e){return(t,n)=>{let r=!1;for(const i of Ql(e)){const e=ac(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function ac(e,t,n){const r=e.field.isKeyField()?lo.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Zo(r,i):Fs()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Fs()}}class sc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ao(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return jo(this.inner)}size(){return this.innerSize}}const oc=new Do(lo.comparator);function lc(){return oc}const cc=new Do(lo.comparator);function uc(){let e=cc;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function hc(e){let t=cc;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function dc(){return pc()}function fc(){return pc()}function pc(){return new sc((e=>e.toString()),((e,t)=>e.isEqual(t)))}const mc=new Do(lo.comparator),gc=new Oo(lo.comparator);function vc(){let e=gc;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const yc=new Oo(eo);function bc(){return yc}function wc(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:So(t)?"-0":t}}function _c(e){return{integerValue:""+e}}function xc(e,t){return ko(t)?_c(t):wc(e,t)}class Sc{constructor(){this._=void 0}}function kc(e,t,n){return e instanceof Nc?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Ho(t)&&(t=Wo(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Tc?Ic(e,t):e instanceof Ac?jc(e,t):function(e,t){const n=Cc(e,t),r=Pc(n)+Pc(e.Pe);return al(n)&&al(e.Pe)?_c(r):wc(e.serializer,r)}(e,t)}function Ec(e,t,n){return e instanceof Tc?Ic(e,t):e instanceof Ac?jc(e,t):n}function Cc(e,t){return e instanceof Dc?function(e){return al(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Nc extends Sc{}class Tc extends Sc{constructor(e){super(),this.elements=e}}function Ic(e,t){const n=Rc(t);for(const r of e.elements)n.some((e=>Jo(e,r)))||n.push(r);return{arrayValue:{values:n}}}class Ac extends Sc{constructor(e){super(),this.elements=e}}function jc(e,t){let n=Rc(t);for(const r of e.elements)n=n.filter((e=>!Jo(e,r)));return{arrayValue:{values:n}}}class Dc extends Sc{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Pc(e){return Bo(e.integerValue||e.doubleValue)}function Rc(e){return sl(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Oc{constructor(e,t){this.version=e,this.transformResults=t}}class Lc{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Lc}static exists(e){return new Lc(void 0,e)}static updateTime(e){return new Lc(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Mc(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Fc{}function Uc(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Yc(e.key,Lc.none()):new Hc(e.key,e.data,Lc.none());{const n=e.data,r=fl.empty();let i=new Oo(oo.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Wc(e.key,r,new Mo(i.toArray()),Lc.none())}}function Vc(e,t,n){e instanceof Hc?function(e,t,n){const r=e.value.clone(),i=Kc(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Wc?function(e,t,n){if(!Mc(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Kc(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Gc(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function zc(e,t,n,r){return e instanceof Hc?function(e,t,n,r){if(!Mc(e.precondition,t))return n;const i=e.value.clone(),a=Qc(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Wc?function(e,t,n,r){if(!Mc(e.precondition,t))return n;const i=Qc(e.fieldTransforms,r,t),a=t.data;return a.setAll(Gc(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Mc(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Bc(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Cc(r.transform,e||null);null!=i&&(null===n&&(n=fl.empty()),n.set(r.field,i))}return n||null}function qc(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&to(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Tc&&t instanceof Tc||e instanceof Ac&&t instanceof Ac?to(e.elements,t.elements,Jo):e instanceof Dc&&t instanceof Dc?Jo(e.Pe,t.Pe):e instanceof Nc&&t instanceof Nc}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Hc extends Fc{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Wc extends Fc{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Gc(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Kc(e,t,n){const r=new Map;Us(e.length===n.length);for(let i=0;i<n.length;i++){const a=e[i],s=a.transform,o=t.data.field(a.field);r.set(a.field,Ec(s,o,n[i]))}return r}function Qc(e,t,n){const r=new Map;for(const i of e){const e=i.transform,a=n.data.field(i.field);r.set(i.field,kc(e,a,t))}return r}class Yc extends Fc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Xc extends Fc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Jc{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Vc(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=zc(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=zc(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=fc();return this.mutations.forEach((r=>{const i=e.get(r.key),a=i.overlayedDocument;let s=this.applyToLocalView(a,i.mutatedFields);s=t.has(r.key)?null:s;const o=Uc(a,s);null!==o&&n.set(r.key,o),a.isValidDocument()||a.convertToNoDocument(ro.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),vc())}isEqual(e){return this.batchId===e.batchId&&to(this.mutations,e.mutations,((e,t)=>qc(e,t)))&&to(this.baseMutations,e.baseMutations,((e,t)=>qc(e,t)))}}class $c{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Us(e.mutations.length===n.length);let r=mc;const i=e.mutations;for(let a=0;a<i.length;a++)r=r.insert(i[a].key,n[a].version);return new $c(e,t,n,r)}}class Zc{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class eu{constructor(e,t){this.count=e,this.unchangedNames=t}}var tu,nu;function ru(e){switch(e){default:return Fs();case zs.CANCELLED:case zs.UNKNOWN:case zs.DEADLINE_EXCEEDED:case zs.RESOURCE_EXHAUSTED:case zs.INTERNAL:case zs.UNAVAILABLE:case zs.UNAUTHENTICATED:return!1;case zs.INVALID_ARGUMENT:case zs.NOT_FOUND:case zs.ALREADY_EXISTS:case zs.PERMISSION_DENIED:case zs.FAILED_PRECONDITION:case zs.ABORTED:case zs.OUT_OF_RANGE:case zs.UNIMPLEMENTED:case zs.DATA_LOSS:return!0}}function iu(e){if(void 0===e)return Os("GRPC error has no .code"),zs.UNKNOWN;switch(e){case tu.OK:return zs.OK;case tu.CANCELLED:return zs.CANCELLED;case tu.UNKNOWN:return zs.UNKNOWN;case tu.DEADLINE_EXCEEDED:return zs.DEADLINE_EXCEEDED;case tu.RESOURCE_EXHAUSTED:return zs.RESOURCE_EXHAUSTED;case tu.INTERNAL:return zs.INTERNAL;case tu.UNAVAILABLE:return zs.UNAVAILABLE;case tu.UNAUTHENTICATED:return zs.UNAUTHENTICATED;case tu.INVALID_ARGUMENT:return zs.INVALID_ARGUMENT;case tu.NOT_FOUND:return zs.NOT_FOUND;case tu.ALREADY_EXISTS:return zs.ALREADY_EXISTS;case tu.PERMISSION_DENIED:return zs.PERMISSION_DENIED;case tu.FAILED_PRECONDITION:return zs.FAILED_PRECONDITION;case tu.ABORTED:return zs.ABORTED;case tu.OUT_OF_RANGE:return zs.OUT_OF_RANGE;case tu.UNIMPLEMENTED:return zs.UNIMPLEMENTED;case tu.DATA_LOSS:return zs.DATA_LOSS;default:return Fs()}}(nu=tu||(tu={}))[nu.OK=0]="OK",nu[nu.CANCELLED=1]="CANCELLED",nu[nu.UNKNOWN=2]="UNKNOWN",nu[nu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",nu[nu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",nu[nu.NOT_FOUND=5]="NOT_FOUND",nu[nu.ALREADY_EXISTS=6]="ALREADY_EXISTS",nu[nu.PERMISSION_DENIED=7]="PERMISSION_DENIED",nu[nu.UNAUTHENTICATED=16]="UNAUTHENTICATED",nu[nu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",nu[nu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",nu[nu.ABORTED=10]="ABORTED",nu[nu.OUT_OF_RANGE=11]="OUT_OF_RANGE",nu[nu.UNIMPLEMENTED=12]="UNIMPLEMENTED",nu[nu.INTERNAL=13]="INTERNAL",nu[nu.UNAVAILABLE=14]="UNAVAILABLE",nu[nu.DATA_LOSS=15]="DATA_LOSS";let au=null;function su(){return new TextEncoder}const ou=new ms([4294967295,4294967295],0);function lu(e){const t=su().encode(e),n=new gs;return n.update(t),new Uint8Array(n.digest())}function cu(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new ms([n,r],0),new ms([i,a],0)]}class uu{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new hu("Invalid padding: ".concat(t));if(n<0)throw new hu("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new hu("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new hu("Invalid padding when bitmap length is 0: ".concat(t));this.Ie=8*e.length-t,this.Te=ms.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(ms.fromNumber(n)));return 1===r.compare(ou)&&(r=new ms([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=lu(e),[n,r]=cu(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new uu(i,r,t);return n.forEach((e=>a.insert(e))),a}insert(e){if(0===this.Ie)return;const t=lu(e),[n,r]=cu(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class hu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class du{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,fu.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new du(ro.min(),r,new Do(eo),lc(),vc())}}class fu{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new fu(n,t,vc(),vc(),vc())}}class pu{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class mu{constructor(e,t){this.targetId=e,this.me=t}}class gu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uo.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class vu{constructor(){this.fe=0,this.ge=wu(),this.pe=Uo.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=vc(),t=vc(),n=vc();return this.ge.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Fs()}})),new fu(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=wu()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Us(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class yu{constructor(e){this.Le=e,this.Be=new Map,this.ke=lc(),this.qe=bu(),this.Qe=new Do(eo)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Fs()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((e,n)=>{this.ze(n)&&t(n)}))}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const i=r.target;if(Bl(i))if(0===n){const e=new lo(i.path);this.Ue(t,e,ml.newNoDocument(e,ro.min()))}else Us(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),i=n?this.Xe(n,e,r):1;if(0!==i){this.je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==au||au.et(function(e,t,n,r,i){var a,s,o,l,c,u;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(a=null==d?void 0:d.hashCount)&&void 0!==a?a:0,bitmapLength:null!==(l=null===(o=null===(s=null==d?void 0:d.bits)||void 0===s?void 0:s.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==d?void 0:d.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.me,this.Le.tt(),n,i))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let a,s;try{a=qo(n).toUint8Array()}catch(e){if(e instanceof Fo)return Ls("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{s=new uu(a,r,i)}catch(e){return Ls(e instanceof hu?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===s.Ie?null:s}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Le.tt(),a="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(a)||(this.Ue(t,n,null),r++)})),r}rt(e){const t=new Map;this.Be.forEach(((n,r)=>{const i=this.Je(r);if(i){if(n.current&&Bl(i.target)){const t=new lo(i.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,ml.newNoDocument(t,e))}n.be&&(t.set(r,n.ve()),n.Ce())}}));let n=vc();this.qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.ke.forEach(((t,n)=>n.setReadTime(e)));const r=new du(e,t,this.Qe,this.ke,n);return this.ke=lc(),this.qe=bu(),this.Qe=new Do(eo),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new vu,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Oo(eo),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||Rs("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new vu),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function bu(){return new Do(lo.comparator)}function wu(){return new Do(lo.comparator)}const _u={asc:"ASCENDING",desc:"DESCENDING"},xu={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Su={and:"AND",or:"OR"};class ku{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Eu(e,t){return e.useProto3Json||xo(t)?t:{value:t}}function Cu(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Nu(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Tu(e,t){return Cu(e,t.toTimestamp())}function Iu(e){return Us(!!e),ro.fromTimestamp(function(e){const t=zo(e);return new no(t.seconds,t.nanos)}(e))}function Au(e,t){return ju(e,t).canonicalString()}function ju(e,t){const n=function(e){return new ao(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Du(e){const t=ao.fromString(e);return Us($u(t)),t}function Pu(e,t){return Au(e.databaseId,t.path)}function Ru(e,t){const n=Du(t);if(n.get(1)!==e.databaseId.projectId)throw new Bs(zs.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Bs(zs.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new lo(Fu(n))}function Ou(e,t){return Au(e.databaseId,t)}function Lu(e){const t=Du(e);return 4===t.length?ao.emptyPath():Fu(t)}function Mu(e){return new ao(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Fu(e){return Us(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Uu(e,t,n){return{name:Pu(e,t),fields:n.value.mapValue.fields}}function Vu(e,t){let n;if(t instanceof Hc)n={update:Uu(e,t.key,t.value)};else if(t instanceof Yc)n={delete:Pu(e,t.key)};else if(t instanceof Wc)n={update:Uu(e,t.key,t.data),updateMask:Ju(t.fieldMask)};else{if(!(t instanceof Xc))return Fs();n={verify:Pu(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Nc)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Tc)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ac)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Dc)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw Fs()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Tu(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Fs()}(e,t.precondition)),n}function zu(e,t){return{documents:[Ou(e,t.path)]}}function Bu(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Ou(e,i);const a=function(e){if(0!==e.length)return Xu(Sl.create(e,"and"))}(t.filters);a&&(n.structuredQuery.where=a);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Qu(e.field),direction:Wu(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=Eu(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:i}}function qu(e){let t=Lu(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Us(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let a=[];n.where&&(a=function(e){const t=Hu(e);return t instanceof Sl&&El(t)?t.getFilters():[t]}(n.where));let s=[];n.orderBy&&(s=function(e){return e.map((e=>function(e){return new bl(Yu(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,xo(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new gl(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new gl(n,t)}(n.endAt)),Hl(t,i,s,a,o,"F",l,c)}function Hu(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Yu(e.unaryFilter.field);return xl.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Yu(e.unaryFilter.field);return xl.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Yu(e.unaryFilter.field);return xl.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Yu(e.unaryFilter.field);return xl.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Fs()}}(e):void 0!==e.fieldFilter?function(e){return xl.create(Yu(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Fs()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Sl.create(e.compositeFilter.filters.map((e=>Hu(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Fs()}}(e.compositeFilter.op))}(e):Fs()}function Wu(e){return _u[e]}function Gu(e){return xu[e]}function Ku(e){return Su[e]}function Qu(e){return{fieldPath:e.canonicalString()}}function Yu(e){return oo.fromServerFormat(e.fieldPath)}function Xu(e){return e instanceof xl?function(e){if("=="===e.op){if(ll(e.value))return{unaryFilter:{field:Qu(e.field),op:"IS_NAN"}};if(ol(e.value))return{unaryFilter:{field:Qu(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ll(e.value))return{unaryFilter:{field:Qu(e.field),op:"IS_NOT_NAN"}};if(ol(e.value))return{unaryFilter:{field:Qu(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Qu(e.field),op:Gu(e.op),value:e.value}}}(e):e instanceof Sl?function(e){const t=e.getFilters().map((e=>Xu(e)));return 1===t.length?t[0]:{compositeFilter:{op:Ku(e.op),filters:t}}}(e):Fs()}function Ju(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function $u(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Zu{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ro.min(),a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ro.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Uo.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=s,this.expectedCount=o}withSequenceNumber(e){return new Zu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Zu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class eh{constructor(e){this.ct=e}}function th(e){const t=qu({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?$l(t,t.limit,"L"):t}class nh{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Bo(e.integerValue));else if("doubleValue"in e){const n=Bo(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),So(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=zo(n)),t.Rt("".concat(n.seconds||"")),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(qo(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?dl(e)?this.dt(t,Number.MAX_SAFE_INTEGER):ul(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Fs()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const r of Object.keys(n))this.Vt(r,t),this.Tt(n[r],t)}wt(e,t){var n,r;const i=e.fields||{};this.dt(t,53);const a="value",s=(null===(r=null===(n=i[a].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.dt(t,15),t.At(Bo(s)),this.Vt(a,t),this.Tt(i[a],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const r of n)this.Tt(r,t)}yt(e,t){this.dt(t,37),lo.fromName(e).path.forEach((e=>{this.dt(t,60),this.Dt(e,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}nh.vt=new nh;class rh{constructor(){this.un=new ih}addToCollectionParentIndex(e,t){return this.un.add(t),yo.resolve()}getCollectionParents(e,t){return yo.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return yo.resolve()}deleteFieldIndex(e,t){return yo.resolve()}deleteAllFieldIndexes(e){return yo.resolve()}createTargetIndexes(e,t){return yo.resolve()}getDocumentsMatchingTarget(e,t){return yo.resolve(null)}getIndexType(e,t){return yo.resolve(0)}getFieldIndexes(e,t){return yo.resolve([])}getNextCollectionGroupToUpdate(e){return yo.resolve(null)}getMinOffset(e,t){return yo.resolve(fo.min())}getMinOffsetFromCollectionGroup(e,t){return yo.resolve(fo.min())}updateCollectionGroup(e,t,n){return yo.resolve()}updateIndexEntries(e,t){return yo.resolve()}}class ih{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Oo(ao.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Oo(ao.comparator)).toArray()}}new Uint8Array(0);class ah{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new ah(e,ah.DEFAULT_COLLECTION_PERCENTILE,ah.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}ah.DEFAULT_COLLECTION_PERCENTILE=10,ah.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ah.DEFAULT=new ah(41943040,ah.DEFAULT_COLLECTION_PERCENTILE,ah.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ah.DISABLED=new ah(-1,0,0);class sh{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new sh(0)}static kn(){return new sh(-1)}}class oh{constructor(){this.changes=new sc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ml.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?yo.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class lh{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ch{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&zc(n.mutation,e,Mo.empty(),no.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,vc()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:vc();const r=dc();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=uc();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=dc();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,vc())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=lc();const a=pc(),s=pc();return t.forEach(((e,t)=>{const s=n.get(t.key);r.has(t.key)&&(void 0===s||s.mutation instanceof Wc)?i=i.insert(t.key,t):void 0!==s?(a.set(t.key,s.mutation.getFieldMask()),zc(s.mutation,t,s.mutation.getFieldMask(),no.now())):a.set(t.key,Mo.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>a.set(e,t))),t.forEach(((e,t)=>{var n;return s.set(e,new lh(t,null!==(n=a.get(e))&&void 0!==n?n:null))})),s)))}recalculateAndSaveOverlays(e,t){const n=pc();let r=new Do(((e,t)=>e-t)),i=vc();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const a=t.get(e);if(null===a)return;let s=n.get(e)||Mo.empty();s=i.applyToLocalView(a,s),n.set(e,s);const o=(r.get(i.batchId)||vc()).add(e);r=r.insert(i.batchId,o)}))})).next((()=>{const a=[],s=r.getReverseIterator();for(;s.hasNext();){const r=s.getNext(),o=r.key,l=r.value,c=fc();l.forEach((e=>{if(!i.has(e)){const r=Uc(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}})),a.push(this.documentOverlayCache.saveOverlays(e,o,c))}return yo.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return lo.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Kl(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):yo.resolve(dc());let s=-1,o=i;return a.next((t=>yo.forEach(t,((t,n)=>(s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?yo.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,o,t,vc()))).next((e=>({batchId:s,changes:hc(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new lo(t)).next((e=>{let t=uc();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let a=uc();return this.indexManager.getCollectionParents(e,i).next((s=>yo.forEach(s,(s=>{const o=function(e,t){return new ql(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next((e=>{e.forEach(((e,t)=>{a=a.insert(e,t)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,ml.newInvalidDocument(r)))}));let n=uc();return e.forEach(((e,r)=>{const a=i.get(e);void 0!==a&&zc(a.mutation,r,Mo.empty(),no.now()),nc(t,r)&&(n=n.insert(e,r))})),n}))}}class uh{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return yo.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Iu(e.createTime)}}(t)),yo.resolve()}getNamedQuery(e,t){return yo.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:th(e.bundledQuery),readTime:Iu(e.readTime)}}(t)),yo.resolve()}}class hh{constructor(){this.overlays=new Do(lo.comparator),this.Ir=new Map}getOverlay(e,t){return yo.resolve(this.overlays.get(t))}getOverlays(e,t){const n=dc();return yo.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),yo.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Ir.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Ir.delete(n)),yo.resolve()}getOverlaysForCollection(e,t,n){const r=dc(),i=t.length+1,a=new lo(t.child("")),s=this.overlays.getIteratorFrom(a);for(;s.hasNext();){const e=s.getNext().value,a=e.getKey();if(!t.isPrefixOf(a.path))break;a.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return yo.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Do(((e,t)=>e-t));const a=this.overlays.getIterator();for(;a.hasNext();){const e=a.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=dc(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const s=dc(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>s.set(e,t))),!(s.size()>=r)););return yo.resolve(s)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Ir.get(r.largestBatchId).delete(n.key);this.Ir.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Zc(t,n));let i=this.Ir.get(t);void 0===i&&(i=vc(),this.Ir.set(t,i)),this.Ir.set(t,i.add(n.key))}}class dh{constructor(){this.sessionToken=Uo.EMPTY_BYTE_STRING}getSessionToken(e){return yo.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,yo.resolve()}}class fh{constructor(){this.Tr=new Oo(ph.Er),this.dr=new Oo(ph.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new ph(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Vr(new ph(e,t))}mr(e,t){e.forEach((e=>this.removeReference(e,t)))}gr(e){const t=new lo(new ao([])),n=new ph(t,e),r=new ph(t,e+1),i=[];return this.dr.forEachInRange([n,r],(e=>{this.Vr(e),i.push(e.key)})),i}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new lo(new ao([])),n=new ph(t,e),r=new ph(t,e+1);let i=vc();return this.dr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new ph(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ph{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return lo.comparator(e.key,t.key)||eo(e.wr,t.wr)}static Ar(e,t){return eo(e.wr,t.wr)||lo.comparator(e.key,t.key)}}class mh{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Oo(ph.Er)}checkEmpty(e){return yo.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new Jc(i,t,n,r);this.mutationQueue.push(a);for(const s of r)this.br=this.br.add(new ph(s.key,i)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return yo.resolve(a)}lookupMutationBatch(e,t){return yo.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.vr(n),i=r<0?0:r;return yo.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return yo.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return yo.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ph(t,0),r=new ph(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,r],(e=>{const t=this.Dr(e.wr);i.push(t)})),yo.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Oo(eo);return t.forEach((e=>{const t=new ph(e,0),r=new ph(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,r],(e=>{n=n.add(e.wr)}))})),yo.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;lo.isDocumentKey(i)||(i=i.child(""));const a=new ph(new lo(i),0);let s=new Oo(eo);return this.br.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(s=s.add(e.wr)),!0)}),a),yo.resolve(this.Cr(s))}Cr(e){const t=[];return e.forEach((e=>{const n=this.Dr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Us(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return yo.forEach(t.mutations,(r=>{const i=new ph(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.br=n}))}On(e){}containsKey(e,t){const n=new ph(t,0),r=this.br.firstAfterOrEqual(n);return yo.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,yo.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class gh{constructor(e){this.Mr=e,this.docs=new Do(lo.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return yo.resolve(n?n.document.mutableCopy():ml.newInvalidDocument(t))}getEntries(e,t){let n=lc();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():ml.newInvalidDocument(e))})),yo.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=lc();const a=t.path,s=new lo(a.child("")),o=this.docs.getIteratorFrom(s);for(;o.hasNext();){const{key:e,value:{document:s}}=o.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||po(ho(s),n)<=0||(r.has(s.key)||nc(t,s))&&(i=i.insert(s.key,s.mutableCopy()))}return yo.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Fs()}Or(e,t){return yo.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new vh(this)}getSize(e){return yo.resolve(this.size)}}class vh extends oh{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(n)})),yo.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class yh{constructor(e){this.persistence=e,this.Nr=new sc((e=>Vl(e)),zl),this.lastRemoteSnapshotVersion=ro.min(),this.highestTargetId=0,this.Lr=0,this.Br=new fh,this.targetCount=0,this.kr=sh.Bn()}forEachTarget(e,t){return this.Nr.forEach(((e,n)=>t(n))),yo.resolve()}getLastRemoteSnapshotVersion(e){return yo.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return yo.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),yo.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),yo.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new sh(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,yo.resolve()}updateTargetData(e,t){return this.Kn(t),yo.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,yo.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Nr.forEach(((a,s)=>{s.sequenceNumber<=t&&null===n.get(s.targetId)&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,s.targetId)),r++)})),yo.waitFor(i).next((()=>r))}getTargetCount(e){return yo.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return yo.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),yo.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),yo.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),yo.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return yo.resolve(n)}containsKey(e,t){return yo.resolve(this.Br.containsKey(t))}}class bh{constructor(e,t){this.qr={},this.overlays={},this.Qr=new _o(0),this.Kr=!1,this.Kr=!0,this.$r=new dh,this.referenceDelegate=e(this),this.Ur=new yh(this),this.indexManager=new rh,this.remoteDocumentCache=function(e){return new gh(e)}((e=>this.referenceDelegate.Wr(e))),this.serializer=new eh(t),this.Gr=new uh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new hh,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new mh(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){Rs("MemoryPersistence","Starting transaction:",e);const r=new wh(this.Qr.next());return this.referenceDelegate.zr(),n(r).next((e=>this.referenceDelegate.jr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Hr(e,t){return yo.or(Object.values(this.qr).map((n=>()=>n.containsKey(e,t))))}}class wh extends go{constructor(e){super(),this.currentSequenceNumber=e}}class _h{constructor(e){this.persistence=e,this.Jr=new fh,this.Yr=null}static Zr(e){return new _h(e)}get Xr(){if(this.Yr)return this.Yr;throw Fs()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),yo.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),yo.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),yo.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((e=>this.Xr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Xr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return yo.forEach(this.Xr,(n=>{const r=lo.fromPath(n);return this.ei(e,r).next((e=>{e||t.removeEntry(r,ro.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return yo.or([()=>yo.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class xh{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=r}static Wi(e,t){let n=vc(),r=vc();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new xh(e,t.fromCache,n,r)}}class Sh{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class kh{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=ft()?8:bo(dt())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.Yi(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.Zi(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new Sh;return this.Xi(e,t,n).next((r=>{if(i.result=r,this.zi)return this.es(e,t,n,r.size)}))})).next((()=>i.result))}es(e,t,n,r){return n.documentReadCount<this.ji?(Ps()<=jt.DEBUG&&Rs("QueryEngine","SDK will not create cache indexes for query:",tc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),yo.resolve()):(Ps()<=jt.DEBUG&&Rs("QueryEngine","Query:",tc(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Hi*r?(Ps()<=jt.DEBUG&&Rs("QueryEngine","The SDK decides to create cache indexes for query:",tc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Yl(t))):yo.resolve())}Yi(e,t){if(Gl(t))return yo.resolve(null);let n=Yl(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=$l(t,null,"F"),n=Yl(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=vc(...r);return this.Ji.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const a=this.ts(t,r);return this.ns(t,a,i,n.readTime)?this.Yi(e,$l(t,null,"F")):this.rs(e,a,t,n)}))))})))))}Zi(e,t,n,r){return Gl(t)||r.isEqual(ro.min())?yo.resolve(null):this.Ji.getDocuments(e,n).next((i=>{const a=this.ts(t,i);return this.ns(t,a,n,r)?yo.resolve(null):(Ps()<=jt.DEBUG&&Rs("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),tc(t)),this.rs(e,a,t,uo(r,-1)).next((e=>e)))}))}ts(e,t){let n=new Oo(ic(e));return t.forEach(((t,r)=>{nc(e,r)&&(n=n.add(r))})),n}ns(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,t,n){return Ps()<=jt.DEBUG&&Rs("QueryEngine","Using full collection scan to execute query:",tc(t)),this.Ji.getDocumentsMatchingQuery(e,t,fo.min(),n)}rs(e,t,n,r){return this.Ji.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class Eh{constructor(e,t,n,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new Do(eo),this._s=new sc((e=>Vl(e)),zl),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ch(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function Ch(e,t,n,r){return new Eh(e,t,n,r)}async function Nh(e,t){const n=Vs(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.ls(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],a=[];let s=vc();for(const e of r){i.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}for(const e of t){a.push(e.batchId);for(const t of e.mutations)s=s.add(t.key)}return n.localDocuments.getDocuments(e,s).next((e=>({hs:e,removedBatchIds:i,addedBatchIds:a})))}))}))}function Th(e){const t=Vs(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ur.getLastRemoteSnapshotVersion(e)))}function Ih(e,t,n){let r=vc(),i=vc();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=lc();return n.forEach(((n,a)=>{const s=e.get(n);a.isFoundDocument()!==s.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(ro.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):Rs("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),{Ps:r,Is:i}}))}function Ah(e,t){const n=Vs(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function jh(e,t){const n=Vs(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Ur.getTargetData(e,t).next((i=>i?(r=i,yo.resolve(r)):n.Ur.allocateTargetId(e).next((i=>(r=new Zu(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.os.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e}))}async function Dh(e,t,n){const r=Vs(e),i=r.os.get(t),a=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",a,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!wo(e))throw e;Rs("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.os=r.os.remove(t),r._s.delete(i.target)}function Ph(e,t,n){const r=Vs(e);let i=ro.min(),a=vc();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=Vs(e),i=r._s.get(n);return void 0!==i?yo.resolve(r.os.get(i)):r.Ur.getTargetData(t,n)}(r,e,Yl(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(e,t.targetId).next((e=>{a=e}))})).next((()=>r.ss.getDocumentsMatchingQuery(e,t,n?i:ro.min(),n?a:vc()))).next((e=>(Rh(r,rc(t),e),{documents:e,Ts:a})))))}function Rh(e,t,n){let r=e.us.get(t)||ro.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.us.set(t,r)}class Oh{constructor(){this.activeTargetIds=bc()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Lh{constructor(){this.so=new Oh,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Oh,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Mh{_o(e){}shutdown(){}}class Fh{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Rs("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Rs("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Uh=null;function Vh(){return null===Uh?Uh=268435456+Math.round(2147483648*Math.random()):Uh++,"0x"+Uh.toString(16)}const zh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Bh{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const qh="WebChannelConnection";class Hh extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo="projects/".concat(n,"/databases/").concat(r),this.Co="(default)"===this.databaseId.database?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}get Fo(){return!1}Mo(e,t,n,r,i){const a=Vh(),s=this.xo(e,t.toUriEncodedString());Rs("RestConnection","Sending RPC '".concat(e,"' ").concat(a,":"),s,n);const o={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(o,r,i),this.No(e,s,o,n).then((t=>(Rs("RestConnection","Received RPC '".concat(e,"' ").concat(a,": "),t),t)),(t=>{throw Ls("RestConnection","RPC '".concat(e,"' ").concat(a," failed with error: "),t,"url: ",s,"request:",n),t}))}Lo(e,t,n,r,i,a){return this.Mo(e,t,n,r,i)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+js,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}xo(e,t){const n=zh[e];return"".concat(this.Do,"/v1/").concat(t,":").concat(n)}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,r){const i=Vh();return new Promise(((a,s)=>{const o=new bs;o.setWithCredentials(!0),o.listenOnce(_s.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case xs.NO_ERROR:const t=o.getResponseJson();Rs(qh,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),a(t);break;case xs.TIMEOUT:Rs(qh,"RPC '".concat(e,"' ").concat(i," timed out")),s(new Bs(zs.DEADLINE_EXCEEDED,"Request time out"));break;case xs.HTTP_ERROR:const n=o.getStatus();if(Rs(qh,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(zs).indexOf(t)>=0?t:zs.UNKNOWN}(t.status);s(new Bs(e,t.message))}else s(new Bs(zs.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Bs(zs.UNAVAILABLE,"Connection failed."));break;default:Fs()}}finally{Rs(qh,"RPC '".concat(e,"' ").concat(i," completed."))}}));const l=JSON.stringify(r);Rs(qh,"RPC '".concat(e,"' ").concat(i," sending request:"),r),o.send(t,"POST",l,n,15)}))}Bo(e,t,n){const r=Vh(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Cs(),s=Es(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Oo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=i.join("");Rs(qh,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),o);const u=a.createWebChannel(c,o);let h=!1,d=!1;const f=new Bh({Io:t=>{d?Rs(qh,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(Rs(qh,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),h=!0),Rs(qh,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},To:()=>u.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(u,ws.EventType.OPEN,(()=>{d||(Rs(qh,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),f.yo())})),p(u,ws.EventType.CLOSE,(()=>{d||(d=!0,Rs(qh,"RPC '".concat(e,"' stream ").concat(r," transport closed")),f.So())})),p(u,ws.EventType.ERROR,(t=>{d||(d=!0,Ls(qh,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),f.So(new Bs(zs.UNAVAILABLE,"The operation could not be completed")))})),p(u,ws.EventType.MESSAGE,(t=>{var n;if(!d){const i=t.data[0];Us(!!i);const a=i,s=a.error||(null===(n=a[0])||void 0===n?void 0:n.error);if(s){Rs(qh,"RPC '".concat(e,"' stream ").concat(r," received error:"),s);const t=s.status;let n=function(e){const t=tu[e];if(void 0!==t)return iu(t)}(t),i=s.message;void 0===n&&(n=zs.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),d=!0,f.So(new Bs(n,i)),u.close()}else Rs(qh,"RPC '".concat(e,"' stream ").concat(r," received:"),i),f.bo(i)}})),p(s,ks.STAT_EVENT,(t=>{t.stat===Ss.PROXY?Rs(qh,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===Ss.NOPROXY&&Rs(qh,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((()=>{f.wo()}),0),f}}function Wh(){return"undefined"!=typeof document?document:null}function Gh(e){return new ku(e,!0)}class Kh{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-n);r>0&&Rs("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.Ko," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class Qh{constructor(e,t,n,r,i,a,s,o){this.ui=e,this.Ho=n,this.Jo=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=s,this.listener=o,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Kh(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===zs.RESOURCE_EXHAUSTED?(Os(t.toString()),Os("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===zs.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.Yo===t&&this.P_(n,r)}),(t=>{e((()=>{const e=new Bs(zs.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)}))}))}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{n((()=>this.listener.Eo()))})),this.stream.Ro((()=>{n((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((e=>{n((()=>this.I_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.e_?this.E_(e):this.onNext(e)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return Rs("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(Rs("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Yh extends Qh{constructor(e,t,n,r,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,a),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Fs()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(Us(void 0===t||"string"==typeof t),Uo.fromBase64String(t||"")):(Us(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Uo.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),s=t.targetChange.cause,o=s&&function(e){const t=void 0===e.code?zs.UNKNOWN:iu(e.code);return new Bs(t,e.message||"")}(s);n=new gu(r,i,a,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ru(e,r.document.name),a=Iu(r.document.updateTime),s=r.document.createTime?Iu(r.document.createTime):ro.min(),o=new fl({mapValue:{fields:r.document.fields}}),l=ml.newFoundDocument(i,a,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new pu(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Ru(e,r.document),a=r.readTime?Iu(r.readTime):ro.min(),s=ml.newNoDocument(i,a),o=r.removedTargetIds||[];n=new pu([],o,s.key,s)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Ru(e,r.document),a=r.removedTargetIds||[];n=new pu([],a,i,null)}else{if(!("filter"in t))return Fs();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,a=new eu(r,i),s=e.targetId;n=new mu(s,a)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return ro.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?ro.min():t.readTime?Iu(t.readTime):ro.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Mu(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Bl(r)?{documents:zu(e,r)}:{query:Bu(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Nu(e,t.resumeToken);const r=Eu(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(ro.min())>0){n.readTime=Cu(e,t.snapshotVersion.toTimestamp());const r=Eu(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Fs()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Mu(this.serializer),t.removeTarget=e,this.a_(t)}}class Xh extends Qh{constructor(e,t,n,r,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Us(!!e.streamToken),this.lastStreamToken=e.streamToken,Us(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){Us(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(Us(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Iu(e.updateTime):Iu(t);return n.isEqual(ro.min())&&(n=Iu(t)),new Oc(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Iu(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Mu(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Vu(this.serializer,e)))};this.a_(t)}}class Jh extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new Bs(zs.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[a,s]=i;return this.connection.Mo(e,ju(t,n),r,a,s)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===zs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Bs(zs.UNKNOWN,e.toString())}))}Lo(e,t,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((a=>{let[s,o]=a;return this.connection.Lo(e,ju(t,n),r,s,o,i)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===zs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Bs(zs.UNKNOWN,e.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class $h{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.D_?(Os(t),this.D_=!1):Rs("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class Zh{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o((e=>{n.enqueueAndForget((async()=>{ld(this)&&(Rs("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Vs(e);t.L_.add(4),await td(t),t.q_.set("Unknown"),t.L_.delete(4),await ed(t)}(this))}))})),this.q_=new $h(n,r)}}async function ed(e){if(ld(e))for(const t of e.B_)await t(!0)}async function td(e){for(const t of e.B_)await t(!1)}function nd(e,t){const n=Vs(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),od(n)?sd(n):Nd(n).r_()&&id(n,t))}function rd(e,t){const n=Vs(e),r=Nd(n);n.N_.delete(t),r.r_()&&ad(n,t),0===n.N_.size&&(r.r_()?r.o_():ld(n)&&n.q_.set("Unknown"))}function id(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ro.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Nd(e).A_(t)}function ad(e,t){e.Q_.xe(t),Nd(e).R_(t)}function sd(e){e.Q_=new yu({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),Nd(e).start(),e.q_.v_()}function od(e){return ld(e)&&!Nd(e).n_()&&e.N_.size>0}function ld(e){return 0===Vs(e).L_.size}function cd(e){e.Q_=void 0}async function ud(e){e.q_.set("Online")}async function hd(e){e.N_.forEach(((t,n)=>{id(e,t)}))}async function dd(e,t){cd(e),od(e)?(e.q_.M_(t),sd(e)):e.q_.set("Unknown")}async function fd(e,t,n){if(e.q_.set("Online"),t instanceof gu&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.N_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.N_.delete(r),e.Q_.removeTarget(r))}(e,t)}catch(n){Rs("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await pd(e,n)}else if(t instanceof pu?e.Q_.Ke(t):t instanceof mu?e.Q_.He(t):e.Q_.We(t),!n.isEqual(ro.min()))try{const t=await Th(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.N_.get(r);i&&e.N_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.N_.get(t);if(!r)return;e.N_.set(t,r.withResumeToken(Uo.EMPTY_BYTE_STRING,r.snapshotVersion)),ad(e,t);const i=new Zu(r.target,t,n,r.sequenceNumber);id(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Rs("RemoteStore","Failed to raise snapshot:",t),await pd(e,t)}}async function pd(e,t,n){if(!wo(t))throw t;e.L_.add(1),await td(e),e.q_.set("Offline"),n||(n=()=>Th(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Rs("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await ed(e)}))}function md(e,t){return t().catch((n=>pd(e,n,t)))}async function gd(e){const t=Vs(e),n=Td(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;vd(t);)try{const e=await Ah(t.localStore,r);if(null===e){0===t.O_.length&&n.o_();break}r=e.batchId,yd(t,e)}catch(e){await pd(t,e)}bd(t)&&wd(t)}function vd(e){return ld(e)&&e.O_.length<10}function yd(e,t){e.O_.push(t);const n=Td(e);n.r_()&&n.V_&&n.m_(t.mutations)}function bd(e){return ld(e)&&!Td(e).n_()&&e.O_.length>0}function wd(e){Td(e).start()}async function _d(e){Td(e).p_()}async function xd(e){const t=Td(e);for(const n of e.O_)t.m_(n.mutations)}async function Sd(e,t,n){const r=e.O_.shift(),i=$c.from(r,t,n);await md(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await gd(e)}async function kd(e,t){t&&Td(e).V_&&await async function(e,t){if(function(e){return ru(e)&&e!==zs.ABORTED}(t.code)){const n=e.O_.shift();Td(e).s_(),await md(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await gd(e)}}(e,t),bd(e)&&wd(e)}async function Ed(e,t){const n=Vs(e);n.asyncQueue.verifyOperationInProgress(),Rs("RemoteStore","RemoteStore received new credentials");const r=ld(n);n.L_.add(3),await td(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await ed(n)}async function Cd(e,t){const n=Vs(e);t?(n.L_.delete(2),await ed(n)):t||(n.L_.add(2),await td(n),n.q_.set("Unknown"))}function Nd(e){return e.K_||(e.K_=function(e,t,n){const r=Vs(e);return r.w_(),new Yh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:ud.bind(null,e),Ro:hd.bind(null,e),mo:dd.bind(null,e),d_:fd.bind(null,e)}),e.B_.push((async t=>{t?(e.K_.s_(),od(e)?sd(e):e.q_.set("Unknown")):(await e.K_.stop(),cd(e))}))),e.K_}function Td(e){return e.U_||(e.U_=function(e,t,n){const r=Vs(e);return r.w_(),new Xh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:_d.bind(null,e),mo:kd.bind(null,e),f_:xd.bind(null,e),g_:Sd.bind(null,e)}),e.B_.push((async t=>{t?(e.U_.s_(),await gd(e)):(await e.U_.stop(),e.O_.length>0&&(Rs("RemoteStore","Stopping write stream with ".concat(e.O_.length," pending writes")),e.O_=[]))}))),e.U_}class Id{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new qs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const a=Date.now()+n,s=new Id(e,t,a,r,i);return s.start(n),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Bs(zs.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ad(e,t){if(Os("AsyncQueue","".concat(t,": ").concat(e)),wo(e))return new Bs(zs.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class jd{constructor(e){this.comparator=e?(t,n)=>e(t,n)||lo.comparator(t.key,n.key):(e,t)=>lo.comparator(e.key,t.key),this.keyedMap=uc(),this.sortedSet=new Do(this.comparator)}static emptySet(e){return new jd(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof jd))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new jd;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Dd{constructor(){this.W_=new Do(lo.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Fs():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Pd{constructor(e,t,n,r,i,a,s,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=s,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const a=[];return t.forEach((e=>{a.push({type:0,doc:e})})),new Pd(e,t,jd.emptySet(t),a,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Zl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Rd{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class Od{constructor(){this.queries=Ld(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=Vs(e),r=n.queries;n.queries=Ld(),r.forEach(((e,n)=>{for(const r of n.j_)r.onError(t)}))}(this,new Bs(zs.ABORTED,"Firestore shutting down"))}}function Ld(){return new sc((e=>ec(e)),Zl)}async function Md(e,t){const n=Vs(e);let r=3;const i=t.query;let a=n.queries.get(i);a?!a.H_()&&t.J_()&&(r=2):(a=new Rd,r=t.J_()?0:1);try{switch(r){case 0:a.z_=await n.onListen(i,!0);break;case 1:a.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Ad(e,"Initialization of query '".concat(tc(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,a),a.j_.push(t),t.Z_(n.onlineState),a.z_&&t.X_(a.z_)&&zd(n)}async function Fd(e,t){const n=Vs(e),r=t.query;let i=3;const a=n.queries.get(r);if(a){const e=a.j_.indexOf(t);e>=0&&(a.j_.splice(e,1),0===a.j_.length?i=t.J_()?0:1:!a.H_()&&t.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Ud(e,t){const n=Vs(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(i)&&(r=!0);t.z_=i}}r&&zd(n)}function Vd(e,t,n){const r=Vs(e),i=r.queries.get(t);if(i)for(const a of i.j_)a.onError(n);r.queries.delete(t)}function zd(e){e.Y_.forEach((e=>{e.next()}))}var Bd,qd;(qd=Bd||(Bd={})).ea="default",qd.Cache="cache";class Hd{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Pd(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=Pd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Bd.Cache}}class Wd{constructor(e){this.key=e}}class Gd{constructor(e){this.key=e}}class Kd{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=vc(),this.mutatedKeys=vc(),this.Aa=ic(e),this.Ra=new jd(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new Dd,r=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,a=r,s=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const c=r.get(e),u=nc(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.ga(c,u)||(n.track({type:2,doc:u}),f=!0,(o&&this.Aa(u,o)>0||l&&this.Aa(u,l)<0)&&(s=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(o||l)&&(s=!0)),f&&(u?(a=a.add(u),i=d?i.add(e):i.delete(e)):(a=a.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;a.size>this.query.limit;){const e="F"===this.query.limitType?a.last():a.first();a=a.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ra:a,fa:n,ns:s,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Fs()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc))),this.pa(n),r=null!=r&&r;const s=t&&!r?this.ya():[],o=0===this.da.size&&this.current&&!r?1:0,l=o!==this.Ea;return this.Ea=o,0!==a.length||l?{snapshot:new Pd(this.query,e.Ra,i,a,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:s}:{wa:s}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Dd,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((e=>this.Ta=this.Ta.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ta=this.Ta.delete(e))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=vc(),this.Ra.forEach((e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))}));const t=[];return e.forEach((e=>{this.da.has(e)||t.push(new Gd(e))})),this.da.forEach((n=>{e.has(n)||t.push(new Wd(n))})),t}ba(e){this.Ta=e.Ts,this.da=vc();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Pd.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class Qd{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Yd{constructor(e){this.key=e,this.va=!1}}class Xd{constructor(e,t,n,r,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new sc((e=>ec(e)),Zl),this.Ma=new Map,this.xa=new Set,this.Oa=new Do(lo.comparator),this.Na=new Map,this.La=new fh,this.Ba={},this.ka=new Map,this.qa=sh.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function Jd(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=bf(e);let i;const a=r.Fa.get(t);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.Da()):i=await Zd(r,t,n,!0),i}async function $d(e,t){const n=bf(e);await Zd(n,t,!0,!1)}async function Zd(e,t,n,r){const i=await jh(e.localStore,Yl(t)),a=i.targetId,s=e.sharedClientState.addLocalQueryTarget(a,n);let o;return r&&(o=await ef(e,t,a,"current"===s,i.resumeToken)),e.isPrimaryClient&&n&&nd(e.remoteStore,i),o}async function ef(e,t,n,r,i){e.Ka=(t,n,r)=>async function(e,t,n,r){let i=t.view.ma(n);i.ns&&(i=await Ph(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.ma(n,i)})));const a=r&&r.targetChanges.get(t.targetId),s=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,a,s);return ff(e,t.targetId,o.wa),o.snapshot}(e,t,n,r);const a=await Ph(e.localStore,t,!0),s=new Kd(t,a.Ts),o=s.ma(a.documents),l=fu.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=s.applyChanges(o,e.isPrimaryClient,l);ff(e,n,c.wa);const u=new Qd(t,n,s);return e.Fa.set(t,u),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),c.snapshot}async function tf(e,t,n){const r=Vs(e),i=r.Fa.get(t),a=r.Ma.get(i.targetId);if(a.length>1)return r.Ma.set(i.targetId,a.filter((e=>!Zl(e,t)))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Dh(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&rd(r.remoteStore,i.targetId),hf(r,i.targetId)})).catch(vo)):(hf(r,i.targetId),await Dh(r.localStore,i.targetId,!0))}async function nf(e,t){const n=Vs(e),r=n.Fa.get(t),i=n.Ma.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),rd(n.remoteStore,r.targetId))}async function rf(e,t){const n=Vs(e);try{const e=await function(e,t){const n=Vs(e),r=t.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const a=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const s=[];t.targetChanges.forEach(((a,o)=>{const l=i.get(o);if(!l)return;s.push(n.Ur.removeMatchingKeys(e,a.removedDocuments,o).next((()=>n.Ur.addMatchingKeys(e,a.addedDocuments,o))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(Uo.EMPTY_BYTE_STRING,ro.min()).withLastLimboFreeSnapshotVersion(ro.min()):a.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(a.resumeToken,r)),i=i.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,a)&&s.push(n.Ur.updateTargetData(e,c))}));let o=lc(),l=vc();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),s.push(Ih(e,a,t.documentUpdates).next((e=>{o=e.Ps,l=e.Is}))),!r.isEqual(ro.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next((t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,r)));s.push(t)}return yo.waitFor(s).next((()=>a.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,o,l))).next((()=>o))})).then((e=>(n.os=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Na.get(t);r&&(Us(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.va=!0:e.modifiedDocuments.size>0?Us(r.va):e.removedDocuments.size>0&&(Us(r.va),r.va=!1))})),await gf(n,e,t)}catch(e){await vo(e)}}function af(e,t,n){const r=Vs(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Fa.forEach(((n,r)=>{const i=r.view.Z_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=Vs(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const i of n.j_)i.Z_(t)&&(r=!0)})),r&&zd(n)}(r.eventManager,t),e.length&&r.Ca.d_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function sf(e,t,n){const r=Vs(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Na.get(t),a=i&&i.key;if(a){let e=new Do(lo.comparator);e=e.insert(a,ml.newNoDocument(a,ro.min()));const n=vc().add(a),i=new du(ro.min(),new Map,new Do(eo),e,n);await rf(r,i),r.Oa=r.Oa.remove(a),r.Na.delete(t),mf(r)}else await Dh(r.localStore,t,!1).then((()=>hf(r,t,n))).catch(vo)}async function of(e,t){const n=Vs(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Vs(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,a=i.keys();let s=yo.resolve();return a.forEach((e=>{s=s.next((()=>r.getEntry(t,e))).next((t=>{const a=n.docVersions.get(e);Us(null!==a),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),s.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=vc();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);uf(n,r,null),cf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await gf(n,e)}catch(e){await vo(e)}}async function lf(e,t,n){const r=Vs(e);try{const e=await function(e,t){const n=Vs(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Us(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);uf(r,t,n),cf(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await gf(r,e)}catch(n){await vo(n)}}function cf(e,t){(e.ka.get(t)||[]).forEach((e=>{e.resolve()})),e.ka.delete(t)}function uf(e,t,n){const r=Vs(e);let i=r.Ba[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ba[r.currentUser.toKey()]=i}}function hf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Ma.get(t))e.Fa.delete(r),n&&e.Ca.$a(r,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach((t=>{e.La.containsKey(t)||df(e,t)}))}function df(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(rd(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),mf(e))}function ff(e,t,n){for(const r of n)r instanceof Wd?(e.La.addReference(r.key,t),pf(e,r)):r instanceof Gd?(Rs("SyncEngine","Document no longer in limbo: "+r.key),e.La.removeReference(r.key,t),e.La.containsKey(r.key)||df(e,r.key)):Fs()}function pf(e,t){const n=t.key,r=n.path.canonicalString();e.Oa.get(n)||e.xa.has(r)||(Rs("SyncEngine","New document in limbo: "+n),e.xa.add(r),mf(e))}function mf(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new lo(ao.fromString(t)),r=e.qa.next();e.Na.set(r,new Yd(n)),e.Oa=e.Oa.insert(n,r),nd(e.remoteStore,new Zu(Yl(Wl(n.path)),r,"TargetPurposeLimboResolution",_o.oe))}}async function gf(e,t,n){const r=Vs(e),i=[],a=[],s=[];r.Fa.isEmpty()||(r.Fa.forEach(((e,o)=>{s.push(r.Ka(o,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,i?"current":"not-current")}if(e){i.push(e);const t=xh.Wi(o.targetId,e);a.push(t)}})))})),await Promise.all(s),r.Ca.d_(i),await async function(e,t){const n=Vs(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>yo.forEach(t,(t=>yo.forEach(t.$i,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>yo.forEach(t.Ui,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!wo(e))throw e;Rs("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.os.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.os=n.os.insert(e,i)}}}(r.localStore,a))}async function vf(e,t){const n=Vs(e);if(!n.currentUser.isEqual(t)){Rs("SyncEngine","User change. New user:",t.toKey());const e=await Nh(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach((e=>{e.forEach((e=>{e.reject(new Bs(zs.CANCELLED,t))}))})),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await gf(n,e.hs)}}function yf(e,t){const n=Vs(e),r=n.Na.get(t);if(r&&r.va)return vc().add(r.key);{let e=vc();const r=n.Ma.get(t);if(!r)return e;for(const t of r){const r=n.Fa.get(t);e=e.unionWith(r.view.Va)}return e}}function bf(e){const t=Vs(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=rf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=yf.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=sf.bind(null,t),t.Ca.d_=Ud.bind(null,t.eventManager),t.Ca.$a=Vd.bind(null,t.eventManager),t}function wf(e){const t=Vs(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=of.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=lf.bind(null,t),t}class _f{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Gh(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return Ch(this.persistence,new kh,e.initialUser,this.serializer)}Ga(e){return new bh(_h.Zr,this.serializer)}Wa(e){return new Lh}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}_f.provider={build:()=>new _f};class xf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>af(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=vf.bind(null,this.syncEngine),await Cd(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Od}createDatastore(e){const t=Gh(e.databaseInfo.databaseId),n=function(e){return new Hh(e)}(e.databaseInfo);return function(e,t,n,r){return new Jh(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Zh(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>af(this.syncEngine,e,0)),Fh.D()?new Fh:new Mh)}createSyncEngine(e,t){return function(e,t,n,r,i,a,s){const o=new Xd(e,t,n,r,i,a);return s&&(o.Qa=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=Vs(e);Rs("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await td(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}xf.provider={build:()=>new xf};class Sf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Os("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class kf{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=As.UNAUTHENTICATED,this.clientId=Zs.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{Rs("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(Rs("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new qs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Ad(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Ef(e,t){e.asyncQueue.verifyOperationInProgress(),Rs("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await Nh(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Cf(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Nf(e);Rs("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>Ed(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Ed(t.remoteStore,n))),e._onlineComponents=t}async function Nf(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Rs("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ef(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===zs.FAILED_PRECONDITION||e.code===zs.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;Ls("Error using user provided cache. Falling back to memory cache: "+n),await Ef(e,new _f)}}else Rs("FirestoreClient","Using default OfflineComponentProvider"),await Ef(e,new _f);return e._offlineComponents}async function Tf(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Rs("FirestoreClient","Using user provided OnlineComponentProvider"),await Cf(e,e._uninitializedComponentsProvider._online)):(Rs("FirestoreClient","Using default OnlineComponentProvider"),await Cf(e,new xf))),e._onlineComponents}function If(e){return Tf(e).then((e=>e.syncEngine))}async function Af(e){const t=await Tf(e),n=t.eventManager;return n.onListen=Jd.bind(null,t.syncEngine),n.onUnlisten=tf.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=$d.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=nf.bind(null,t.syncEngine),n}function jf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new qs;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const a=new Sf({next:o=>{a.Za(),t.enqueueAndForget((()=>Fd(e,s)));const l=o.docs.has(n);!l&&o.fromCache?i.reject(new Bs(zs.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&"server"===r.source?i.reject(new Bs(zs.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:e=>i.reject(e)}),s=new Hd(Wl(n.path),a,{includeMetadataChanges:!0,_a:!0});return Md(e,s)}(await Af(e),e.asyncQueue,t,n,r))),r.promise}function Df(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new qs;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const a=new Sf({next:n=>{a.Za(),t.enqueueAndForget((()=>Fd(e,s))),n.fromCache&&"server"===r.source?i.reject(new Bs(zs.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),s=new Hd(n,a,{includeMetadataChanges:!0,_a:!0});return Md(e,s)}(await Af(e),e.asyncQueue,t,n,r))),r.promise}function Pf(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Rf=new Map;function Of(e,t,n){if(!n)throw new Bs(zs.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Lf(e){if(!lo.isDocumentKey(e))throw new Bs(zs.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Mf(e){if(lo.isDocumentKey(e))throw new Bs(zs.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Ff(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":Fs()}function Uf(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Bs(zs.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ff(e);throw new Bs(zs.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function Vf(e,t){if(t<=0)throw new Bs(zs.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}class zf{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Bs(zs.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Bs(zs.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Bs(zs.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Pf(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Bs(zs.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new Bs(zs.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new Bs(zs.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Bf{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zf({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Bs(zs.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Bs(zs.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zf(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Ws;switch(e.type){case"firstParty":return new Ys(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Bs(zs.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Rf.get(e);t&&(Rs("ComponentProvider","Removing Datastore"),Rf.delete(e),t.terminate())}(this),Promise.resolve()}}function qf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const a=(e=Uf(e,Bf))._getSettings(),s="".concat(t,":").concat(n);if("firestore.googleapis.com"!==a.host&&a.host!==s&&Ls("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},a),{host:s,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=As.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[it(JSON.stringify({alg:"none",type:"JWT"})),it(JSON.stringify(a)),""].join(".")}(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const a=r.mockUserToken.sub||r.mockUserToken.user_id;if(!a)throw new Bs(zs.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new As(a)}e._authCredentials=new Gs(new Hs(t,n))}}class Hf{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Hf(this.firestore,e,this._query)}}class Wf{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Gf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Wf(this.firestore,e,this._key)}}class Gf extends Hf{constructor(e,t,n){super(e,t,Wl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Wf(this.firestore,null,new lo(e))}withConverter(e){return new Gf(this.firestore,e,this._path)}}function Kf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Et(e),Of("collection","path",t),e instanceof Bf){const n=ao.fromString(t,...r);return Mf(n),new Gf(e,null,n)}{if(!(e instanceof Wf||e instanceof Gf))throw new Bs(zs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ao.fromString(t,...r));return Mf(n),new Gf(e.firestore,null,n)}}function Qf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Et(e),1===arguments.length&&(t=Zs.newId()),Of("doc","path",t),e instanceof Bf){const n=ao.fromString(t,...r);return Lf(n),new Wf(e,null,new lo(n))}{if(!(e instanceof Wf||e instanceof Gf))throw new Bs(zs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(ao.fromString(t,...r));return Lf(n),new Wf(e.firestore,e instanceof Gf?e.converter:null,new lo(n))}}class Yf{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Kh(this,"async_queue_retry"),this.Vu=()=>{const e=Wh();e&&Rs("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=Wh();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Wh();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new qs;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(Kw){if(!wo(Kw))throw Kw;Rs("AsyncQueue","Operation failed with retryable error: "+Kw)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Os("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.du=!1,e))))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=Id.createAndSchedule(this,e,t,n,(e=>this.yu(e)));return this.Tu.push(r),r}fu(){this.Eu&&Fs()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class Xf extends Bf{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Yf,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Yf(e),this._firestoreClient=void 0,await e}}}function Jf(e){if(e._terminated)throw new Bs(zs.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||$f(e),e._firestoreClient}function $f(e){var t,n,r;const i=e._freezeSettings(),a=function(e,t,n,r){return new Ko(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Pf(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new kf(e._authCredentials,e._appCheckCredentials,e._queue,a,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}class Zf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Zf(Uo.fromBase64String(e))}catch(e){throw new Bs(zs.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Zf(Uo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class ep{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Bs(zs.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new oo(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class tp{constructor(e){this._methodName=e}}class np{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Bs(zs.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Bs(zs.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return eo(this._lat,e._lat)||eo(this._long,e._long)}}class rp{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const ip=/^__.*__$/;class ap{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Wc(e,this.data,this.fieldMask,t,this.fieldTransforms):new Hc(e,this.data,t,this.fieldTransforms)}}class sp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Wc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function op(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Fs()}}class lp{constructor(e,t,n,r,i,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new lp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.Ou(e),r}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Sp(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(op(this.Cu)&&ip.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class cp{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Gh(e)}Qu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new lp({Cu:e,methodName:t,qu:n,path:oo.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function up(e){const t=e._freezeSettings(),n=Gh(e._databaseId);return new cp(e._databaseId,!!t.ignoreUndefinedProperties,n)}function hp(e,t,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const s=e.Qu(a.merge||a.mergeFields?2:0,t,n,i);bp("Data must be an object, but it was:",s,r);const o=vp(r,s);let l,c;if(a.merge)l=new Mo(s.fieldMask),c=s.fieldTransforms;else if(a.mergeFields){const e=[];for(const r of a.mergeFields){const i=wp(t,r,n);if(!s.contains(i))throw new Bs(zs.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));kp(e,i)||e.push(i)}l=new Mo(e),c=s.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=s.fieldTransforms;return new ap(new fl(o),l,c)}class dp extends tp{_toFieldTransform(e){if(2!==e.Cu)throw 1===e.Cu?e.Bu("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Bu("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof dp}}function fp(e,t,n,r){const i=e.Qu(1,t,n);bp("Data must be an object, but it was:",i,r);const a=[],s=fl.empty();Ao(r,((e,r)=>{const o=xp(t,e,n);r=Et(r);const l=i.Nu(o);if(r instanceof dp)a.push(o);else{const e=gp(r,l);null!=e&&(a.push(o),s.set(o,e))}}));const o=new Mo(a);return new sp(s,o,i.fieldTransforms)}function pp(e,t,n,r,i,a){const s=e.Qu(1,t,n),o=[wp(t,r,n)],l=[i];if(a.length%2!=0)throw new Bs(zs.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let d=0;d<a.length;d+=2)o.push(wp(t,a[d])),l.push(a[d+1]);const c=[],u=fl.empty();for(let d=o.length-1;d>=0;--d)if(!kp(c,o[d])){const e=o[d];let t=l[d];t=Et(t);const n=s.Nu(e);if(t instanceof dp)c.push(e);else{const r=gp(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new Mo(c);return new sp(u,h,s.fieldTransforms)}function mp(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return gp(n,e.Qu(r?4:3,t))}function gp(e,t){if(yp(e=Et(e)))return bp("Unsupported field value:",t,e),vp(e,t);if(e instanceof tp)return function(e,t){if(!op(t.Cu))throw t.Bu("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Bu("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=gp(i,t.Lu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Et(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return xc(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=no.fromDate(e);return{timestampValue:Cu(t.serializer,n)}}if(e instanceof no){const n=new no(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Cu(t.serializer,n)}}if(e instanceof np)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Zf)return{bytesValue:Nu(t.serializer,e._byteString)};if(e instanceof Wf){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Bu("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Au(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof rp)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return wc(t.serializer,e)}))}}}}}}(e,t);throw t.Bu("Unsupported field value: ".concat(Ff(e)))}(e,t)}function vp(e,t){const n={};return jo(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ao(e,((e,r)=>{const i=gp(r,t.Mu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function yp(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof no||e instanceof np||e instanceof Zf||e instanceof Wf||e instanceof tp||e instanceof rp)}function bp(e,t,n){if(!yp(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Ff(n);throw"an object"===r?t.Bu(e+" a custom object"):t.Bu(e+" "+r)}}function wp(e,t,n){if((t=Et(t))instanceof ep)return t._internalPath;if("string"==typeof t)return xp(e,t);throw Sp("Field path arguments must be of type string or ",e,!1,void 0,n)}const _p=new RegExp("[~\\*/\\[\\]]");function xp(e,t,n){if(t.search(_p)>=0)throw Sp("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new ep(...t.split("."))._internalPath}catch(r){throw Sp("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function Sp(e,t,n,r,i){const a=r&&!r.isEmpty(),s=void 0!==i;let o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(a||s)&&(l+=" (found",a&&(l+=" in field ".concat(r)),s&&(l+=" in document ".concat(i)),l+=")"),new Bs(zs.INVALID_ARGUMENT,o+e+l)}function kp(e,t){return e.some((e=>e.isEqual(t)))}class Ep{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Wf(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Cp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Np("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Cp extends Ep{data(){return super.data()}}function Np(e,t){return"string"==typeof t?xp(e,t):t instanceof ep?t._internalPath:t._delegate._internalPath}function Tp(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Bs(zs.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ip{}class Ap extends Ip{}function jp(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];t instanceof Ip&&n.push(t),n=n.concat(i),function(e){const t=e.filter((e=>e instanceof Rp)).length,n=e.filter((e=>e instanceof Dp)).length;if(t>1||t>0&&n>0)throw new Bs(zs.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)e=s._apply(e);return e}class Dp extends Ap{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Dp(e,t,n)}_apply(e){const t=this._parse(e);return zp(e._query,t),new Hf(e.firestore,e.converter,Jl(e._query,t))}_parse(e){const t=up(e.firestore),n=function(e,t,n,r,i,a,s){let o;if(i.isKeyField()){if("array-contains"===a||"array-contains-any"===a)throw new Bs(zs.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(a,"' queries on documentId()."));if("in"===a||"not-in"===a){Vp(s,a);const t=[];for(const n of s)t.push(Up(r,e,n));o={arrayValue:{values:t}}}else o=Up(r,e,s)}else"in"!==a&&"not-in"!==a&&"array-contains-any"!==a||Vp(s,a),o=mp(n,t,s,"in"===a||"not-in"===a);return xl.create(i,a,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Pp(e,t,n){const r=t,i=Np("where",e);return Dp._create(i,r,n)}class Rp extends Ip{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Rp(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:Sl.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)zp(n,i),n=Jl(n,i)}(e._query,t),new Hf(e.firestore,e.converter,Jl(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Op extends Ap{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Op(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Bs(zs.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Bs(zs.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new bl(t,n)}(e._query,this._field,this._direction);return new Hf(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new ql(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Lp(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Np("orderBy",e);return Op._create(n,t)}class Mp extends Ap{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Mp(e,t,n)}_apply(e){return new Hf(e.firestore,e.converter,$l(e._query,this._limit,this._limitType))}}function Fp(e){return Vf("limit",e),Mp._create("limit",e,"F")}function Up(e,t,n){if("string"==typeof(n=Et(n))){if(""===n)throw new Bs(zs.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Kl(t)&&-1!==n.indexOf("/"))throw new Bs(zs.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(ao.fromString(n));if(!lo.isDocumentKey(r))throw new Bs(zs.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return il(e,new lo(r))}if(n instanceof Wf)return il(e,n._key);throw new Bs(zs.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Ff(n),"."))}function Vp(e,t){if(!Array.isArray(e)||0===e.length)throw new Bs(zs.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function zp(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Bs(zs.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Bs(zs.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class Bp{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Xo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Bo(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(qo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Fs()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Ao(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>Bo(e.doubleValue)));return new rp(i)}convertGeoPoint(e){return new np(Bo(e.latitude),Bo(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Wo(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Go(e));default:return null}}convertTimestamp(e){const t=zo(e);return new no(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=ao.fromString(e);Us($u(n));const r=new Qo(n.get(1),n.get(3)),i=new lo(n.popFirst(5));return r.isEqual(t)||Os("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function qp(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Hp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Wp extends Ep{constructor(e,t,n,r,i,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Gp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Np("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Gp extends Wp{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Kp{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Hp(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Gp(this._firestore,this._userDataWriter,n.key,n,new Hp(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Bs(zs.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Gp(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Hp(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Gp(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Hp(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,a=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),a=n.indexOf(t.doc.key)),{type:Qp(t.type),doc:r,oldIndex:i,newIndex:a}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Qp(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Fs()}}function Yp(e){e=Uf(e,Wf);const t=Uf(e.firestore,Xf);return jf(Jf(t),e._key).then((n=>nm(t,e,n)))}class Xp extends Bp{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Wf(this.firestore,null,t)}}function Jp(e){e=Uf(e,Hf);const t=Uf(e.firestore,Xf),n=Jf(t),r=new Xp(t);return Tp(e._query),Df(n,e._query).then((n=>new Kp(t,r,e,n)))}function $p(e,t,n){e=Uf(e,Wf);const r=Uf(e.firestore,Xf),i=qp(e.converter,t,n);return tm(r,[hp(up(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Lc.none())])}function Zp(e,t,n){e=Uf(e,Wf);const r=Uf(e.firestore,Xf),i=up(r);let a;for(var s=arguments.length,o=new Array(s>3?s-3:0),l=3;l<s;l++)o[l-3]=arguments[l];return a="string"==typeof(t=Et(t))||t instanceof ep?pp(i,"updateDoc",e._key,t,n,o):fp(i,"updateDoc",e._key,t),tm(r,[a.toMutation(e._key,Lc.exists(!0))])}function em(e,t){const n=Uf(e.firestore,Xf),r=Qf(e),i=qp(e.converter,t);return tm(n,[hp(up(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Lc.exists(!1))]).then((()=>r))}function tm(e,t){return function(e,t){const n=new qs;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=wf(e);try{const e=await function(e,t){const n=Vs(e),r=no.now(),i=t.reduce(((e,t)=>e.add(t.key)),vc());let a,s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=lc(),l=vc();return n.cs.getEntries(e,i).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,o))).next((i=>{a=i;const s=[];for(const e of t){const t=Bc(e,a.get(e.key).overlayedDocument);null!=t&&s.push(new Wc(e.key,t,pl(t.value.mapValue),Lc.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,s,t)})).next((t=>{s=t;const r=t.applyToLocalDocumentSet(a,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:s.batchId,changes:hc(a)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ba[e.currentUser.toKey()];r||(r=new Do(eo)),r=r.insert(t,n),e.Ba[e.currentUser.toKey()]=r}(r,e.batchId,n),await gf(r,e.changes),await gd(r.remoteStore)}catch(e){const t=Ad(e,"Failed to persist write");n.reject(t)}}(await If(e),t,n))),n.promise}(Jf(e),t)}function nm(e,t,n){const r=n.docs.get(t._key),i=new Xp(e);return new Wp(e,i,t._key,r,new Hp(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){js=e}(zn),Ln(new Ct("firestore",((e,n)=>{let{instanceIdentifier:r,options:i}=n;const a=e.getProvider("app").getImmediate(),s=new Xf(new Ks(e.getProvider("auth-internal")),new Js(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Bs(zs.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qo(e.options.projectId,t)}(a,r),a);return i=Object.assign({useFetchStreams:t},i),s._setSettings(i),s}),"PUBLIC").setMultipleInstances(!0)),Hn(Is,"4.7.3",e),Hn(Is,"4.7.3","esm2017")}();const rm=Bn({apiKey:"AIzaSyCTHvBt2lLe9hCdgkqiDsHLfGTcPUJEuLY",authDomain:"long-covid-8f42d.firebaseapp.com",projectId:"long-covid-8f42d",storageBucket:"long-covid-8f42d.firebasestorage.app",messagingSenderId:"1066445028663",appId:"1:1066445028663:web:28bd3b28e184906feb2eb2"}),im=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qn();const t=Mn(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Mn(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(yt(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;or(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:ls,persistence:[wa,ra,aa]}),r=ut("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>ds)return;const r=null===t||void 0===t?void 0:t.token;fs!==r&&(fs=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){Et(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){Et(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}var i;const a=lt("auth");return a&&Si(n,"http://".concat(a)),n}(rm),am=function(e,t){const n="string"==typeof e?e:t||"(default)",r=Mn("object"==typeof e?e:qn(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=(e=>{const t=lt(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&qf(r,...e)}return r}(rm);var sm=n(579);const om=e=>{let{step:t}=e;return(0,sm.jsx)("div",{className:"step-indicator",children:(0,sm.jsxs)("div",{className:"step-indicator-wrapper",children:[(0,sm.jsxs)("div",{className:"flex flex-col items-center",children:[(0,sm.jsx)("div",{className:"step-circle ".concat(t>=1?t>1?"completed":"active":"inactive"),children:t>1?(0,sm.jsx)(ze,{className:"btn-icon"}):"1"}),(0,sm.jsx)("div",{className:"step-label",children:(0,sm.jsx)("span",{className:"step-label-text ".concat(t>=1?t>1?"completed":"active":"inactive"),children:"Personal Details"})})]}),(0,sm.jsx)("div",{className:"step-connector ".concat(t>1?"completed":"inactive")}),(0,sm.jsxs)("div",{className:"flex flex-col items-center",children:[(0,sm.jsx)("div",{className:"step-circle ".concat(t>=2?t>2?"completed":"active":"inactive"),children:t>2?(0,sm.jsx)(ze,{className:"btn-icon"}):"2"}),(0,sm.jsx)("div",{className:"step-label",children:(0,sm.jsx)("span",{className:"step-label-text ".concat(t>=2?t>2?"completed":"active":"inactive"),children:"Connect Device"})})]}),(0,sm.jsx)("div",{className:"step-connector ".concat(t>2?"completed":"inactive")}),(0,sm.jsxs)("div",{className:"flex flex-col items-center",children:[(0,sm.jsx)("div",{className:"step-circle ".concat(t>=3?"active":"inactive"),children:t>3?(0,sm.jsx)(ze,{className:"btn-icon"}):"3"}),(0,sm.jsx)("div",{className:"step-label",children:(0,sm.jsx)("span",{className:"step-label-text ".concat(t>=3?"active":"inactive"),children:"Authorization"})})]})]})})},lm=e=>{let{title:t,children:n,icon:r}=e;return(0,sm.jsx)("div",{className:"info-box",children:(0,sm.jsxs)("div",{className:"info-box-content",children:[r&&(0,sm.jsx)(r,{className:"info-box-icon"}),(0,sm.jsxs)("div",{children:[(0,sm.jsx)("h3",{className:"info-box-title",children:t}),(0,sm.jsx)("p",{className:"info-box-text",children:n})]})]})})},cm=[{id:"apple-watch",name:"Apple Watch",description:"Connect via Apple Health",icon:Be,color:"bg-gray-900 text-white",features:["Heart Rate","HRV","Activity","Sleep"],connectionType:"oauth",setupInstructions:"We'll redirect you to Apple Health to authorize data sharing."},{id:"fitbit",name:"Fitbit",description:"Connect via Fitbit API",icon:qe,color:"bg-green-600 text-white",features:["Heart Rate","Steps","Sleep","Stress"],connectionType:"oauth",setupInstructions:"You'll be redirected to Fitbit to sign in and authorize access."},{id:"garmin",name:"Garmin",description:"Connect via Garmin Connect",icon:Be,color:"bg-blue-600 text-white",features:["Heart Rate","HRV","Training Load","Recovery"],connectionType:"oauth",setupInstructions:"Sign in to Garmin Connect to enable data synchronization."},{id:"samsung-health",name:"Samsung Health",description:"Connect via Samsung Health",icon:He,color:"bg-blue-800 text-white",features:["Heart Rate","Steps","Sleep","Stress"],connectionType:"oauth",setupInstructions:"Authorize Samsung Health to share your fitness data."},{id:"google-fit",name:"Google Fit",description:"Connect via Google Fit API",icon:He,color:"bg-red-500 text-white",features:["Activity","Heart Rate","Sleep","Location"],connectionType:"oauth",setupInstructions:"Sign in with Google to connect your Fit data."},{id:"manual",name:"Manual Entry",description:"Record data manually",icon:We,color:"bg-purple-600 text-white",features:["Custom Input","Flexible Tracking","No Device Required"],connectionType:"manual",setupInstructions:"No setup required. You'll enter data manually in the app."}],um=["Fatigue","Post-exertional malaise","Brain fog","Headaches","Shortness of breath","Heart palpitations","Dizziness","Joint/muscle pain","Sleep disturbances","Temperature regulation issues","Digestive issues"];const hm=function(){const e=ee(),[t,n]=(0,i.useState)(1),[r,a]=(0,i.useState)({name:"",email:"",password:"",confirmPassword:"",age:"",gender:"",weight:"",height:"",covidDate:"",covidDuration:"",severity:"",symptoms:[],medicalConditions:"",selectedDevice:"",deviceConnected:!1,authorizationGiven:!1}),[s,o]=(0,i.useState)({}),[l,c]=(0,i.useState)(!1),[u,h]=(0,i.useState)(""),d=e=>{const{name:t,value:n,type:r,checked:i}=e.target;a("symptoms"===t?e=>Le(Le({},e),{},{symptoms:i?[...e.symptoms,n]:e.symptoms.filter((e=>e!==n))}):e=>Le(Le({},e),{},{[t]:"checkbox"===r?i:n})),s[t]&&o((e=>Le(Le({},e),{},{[t]:""})))},f=async e=>{try{const t=jp(Kf(am,"users"),Pp("email","==",e.toLowerCase()));return!(await Jp(t)).empty}catch(t){return console.error("Error checking email existence:",t),!1}},p=async()=>{if(1===t&&(()=>{const e={};r.name.trim()||(e.name="Name is required"),r.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email.trim())||(e.email="Please enter a valid email address"):e.email="Email is required";return r.password?r.password.length<6?e.password="Password must be at least 6 characters (Firebase requirement)":r.password.length<8&&(e.password="Password should be at least 8 characters for better security"):e.password="Password is required",r.password!==r.confirmPassword&&(e.confirmPassword="Passwords do not match"),r.age?r.age<13&&(e.age="Age must be at least 13 (Firebase requirement)"):e.age="Age is required",r.gender||(e.gender="Gender is required"),o(e),0===Object.keys(e).length})()){c(!0);try{if(await f(r.email))return o({email:"This email address is already registered. Please use a different email or try signing in."}),void c(!1);c(!1),n(2)}catch(e){c(!1),console.error("Error checking email:",e),n(2)}}else 2===t&&(r.selectedDevice?(o({}),1):(o({device:"Please select a device or manual entry option"}),0))&&(async()=>{c(!0),h("Connecting...");const t=cm.find((e=>e.id===r.selectedDevice));try{if("oauth"===t.connectionType){if("fitbit"===r.selectedDevice){const e={name:r.name,email:r.email,password:r.password,age:r.age,gender:r.gender,weight:r.weight,height:r.height,covidDate:r.covidDate,covidDuration:r.covidDuration,severity:r.severity,symptoms:r.symptoms,medicalConditions:r.medicalConditions,selectedDevice:r.selectedDevice};sessionStorage.setItem("registrationData",JSON.stringify(e));const t=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);sessionStorage.setItem("fitbitOAuthState",t),sessionStorage.setItem("fitbitAuthStartTime",Date.now().toString());const n="23Q9SZ";let i;const a="localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname,s=window.location.hostname.includes("github.io");if(i=a?"".concat(window.location.origin).concat(window.location.pathname.replace("/register",""),"/fitbit-dashboard"):s?"https://obuchel.github.io/energy_balance/fitbit-dashboard":"".concat(window.location.origin,"/fitbit-dashboard"),console.log("=== FITBIT OAUTH DEBUG ==="),console.log("Current window location:",window.location.href),console.log("Current hostname:",window.location.hostname),console.log("Current port:",window.location.port),console.log("Current origin:",window.location.origin),console.log("Current pathname:",window.location.pathname),console.log("Is localhost:",a),console.log("Is GitHub Pages:",s),console.log("Redirect URI being used:",i),console.log("Fitbit Client ID:",n?n.substring(0,6)+"...":"MISSING"),!n)throw new Error("Fitbit Client ID missing. Please check environment variables.");const o=new URL("https://www.fitbit.com/oauth2/authorize");return o.searchParams.append("response_type","code"),o.searchParams.append("client_id",n),o.searchParams.append("redirect_uri",i),o.searchParams.append("scope","activity heartrate location nutrition profile settings sleep social weight"),o.searchParams.append("state",t),console.log("Full Fitbit OAuth URL:",o.toString()),console.log("=== END DEBUG ==="),window.confirm("About to redirect to Fitbit with:\n\n"+"Redirect URI: ".concat(i,"\n")+"Current URL: ".concat(window.location.href,"\n")+"Client ID: ".concat(n?n.substring(0,6)+"...":"MISSING","\n\n")+"Make sure this redirect URI is exactly registered in your Fitbit app.\n\nContinue to Fitbit?")?(h("Redirecting to Fitbit..."),void setTimeout((()=>{window.location.href=o.toString()}),1e3)):(c(!1),void h("Connection cancelled by user."))}await new Promise((e=>setTimeout(e,2e3))),h("Device ready for authorization"),a((e=>Le(Le({},e),{},{deviceConnected:!0}))),n(3)}else a((e=>Le(Le({},e),{},{deviceConnected:!0}))),h("Manual entry selected"),n(3)}catch(e){console.error("Device connection error:",e),h("Connection failed: ".concat(e.message))}finally{c(!1)}})()},m=()=>{t>1&&n(t-1)},g=cm.find((e=>e.id===r.selectedDevice));return(0,sm.jsx)("div",{className:"registration-page",children:(0,sm.jsxs)("div",{className:"registration-container",children:[(0,sm.jsxs)("div",{className:"registration-header",children:[(0,sm.jsx)("h1",{className:"registration-title",children:"Join Energy Balance"}),(0,sm.jsx)("p",{className:"registration-subtitle",children:"Set up your personalized energy management system"})]}),(0,sm.jsx)(om,{step:t}),(0,sm.jsxs)("div",{className:"registration-card fade-in-up",children:[1===t&&(0,sm.jsxs)("div",{children:[(0,sm.jsx)("h2",{className:"step-title",children:"Tell us about yourself"}),(0,sm.jsx)(lm,{title:"Why we need this information",icon:Ge,children:"Your personal details help our system calculate your energy baseline, recovery capacity, and create a customized energy envelope specifically for your condition. All information is stored securely and processed locally on your device."}),(0,sm.jsxs)("form",{onSubmit:e=>{e.preventDefault(),p()},className:"space-y-6",children:[(0,sm.jsxs)("div",{className:"form-grid two-cols",children:[(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsxs)("label",{className:"form-label",children:[(0,sm.jsx)(We,{className:"form-label-icon"}),"Full Name *"]}),(0,sm.jsx)("input",{type:"text",name:"name",value:r.name,onChange:d,className:"form-input ".concat(s.name?"error":""),placeholder:"Enter your full name"}),s.name&&(0,sm.jsx)("p",{className:"error-message",children:s.name})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsxs)("label",{className:"form-label",children:[(0,sm.jsx)(Ke,{className:"form-label-icon"}),"Email Address *"]}),(0,sm.jsx)("input",{type:"email",name:"email",value:r.email,onChange:d,className:"form-input ".concat(s.email?"error":""),placeholder:"Enter your email"}),s.email&&(0,sm.jsx)("p",{className:"error-message",children:s.email})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsxs)("label",{className:"form-label",children:[(0,sm.jsx)(Qe,{className:"form-label-icon"}),"Create Password *"]}),(0,sm.jsx)("input",{type:"password",name:"password",value:r.password,onChange:d,className:"form-input ".concat(s.password?"error":""),placeholder:"Minimum 6 characters (Firebase requirement)"}),s.password&&(0,sm.jsx)("p",{className:"error-message",children:s.password})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsxs)("label",{className:"form-label",children:[(0,sm.jsx)(Qe,{className:"form-label-icon"}),"Confirm Password *"]}),(0,sm.jsx)("input",{type:"password",name:"confirmPassword",value:r.confirmPassword,onChange:d,className:"form-input ".concat(s.confirmPassword?"error":""),placeholder:"Repeat your password"}),s.confirmPassword&&(0,sm.jsx)("p",{className:"error-message",children:s.confirmPassword})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{className:"form-label",children:"Age *"}),(0,sm.jsx)("input",{type:"number",name:"age",value:r.age,onChange:d,className:"form-input ".concat(s.age?"error":""),placeholder:"Your age",min:"18",max:"100"}),s.age&&(0,sm.jsx)("p",{className:"error-message",children:s.age})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{className:"form-label",children:"Gender *"}),(0,sm.jsxs)("select",{name:"gender",value:r.gender,onChange:d,className:"form-select ".concat(s.gender?"error":""),children:[(0,sm.jsx)("option",{value:"",children:"Select gender"}),(0,sm.jsx)("option",{value:"male",children:"Male"}),(0,sm.jsx)("option",{value:"female",children:"Female"}),(0,sm.jsx)("option",{value:"other",children:"Other"}),(0,sm.jsx)("option",{value:"prefer-not-to-say",children:"Prefer not to say"})]}),s.gender&&(0,sm.jsx)("p",{className:"error-message",children:s.gender})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsxs)("label",{className:"form-label",children:[(0,sm.jsx)(Ye,{className:"form-label-icon"}),"Weight (kg)"]}),(0,sm.jsx)("input",{type:"number",name:"weight",value:r.weight,onChange:d,className:"form-input",placeholder:"Optional"})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsxs)("label",{className:"form-label",children:[(0,sm.jsx)(Xe,{className:"form-label-icon"}),"Height (cm)"]}),(0,sm.jsx)("input",{type:"number",name:"height",value:r.height,onChange:d,className:"form-input",placeholder:"Optional"})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsxs)("label",{className:"form-label",children:[(0,sm.jsx)(Je,{className:"form-label-icon"}),"When did you first get COVID?"]}),(0,sm.jsx)("input",{type:"date",name:"covidDate",value:r.covidDate,onChange:d,className:"form-input"})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{className:"form-label",children:"Long COVID duration"}),(0,sm.jsxs)("select",{name:"covidDuration",value:r.covidDuration,onChange:d,className:"form-select",children:[(0,sm.jsx)("option",{value:"",children:"Select duration"}),(0,sm.jsx)("option",{value:"less-than-1-month",children:"Less than 1 month"}),(0,sm.jsx)("option",{value:"1-3-months",children:"1-3 months"}),(0,sm.jsx)("option",{value:"3-6-months",children:"3-6 months"}),(0,sm.jsx)("option",{value:"6-12-months",children:"6-12 months"}),(0,sm.jsx)("option",{value:"1-2-years",children:"1-2 years"}),(0,sm.jsx)("option",{value:"more-than-2-years",children:"More than 2 years"})]})]})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{className:"form-label",children:"Symptom severity"}),(0,sm.jsxs)("select",{name:"severity",value:r.severity,onChange:d,className:"form-select",children:[(0,sm.jsx)("option",{value:"",children:"Select severity"}),(0,sm.jsx)("option",{value:"mild",children:"Mild"}),(0,sm.jsx)("option",{value:"moderate",children:"Moderate"}),(0,sm.jsx)("option",{value:"severe",children:"Severe"}),(0,sm.jsx)("option",{value:"very-severe",children:"Very Severe"})]})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{className:"form-label",children:"What symptoms do you experience? (Select all that apply)"}),(0,sm.jsx)("div",{className:"symptoms-grid",children:um.map((e=>(0,sm.jsxs)("label",{className:"symptom-checkbox ".concat(r.symptoms.includes(e)?"selected":""),children:[(0,sm.jsx)("input",{type:"checkbox",name:"symptoms",value:e,checked:r.symptoms.includes(e),onChange:d,className:"symptom-checkbox-input"}),(0,sm.jsx)("span",{className:"symptom-checkbox-text",children:e})]},e)))})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{className:"form-label",children:"Pre-existing medical conditions"}),(0,sm.jsx)("textarea",{name:"medicalConditions",value:r.medicalConditions,onChange:d,className:"form-textarea",rows:"3",placeholder:"Please list any medical conditions you had before COVID (e.g., diabetes, hypertension, autoimmune conditions)"})]}),(0,sm.jsxs)("div",{className:"form-navigation",children:[(0,sm.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>window.history.back(),children:"Cancel"}),(0,sm.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:l,children:l?(0,sm.jsxs)(sm.Fragment,{children:[(0,sm.jsx)("div",{className:"loading-spinner"}),"Checking..."]}):(0,sm.jsxs)(sm.Fragment,{children:["Next",(0,sm.jsx)($e,{className:"btn-icon"})]})})]})]})]}),2===t&&(0,sm.jsxs)("div",{children:[(0,sm.jsx)("h2",{className:"step-title",children:"Connect your wearable device"}),(0,sm.jsx)(lm,{title:"Why connect a wearable device?",icon:Ze,children:"Energy Balance uses data from your wearable device to monitor heart rate, heart rate variability (HRV), and activity levels. This provides objective measurements of your energy expenditure and physiological stress, helping to prevent overexertion and PEM."}),(0,sm.jsx)("div",{className:"device-grid",children:cm.map((e=>{const t=e.icon;return(0,sm.jsxs)("div",{className:"device-card ".concat(r.selectedDevice===e.id?"selected":""),onClick:()=>{return t=e.id,a((e=>Le(Le({},e),{},{selectedDevice:t}))),void o((e=>Le(Le({},e),{},{device:""})));var t},children:[(0,sm.jsx)("div",{className:"device-icon-wrapper ".concat(e.color),children:(0,sm.jsx)(t,{className:"device-icon"})}),(0,sm.jsx)("h3",{className:"device-name",children:e.name}),(0,sm.jsx)("p",{className:"device-description",children:e.description}),(0,sm.jsx)("div",{className:"device-features",children:e.features.map((e=>(0,sm.jsxs)("div",{className:"device-feature",children:[(0,sm.jsx)(ze,{className:"device-feature-icon"}),e]},e)))})]},e.id)}))}),s.device&&(0,sm.jsx)("div",{className:"error-message text-center",children:s.device}),(0,sm.jsxs)("div",{className:"form-navigation",children:[(0,sm.jsxs)("button",{type:"button",className:"btn btn-secondary",onClick:m,children:[(0,sm.jsx)(et,{className:"btn-icon"}),"Back"]}),(0,sm.jsx)("button",{type:"button",className:"btn btn-primary",onClick:p,disabled:!r.selectedDevice||l,children:l?(0,sm.jsxs)(sm.Fragment,{children:[(0,sm.jsx)("div",{className:"loading-spinner"}),"Connecting..."]}):(0,sm.jsxs)(sm.Fragment,{children:["Connect Device",(0,sm.jsx)($e,{className:"btn-icon"})]})})]})]}),3===t&&g&&(0,sm.jsxs)("div",{children:[(0,sm.jsx)("h2",{className:"step-title",children:"Authorize Data Access"}),(0,sm.jsxs)("div",{className:"auth-device-info",children:[(0,sm.jsx)("div",{className:"auth-device-icon ".concat(g.color),children:(0,sm.jsx)(g.icon,{className:"device-icon"})}),(0,sm.jsx)("h3",{className:"auth-device-name",children:g.name}),(0,sm.jsx)("p",{className:"auth-device-instructions",children:g.setupInstructions}),u&&(0,sm.jsx)("div",{className:"connection-status ".concat(u.includes("success")?"success":"info"),children:u})]}),(0,sm.jsx)(lm,{title:"Data Privacy & Security",icon:Ge,children:"Your health data is encrypted and stored securely. We only access the specific metrics needed for energy management (heart rate, activity levels, sleep). You can revoke access at any time through your device settings or our app."}),(0,sm.jsxs)("div",{className:"data-permissions",children:[(0,sm.jsx)("h4",{className:"permissions-title",children:"Data Access Permissions"}),(0,sm.jsx)("div",{className:"permissions-list",children:g.features.map((e=>(0,sm.jsxs)("div",{className:"permission-item",children:[(0,sm.jsx)(ze,{className:"permission-icon"}),e," data"]},e)))})]}),(0,sm.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),r.authorizationGiven){c(!0),o({});try{const t=r.email.trim().toLowerCase(),n=r.password.trim();if(console.log("Starting registration process..."),console.log("Email:",t),console.log("Password length:",n.length),n.length<6)throw new Error("Password must be at least 6 characters long");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))throw new Error("Please enter a valid email address");console.log("Checking email availability...");if(await f(t))throw new Error("This email address is already registered. Please use a different email or try signing in.");console.log("Creating Firebase Auth user...");const i=(await $i(im,t,n)).user;console.log("Firebase Auth user created successfully:",i.uid);const a=Le(Le({},r),{},{email:t});console.log("Saving user data to Firestore..."),await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;try{const n={uid:e.uid,name:t.name.trim(),email:t.email.toLowerCase().trim(),age:parseInt(t.age),gender:t.gender,weight:t.weight?parseFloat(t.weight):null,height:t.height?parseFloat(t.height):null,covidDate:t.covidDate||null,covidDuration:t.covidDuration||null,severity:t.severity||null,symptoms:t.symptoms||[],medicalConditions:t.medicalConditions||null,selectedDevice:t.selectedDevice,deviceConnected:t.deviceConnected,authorizationGiven:t.authorizationGiven,createdAt:(new Date).toISOString(),lastUpdated:(new Date).toISOString(),energyProfile:{baselineCalculated:!1,currentEnergyLevel:50,energyEnvelope:null,dailyEnergyBudget:null},preferences:{notifications:!0,reminderFrequency:"daily",dataRetention:"1year"}};return await $p(Qf(am,"users",e.uid),n),console.log("User data saved successfully to Firestore"),n}catch(n){throw console.error("Error saving user data to Firestore:",n),new Error("Failed to save user profile. Please try again.")}}(i,a),console.log("Registration completed successfully"),alert("Registration successful! Welcome to Energy Balance."),e("/login",{state:{message:"Registration successful! Please sign in with your new account.",email:t}})}catch(n){console.error("Registration error:",n),console.error("Error code:",n.code),console.error("Error message:",n.message);let e="Registration failed. Please try again.";"auth/email-already-in-use"===n.code?e="This email address is already registered. Please use a different email or try signing in.":"auth/weak-password"===n.code?e="Password is too weak. Please choose a stronger password with at least 6 characters.":"auth/invalid-email"===n.code?e="Invalid email address format. Please check your email and try again.":"auth/operation-not-allowed"===n.code?e="Email/password accounts are not enabled. Please contact support.":"auth/too-many-requests"===n.code?e="Too many failed attempts. Please wait a few minutes and try again.":n.message.includes("Failed to save user profile")?e="Account created but profile setup failed. Please contact support.":(n.message.includes("already registered")||n.message.includes("Password must be")||n.message.includes("valid email"))&&(e=n.message),o({submit:e})}finally{c(!1)}}else o({authorization:"Please authorize data access to continue"})},children:[(0,sm.jsxs)("div",{className:"auth-checkbox-wrapper",children:[(0,sm.jsx)("input",{type:"checkbox",name:"authorizationGiven",checked:r.authorizationGiven,onChange:d,className:"auth-checkbox"}),(0,sm.jsxs)("label",{className:"auth-checkbox-label",children:["I authorize Energy Balance to access my fitness and health data from ",g.name,"for the purpose of energy monitoring and management. I understand that I can revoke this authorization at any time through my device settings or the Energy Balance app."]})]}),s.authorization&&(0,sm.jsx)("div",{className:"error-message",children:s.authorization}),s.submit&&(0,sm.jsx)("div",{className:"error-message text-center",children:s.submit}),(0,sm.jsxs)("div",{className:"form-navigation",children:[(0,sm.jsxs)("button",{type:"button",className:"btn btn-secondary",onClick:m,children:[(0,sm.jsx)(et,{className:"btn-icon"}),"Back"]}),(0,sm.jsx)("button",{type:"submit",className:"btn btn-success",disabled:!r.authorizationGiven||l,children:l?(0,sm.jsxs)(sm.Fragment,{children:[(0,sm.jsx)("div",{className:"loading-spinner"}),"Creating Account..."]}):(0,sm.jsxs)(sm.Fragment,{children:["Complete Registration",(0,sm.jsx)(ze,{className:"btn-icon"})]})})]})]}),r.deviceConnected&&"manual"!==r.selectedDevice&&(0,sm.jsxs)("div",{className:"connection-test slide-in-right",children:[(0,sm.jsxs)("h4",{className:"connection-test-title",children:[(0,sm.jsx)(ze,{className:"btn-icon"}),"Connection Test"]}),(0,sm.jsxs)("div",{className:"test-results",children:[(0,sm.jsxs)("div",{className:"test-result-item",children:[(0,sm.jsx)("span",{className:"test-result-label",children:"Device Status:"}),(0,sm.jsx)("span",{className:"test-result-value",children:"Connected"})]}),(0,sm.jsxs)("div",{className:"test-result-item",children:[(0,sm.jsx)("span",{className:"test-result-label",children:"Last Sync:"}),(0,sm.jsx)("span",{className:"test-result-value",children:"Just now"})]}),(0,sm.jsxs)("div",{className:"test-result-item",children:[(0,sm.jsx)("span",{className:"test-result-label",children:"Data Available:"}),(0,sm.jsx)("span",{className:"test-result-value",children:g.features.join(", ")})]})]})]})]})]}),(0,sm.jsxs)("div",{className:"progress-summary fade-in-up",children:[(0,sm.jsx)("h3",{className:"progress-title",children:"Registration Progress"}),(0,sm.jsxs)("div",{className:"progress-items",children:[(0,sm.jsxs)("div",{className:"progress-item",children:[(0,sm.jsx)("span",{className:"progress-item-label",children:"Personal Information"}),(0,sm.jsx)("div",{className:"progress-item-status",children:t>1?(0,sm.jsx)(ze,{className:"progress-icon completed"}):(0,sm.jsx)("div",{className:"progress-circle ".concat(1===t?"active":"inactive")})})]}),(0,sm.jsxs)("div",{className:"progress-item",children:[(0,sm.jsx)("span",{className:"progress-item-label",children:"Device Connection"}),(0,sm.jsx)("div",{className:"progress-item-status",children:t>2?(0,sm.jsx)(ze,{className:"progress-icon completed"}):(0,sm.jsx)("div",{className:"progress-circle ".concat(2===t?"active":"inactive")})})]}),(0,sm.jsxs)("div",{className:"progress-item",children:[(0,sm.jsx)("span",{className:"progress-item-label",children:"Authorization"}),(0,sm.jsx)("div",{className:"progress-item-status",children:r.authorizationGiven?(0,sm.jsx)(ze,{className:"progress-icon completed"}):(0,sm.jsx)("div",{className:"progress-circle ".concat(3===t?"active":"inactive")})})]})]})]}),(0,sm.jsx)("div",{className:"help-section",children:(0,sm.jsxs)("p",{className:"help-text",children:["Need help? ",(0,sm.jsx)("button",{className:"help-link",children:"Contact Support"})]})})]})})},dm=()=>"localhost"===window.location.hostname||"127.0.0.1"===window.location.hostname?"http://localhost:64556/energy_balance/fitbit/callback":"https://obuchel.github.io/energy_balance/fitbit-dashboard",fm=()=>{const[e,t]=(0,i.useState)("processing"),[n,r]=(0,i.useState)(""),[a,s]=(0,i.useState)(""),o=ee(),l=$();(0,i.useEffect)((()=>{const e=async(e,r)=>{try{console.log("Creating Firebase user...");const i=jp(Kf(am,"users"),Pp("email","==",e.email.toLowerCase()));if(!(await Jp(i)).empty)throw new Error("An account with this email already exists");const a=(await $i(im,e.email.toLowerCase().trim(),e.password)).user;console.log("Firebase user created:",a.uid),t("Connecting to Fitbit..."),console.log("Exchanging code for tokens...");const s=await(async e=>{const t="23Q9SZ",n="e30907e711956dbe26501f3af5fb7a6b";console.log("Exchanging code for tokens with Client ID:",t.substring(0,6)+"...");const r=btoa("".concat(t,":").concat(n)),i=await fetch("https://api.fitbit.com/oauth2/token",{method:"POST",headers:{Authorization:"Basic ".concat(r),"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:new URLSearchParams({grant_type:"authorization_code",code:e,redirect_uri:dm()})});if(!i.ok){const e=await i.json();throw console.error("Token exchange error:",e),new Error("Token exchange failed: ".concat(e.error_description||e.error||i.statusText))}const a=await i.json();return console.log("Token exchange successful, received access token"),a})(r);t("Fetching your Fitbit data..."),console.log("Fetching initial Fitbit data...");const o=await(async e=>{try{var t,r,i,a,s,o,l,c,u,h,d,f,p;const n={Authorization:"Bearer ".concat(e),Accept:"application/json"};console.log("Fetching Fitbit data...");const b=[fetch("https://api.fitbit.com/1/user/-/profile.json",{headers:n}),fetch("https://api.fitbit.com/1/user/-/activities/heart/date/today/1d.json",{headers:n}),fetch("https://api.fitbit.com/1/user/-/activities/date/today.json",{headers:n})],w=await Promise.all(b);if(!w[0].ok){var m,g;const e=await w[0].json();throw new Error("Failed to fetch profile: ".concat((null===(m=e.errors)||void 0===m||null===(g=m[0])||void 0===g?void 0:g.message)||w[0].statusText))}if(!w[2].ok){var v,y;const e=await w[2].json();throw new Error("Failed to fetch activity: ".concat((null===(v=e.errors)||void 0===v||null===(y=v[0])||void 0===y?void 0:y.message)||w[2].statusText))}const _=await w[0].json(),x=w[1].ok?await w[1].json():null,S=await w[2].json();return console.log("Fitbit data fetched successfully"),console.log("Profile:",null===(t=_.user)||void 0===t?void 0:t.displayName),console.log("Heart rate available:",!!x),console.log("Steps today:",null===(r=S.summary)||void 0===r?void 0:r.steps),{profile:_.user,heartRate:(null===x||void 0===x||null===(i=x["activities-heart"])||void 0===i||null===(a=i[0])||void 0===a||null===(s=a.value)||void 0===s?void 0:s.restingHeartRate)||null,steps:(null===(o=S.summary)||void 0===o?void 0:o.steps)||0,calories:(null===(l=S.summary)||void 0===l?void 0:l.caloriesOut)||0,distance:(null===(c=S.summary)||void 0===c||null===(u=c.distances)||void 0===u||null===(h=u[0])||void 0===h?void 0:h.distance)||0,activeMinutes:((null===(d=S.summary)||void 0===d?void 0:d.fairlyActiveMinutes)||0)+((null===(f=S.summary)||void 0===f?void 0:f.veryActiveMinutes)||0),floorsClimbed:(null===(p=S.summary)||void 0===p?void 0:p.floors)||0}}catch(n){throw console.error("Error fetching Fitbit data:",n),new Error("Failed to fetch Fitbit data: ".concat(n.message))}})(s.access_token),l={uid:a.uid,name:e.name.trim(),email:e.email.toLowerCase().trim(),age:parseInt(e.age),gender:e.gender,weight:e.weight?parseFloat(e.weight):null,height:e.height?parseFloat(e.height):null,covidDate:e.covidDate||null,covidDuration:e.covidDuration||null,severity:e.severity||null,symptoms:e.symptoms||[],medicalConditions:e.medicalConditions||"",selectedDevice:"fitbit",deviceConnected:!0,authorizationGiven:!0,fitbitData:{accessToken:s.access_token,refreshToken:s.refresh_token,tokenExpiresAt:new Date(Date.now()+1e3*s.expires_in).toISOString(),tokenType:s.token_type,scope:s.scope,profile:o.profile,authCode:r,redirectUri:dm(),tokensReceivedAt:(new Date).toISOString()},latestFitbitData:{date:(new Date).toISOString().split("T")[0],heartRate:o.heartRate,steps:o.steps,calories:o.calories,distance:o.distance,activeMinutes:o.activeMinutes,lastSync:(new Date).toISOString()},energyProfile:{baselineCalculated:!1,currentEnergyLevel:50,energyEnvelope:null,dailyEnergyBudget:null,baselineHeartRate:o.heartRate||null},preferences:{notifications:!0,reminderFrequency:"daily",dataRetention:"1year"},createdAt:(new Date).toISOString(),lastUpdated:(new Date).toISOString(),registrationComplete:!0,accountStatus:"active"};t("Saving your profile..."),await $p(Qf(am,"users",a.uid),l),console.log("User data saved to Firestore with Fitbit data"),await(async(e,t)=>{try{const n=(new Date).toISOString().split("T")[0],r={date:n,profile:t.profile,heartRate:{resting:t.heartRate,fetchedAt:(new Date).toISOString()},activity:{steps:t.steps,calories:t.calories,distance:t.distance,activeMinutes:t.activeMinutes,floorsClimbed:t.floorsClimbed,fetchedAt:(new Date).toISOString()},createdAt:(new Date).toISOString()};await $p(Qf(am,"users",e,"dailyData",n),r,{merge:!0}),console.log("Saved daily Fitbit data for",n)}catch(n){console.error("Error saving daily data:",n)}})(a.uid,o),sessionStorage.removeItem("registrationData"),sessionStorage.removeItem("fitbitOAuthState"),sessionStorage.removeItem("fitbitAuthStartTime"),console.log("Registration completed successfully with Fitbit data"),console.log("Latest data stored:",l.latestFitbitData)}catch(n){throw console.error("Error creating user:",n),"auth/email-already-in-use"===n.code?new Error("This email is already registered. Please use a different email or sign in."):"auth/weak-password"===n.code?new Error("Password is too weak. Please choose a stronger password."):"auth/invalid-email"===n.code?new Error("Invalid email address format."):n.message.includes("Fitbit")?new Error("Fitbit connection failed: ".concat(n.message)):n.message.includes("Token exchange")?new Error("Failed to connect to Fitbit: ".concat(n.message)):n.message.includes("credentials not configured")?new Error("Fitbit app credentials missing. Please check your environment variables."):new Error("Registration failed: ".concat(n.message))}};(async()=>{try{console.log("=== Fitbit Callback Started ==="),console.log("Full URL:",window.location.href),console.log("Search params:",l.search);const n=new URLSearchParams(l.search),i=n.get("code"),a=n.get("state"),c=n.get("error"),u=n.get("error_description");if(console.log("Callback params:",{code:i?i.substring(0,10)+"...":null,state:a?a.substring(0,10)+"...":null,error:c,errorDescription:u}),s("Code: ".concat(i?"Present":"Missing",", State: ").concat(a?"Present":"Missing")),c){let e="Fitbit authorization failed";return e="access_denied"===c?"You denied access to Fitbit. Please try again and authorize access.":"Fitbit error: ".concat(u||c),r(e),void t("error")}if(!i)return r("No authorization code received from Fitbit. Please try the registration process again."),void t("error");if(!a)return r("No state parameter received from Fitbit. Please try the registration process again."),void t("error");const h=sessionStorage.getItem("fitbitOAuthState");if(console.log("State verification:",{received:a.substring(0,10)+"...",stored:h?h.substring(0,10)+"...":null}),a!==h)return r("Security validation failed. Please start the registration process again."),void t("error");const d=sessionStorage.getItem("fitbitAuthStartTime");if(d){if(Date.now()-parseInt(d)>6e5)return r("Session expired. Please start the registration process again."),void t("error")}const f=sessionStorage.getItem("registrationData");if(!f)return r("Registration data not found. Please start the registration process again."),void t("error");const p=JSON.parse(f);console.log("Registration data found for:",p.email),t("Creating your account..."),await e(p,i),t("success"),setTimeout((()=>{o("/login",{state:{message:"Registration successful! Your Fitbit has been connected and data synced. Please sign in.",email:p.email}})}),3e3)}catch(n){console.error("Fitbit callback error:",n),r("Failed to complete registration: ".concat(n.message)),t("error")}})()}),[l.search,o]);return(0,sm.jsxs)("div",{className:"fitbit-callback-container",style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",padding:"20px",fontFamily:"system-ui, -apple-system, sans-serif",backgroundColor:"#f8f9fa"},children:[(0,sm.jsxs)("div",{className:"callback-content",style:{textAlign:"center",maxWidth:"500px",padding:"40px",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",backgroundColor:"white"},children:[("processing"===e||"Creating your account..."===e||"Connecting to Fitbit..."===e||"Fetching your Fitbit data..."===e||"Saving your profile..."===e)&&(0,sm.jsxs)("div",{children:[(0,sm.jsxs)("h2",{style:{color:"#495057",marginBottom:"20px"},children:["\ud83d\udd17 ","processing"===e?"Connecting your Fitbit account...":e]}),(0,sm.jsx)("div",{className:"spinner",style:{border:"4px solid #e9ecef",borderTop:"4px solid #007bff",borderRadius:"50%",width:"50px",height:"50px",animation:"spin 1s linear infinite",margin:"20px auto"}}),(0,sm.jsxs)("p",{style:{color:"#6c757d"},children:["processing"===e&&"Please wait while we complete your registration...","Creating your account..."===e&&"Setting up your Firebase account...","Connecting to Fitbit..."===e&&"Exchanging authorization code for access tokens...","Fetching your Fitbit data..."===e&&"Getting your health data from Fitbit...","Saving your profile..."===e&&"Saving your profile and Fitbit data..."]}),a&&"processing"===e&&(0,sm.jsxs)("p",{style:{fontSize:"14px",color:"#6c757d",marginTop:"10px"},children:["Debug: ",a]})]}),"success"===e&&(0,sm.jsxs)("div",{children:[(0,sm.jsx)("h2",{style:{color:"#28a745",marginBottom:"20px"},children:"\u2705 Fitbit Connected Successfully!"}),(0,sm.jsx)("p",{style:{color:"#495057",marginBottom:"10px"},children:"Your account has been created and your Fitbit data has been synced."}),(0,sm.jsx)("p",{style:{color:"#6c757d",fontSize:"14px"},children:"Redirecting to sign in page..."}),(0,sm.jsx)("div",{className:"success-animation",style:{width:"60px",height:"60px",margin:"20px auto",borderRadius:"50%",backgroundColor:"#28a745",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"24px",color:"white",animation:"pulse 2s infinite"},children:"\u2713"})]}),"error"===e&&(0,sm.jsxs)("div",{children:[(0,sm.jsx)("h2",{style:{color:"#dc3545",marginBottom:"20px"},children:"\u274c Connection Failed"}),(0,sm.jsx)("div",{style:{backgroundColor:"#f8d7da",border:"1px solid #f5c6cb",borderRadius:"8px",padding:"15px",marginBottom:"20px"},children:(0,sm.jsx)("p",{style:{color:"#721c24",margin:"0",fontSize:"14px"},children:n})}),(0,sm.jsxs)("div",{style:{display:"flex",gap:"10px",justifyContent:"center",flexWrap:"wrap"},children:[(0,sm.jsx)("button",{onClick:()=>{sessionStorage.removeItem("registrationData"),sessionStorage.removeItem("fitbitOAuthState"),sessionStorage.removeItem("fitbitAuthStartTime"),o("/register")},style:{backgroundColor:"#007bff",color:"white",border:"none",padding:"12px 24px",borderRadius:"6px",cursor:"pointer",fontSize:"16px",fontWeight:"500"},children:"Try Again"}),(0,sm.jsx)("button",{onClick:()=>{o("/login")},style:{backgroundColor:"#6c757d",color:"white",border:"none",padding:"12px 24px",borderRadius:"6px",cursor:"pointer",fontSize:"16px",fontWeight:"500"},children:"Go to Login"})]})]})]}),(0,sm.jsx)("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n        \n        @keyframes pulse {\n          0%, 100% { transform: scale(1); opacity: 1; }\n          50% { transform: scale(1.1); opacity: 0.8; }\n        }\n      "})]})};class pm extends Map{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ym;if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[n,r]of e)this.set(n,r)}get(e){return super.get(mm(this,e))}has(e){return super.has(mm(this,e))}set(e,t){return super.set(gm(this,e),t)}delete(e){return super.delete(vm(this,e))}}Set;function mm(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):t}function gm(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)?n.get(i):(n.set(i,t),t)}function vm(e,t){let{_intern:n,_key:r}=e;const i=r(t);return n.has(i)&&(t=n.get(i),n.delete(i)),t}function ym(e){return null!==e&&"object"===typeof e?e.valueOf():e}function bm(e){return e}function wm(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return _m(e,bm,bm,n)}function _m(e,t,n,r){return function e(i,a){if(a>=r.length)return n(i);const s=new pm,o=r[a++];let l=-1;for(const t of i){const e=o(t,++l,i),n=s.get(e);n?n.push(t):s.set(e,[t])}for(const[t,n]of s)s.set(t,e(n,a));return t(s)}(e,0)}function xm(e,t){let n;if(void 0===t)for(const r of e)null!=r&&(n<r||void 0===n&&r>=r)&&(n=r);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function Sm(e,t){let n=0;if(void 0===t)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function km(e){return e}var Em=1e-6;function Cm(e){return"translate("+e+",0)"}function Nm(e){return"translate(0,"+e+")"}function Tm(e){return t=>+e(t)}function Im(e,t){return t=Math.max(0,e.bandwidth()-2*t)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function Am(){return!this.__axis}function jm(e,t){var n=[],r=null,i=null,a=6,s=6,o=3,l="undefined"!==typeof window&&window.devicePixelRatio>1?0:.5,c=1===e||4===e?-1:1,u=4===e||2===e?"x":"y",h=1===e||3===e?Cm:Nm;function d(d){var f=null==r?t.ticks?t.ticks.apply(t,n):t.domain():r,p=null==i?t.tickFormat?t.tickFormat.apply(t,n):km:i,m=Math.max(a,0)+o,g=t.range(),v=+g[0]+l,y=+g[g.length-1]+l,b=(t.bandwidth?Im:Tm)(t.copy(),l),w=d.selection?d.selection():d,_=w.selectAll(".domain").data([null]),x=w.selectAll(".tick").data(f,t).order(),S=x.exit(),k=x.enter().append("g").attr("class","tick"),E=x.select("line"),C=x.select("text");_=_.merge(_.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(k),E=E.merge(k.append("line").attr("stroke","currentColor").attr(u+"2",c*a)),C=C.merge(k.append("text").attr("fill","currentColor").attr(u,c*m).attr("dy",1===e?"0em":3===e?"0.71em":"0.32em")),d!==w&&(_=_.transition(d),x=x.transition(d),E=E.transition(d),C=C.transition(d),S=S.transition(d).attr("opacity",Em).attr("transform",(function(e){return isFinite(e=b(e))?h(e+l):this.getAttribute("transform")})),k.attr("opacity",Em).attr("transform",(function(e){var t=this.parentNode.__axis;return h((t&&isFinite(t=t(e))?t:b(e))+l)}))),S.remove(),_.attr("d",4===e||2===e?s?"M"+c*s+","+v+"H"+l+"V"+y+"H"+c*s:"M"+l+","+v+"V"+y:s?"M"+v+","+c*s+"V"+l+"H"+y+"V"+c*s:"M"+v+","+l+"H"+y),x.attr("opacity",1).attr("transform",(function(e){return h(b(e)+l)})),E.attr(u+"2",c*a),C.attr(u,c*m).text(p),w.filter(Am).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===e?"start":4===e?"end":"middle"),w.each((function(){this.__axis=b}))}return d.scale=function(e){return arguments.length?(t=e,d):t},d.ticks=function(){return n=Array.from(arguments),d},d.tickArguments=function(e){return arguments.length?(n=null==e?[]:Array.from(e),d):n.slice()},d.tickValues=function(e){return arguments.length?(r=null==e?null:Array.from(e),d):r&&r.slice()},d.tickFormat=function(e){return arguments.length?(i=e,d):i},d.tickSize=function(e){return arguments.length?(a=s=+e,d):a},d.tickSizeInner=function(e){return arguments.length?(a=+e,d):a},d.tickSizeOuter=function(e){return arguments.length?(s=+e,d):s},d.tickPadding=function(e){return arguments.length?(o=+e,d):o},d.offset=function(e){return arguments.length?(l=+e,d):l},d}function Dm(e){return jm(3,e)}function Pm(e){return jm(4,e)}function Rm(){}function Om(e){return null==e?Rm:function(){return this.querySelector(e)}}function Lm(){return[]}function Mm(e){return null==e?Lm:function(){return this.querySelectorAll(e)}}function Fm(e){return function(){return function(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}(e.apply(this,arguments))}}function Um(e){return function(){return this.matches(e)}}function Vm(e){return function(t){return t.matches(e)}}var zm=Array.prototype.find;function Bm(){return this.firstElementChild}var qm=Array.prototype.filter;function Hm(){return Array.from(this.children)}function Wm(e){return new Array(e.length)}function Gm(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function Km(e,t,n,r,i,a){for(var s,o=0,l=t.length,c=a.length;o<c;++o)(s=t[o])?(s.__data__=a[o],r[o]=s):n[o]=new Gm(e,a[o]);for(;o<l;++o)(s=t[o])&&(i[o]=s)}function Qm(e,t,n,r,i,a,s){var o,l,c,u=new Map,h=t.length,d=a.length,f=new Array(h);for(o=0;o<h;++o)(l=t[o])&&(f[o]=c=s.call(l,l.__data__,o,t)+"",u.has(c)?i[o]=l:u.set(c,l));for(o=0;o<d;++o)c=s.call(e,a[o],o,a)+"",(l=u.get(c))?(r[o]=l,l.__data__=a[o],u.delete(c)):n[o]=new Gm(e,a[o]);for(o=0;o<h;++o)(l=t[o])&&u.get(f[o])===l&&(i[o]=l)}function Ym(e){return e.__data__}function Xm(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}function Jm(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}Gm.prototype={constructor:Gm,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var $m="http://www.w3.org/1999/xhtml";const Zm={svg:"http://www.w3.org/2000/svg",xhtml:$m,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function eg(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),Zm.hasOwnProperty(t)?{space:Zm[t],local:e}:e}function tg(e){return function(){this.removeAttribute(e)}}function ng(e){return function(){this.removeAttributeNS(e.space,e.local)}}function rg(e,t){return function(){this.setAttribute(e,t)}}function ig(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function ag(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function sg(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function og(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function lg(e){return function(){this.style.removeProperty(e)}}function cg(e,t,n){return function(){this.style.setProperty(e,t,n)}}function ug(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function hg(e,t){return e.style.getPropertyValue(t)||og(e).getComputedStyle(e,null).getPropertyValue(t)}function dg(e){return function(){delete this[e]}}function fg(e,t){return function(){this[e]=t}}function pg(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function mg(e){return e.trim().split(/^|\s+/)}function gg(e){return e.classList||new vg(e)}function vg(e){this._node=e,this._names=mg(e.getAttribute("class")||"")}function yg(e,t){for(var n=gg(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function bg(e,t){for(var n=gg(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function wg(e){return function(){yg(this,e)}}function _g(e){return function(){bg(this,e)}}function xg(e,t){return function(){(t.apply(this,arguments)?yg:bg)(this,e)}}function Sg(){this.textContent=""}function kg(e){return function(){this.textContent=e}}function Eg(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function Cg(){this.innerHTML=""}function Ng(e){return function(){this.innerHTML=e}}function Tg(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function Ig(){this.nextSibling&&this.parentNode.appendChild(this)}function Ag(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function jg(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===$m&&t.documentElement.namespaceURI===$m?t.createElement(e):t.createElementNS(n,e)}}function Dg(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Pg(e){var t=eg(e);return(t.local?Dg:jg)(t)}function Rg(){return null}function Og(){var e=this.parentNode;e&&e.removeChild(this)}function Lg(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Mg(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Fg(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,a=t.length;r<a;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function Ug(e,t,n){return function(){var r,i=this.__on,a=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var s=0,o=i.length;s<o;++s)if((r=i[s]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=n),void(r.value=t);this.addEventListener(e.type,a,n),r={type:e.type,name:e.name,value:t,listener:a,options:n},i?i.push(r):this.__on=[r]}}function Vg(e,t,n){var r=og(e),i=r.CustomEvent;"function"===typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function zg(e,t){return function(){return Vg(this,e,t)}}function Bg(e,t){return function(){return Vg(this,e,t.apply(this,arguments))}}vg.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var qg=[null];function Hg(e,t){this._groups=e,this._parents=t}function Wg(){return new Hg([[document.documentElement]],qg)}Hg.prototype=Wg.prototype={constructor:Hg,select:function(e){"function"!==typeof e&&(e=Om(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,s,o=t[i],l=o.length,c=r[i]=new Array(l),u=0;u<l;++u)(a=o[u])&&(s=e.call(a,a.__data__,u,o))&&("__data__"in a&&(s.__data__=a.__data__),c[u]=s);return new Hg(r,this._parents)},selectAll:function(e){e="function"===typeof e?Fm(e):Mm(e);for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var s,o=t[a],l=o.length,c=0;c<l;++c)(s=o[c])&&(r.push(e.call(s,s.__data__,c,o)),i.push(s));return new Hg(r,i)},selectChild:function(e){return this.select(null==e?Bm:function(e){return function(){return zm.call(this.children,e)}}("function"===typeof e?e:Vm(e)))},selectChildren:function(e){return this.selectAll(null==e?Hm:function(e){return function(){return qm.call(this.children,e)}}("function"===typeof e?e:Vm(e)))},filter:function(e){"function"!==typeof e&&(e=Um(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,s=t[i],o=s.length,l=r[i]=[],c=0;c<o;++c)(a=s[c])&&e.call(a,a.__data__,c,s)&&l.push(a);return new Hg(r,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,Ym);var n=t?Qm:Km,r=this._parents,i=this._groups;"function"!==typeof e&&(e=function(e){return function(){return e}}(e));for(var a=i.length,s=new Array(a),o=new Array(a),l=new Array(a),c=0;c<a;++c){var u=r[c],h=i[c],d=h.length,f=Xm(e.call(u,u&&u.__data__,c,r)),p=f.length,m=o[c]=new Array(p),g=s[c]=new Array(p);n(u,h,m,g,l[c]=new Array(d),f,t);for(var v,y,b=0,w=0;b<p;++b)if(v=m[b]){for(b>=w&&(w=b+1);!(y=g[w])&&++w<p;);v._next=y||null}}return(s=new Hg(s,r))._enter=o,s._exit=l,s},enter:function(){return new Hg(this._enter||this._groups.map(Wm),this._parents)},exit:function(){return new Hg(this._exit||this._groups.map(Wm),this._parents)},join:function(e,t,n){var r=this.enter(),i=this,a=this.exit();return"function"===typeof e?(r=e(r))&&(r=r.selection()):r=r.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,a=r.length,s=Math.min(i,a),o=new Array(i),l=0;l<s;++l)for(var c,u=n[l],h=r[l],d=u.length,f=o[l]=new Array(d),p=0;p<d;++p)(c=u[p]||h[p])&&(f[p]=c);for(;l<i;++l)o[l]=n[l];return new Hg(o,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],a=i.length-1,s=i[a];--a>=0;)(r=i[a])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=Jm);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var s,o=n[a],l=o.length,c=i[a]=new Array(l),u=0;u<l;++u)(s=o[u])&&(c[u]=s);c.sort(t)}return new Hg(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var s=r[i];if(s)return s}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,a=t[n],s=0,o=a.length;s<o;++s)(i=a[s])&&e.call(i,i.__data__,s,a);return this},attr:function(e,t){var n=eg(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?ng:tg:"function"===typeof t?n.local?sg:ag:n.local?ig:rg)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?lg:"function"===typeof t?ug:cg)(e,t,null==n?"":n)):hg(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?dg:"function"===typeof t?pg:fg)(e,t)):this.node()[e]},classed:function(e,t){var n=mg(e+"");if(arguments.length<2){for(var r=gg(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"===typeof t?xg:t?wg:_g)(n,t))},text:function(e){return arguments.length?this.each(null==e?Sg:("function"===typeof e?Eg:kg)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?Cg:("function"===typeof e?Tg:Ng)(e)):this.node().innerHTML},raise:function(){return this.each(Ig)},lower:function(){return this.each(Ag)},append:function(e){var t="function"===typeof e?e:Pg(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"===typeof e?e:Pg(e),r=null==t?Rg:"function"===typeof t?t:Om(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Og)},clone:function(e){return this.select(e?Mg:Lg)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,a=function(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}(e+""),s=a.length;if(!(arguments.length<2)){for(o=t?Ug:Fg,r=0;r<s;++r)this.each(o(a[r],t,n));return this}var o=this.node().__on;if(o)for(var l,c=0,u=o.length;c<u;++c)for(r=0,l=o[c];r<s;++r)if((i=a[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(e,t){return this.each(("function"===typeof t?Bg:zg)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r,i=e[t],a=0,s=i.length;a<s;++a)(r=i[a])&&(yield r)}};const Gg=Wg;var Kg={value:()=>{}};function Qg(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new Yg(r)}function Yg(e){this._=e}function Xg(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function Jg(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Kg,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}Yg.prototype=Qg.prototype={constructor:Yg,on:function(e,t){var n,r,i=this._,a=(r=i,(e+"").trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");if(n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),e&&!r.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:t}}))),s=-1,o=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!==typeof t)throw new Error("invalid callback: "+t);for(;++s<o;)if(n=(e=a[s]).type)i[n]=Jg(i[n],e.name,t);else if(null==t)for(n in i)i[n]=Jg(i[n],e.name,null);return this}for(;++s<o;)if((n=(e=a[s]).type)&&(n=Xg(i[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Yg(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=0,n=(r=this._[e]).length;a<n;++a)r[a].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};const $g=Qg;var Zg,ev,tv=0,nv=0,rv=0,iv=0,av=0,sv=0,ov="object"===typeof performance&&performance.now?performance:Date,lv="object"===typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function cv(){return av||(lv(uv),av=ov.now()+sv)}function uv(){av=0}function hv(){this._call=this._time=this._next=null}function dv(e,t,n){var r=new hv;return r.restart(e,t,n),r}function fv(){av=(iv=ov.now())+sv,tv=nv=0;try{!function(){cv(),++tv;for(var e,t=Zg;t;)(e=av-t._time)>=0&&t._call.call(void 0,e),t=t._next;--tv}()}finally{tv=0,function(){var e,t,n=Zg,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Zg=t);ev=e,mv(r)}(),av=0}}function pv(){var e=ov.now(),t=e-iv;t>1e3&&(sv-=t,iv=e)}function mv(e){tv||(nv&&(nv=clearTimeout(nv)),e-av>24?(e<1/0&&(nv=setTimeout(fv,e-ov.now()-sv)),rv&&(rv=clearInterval(rv))):(rv||(iv=ov.now(),rv=setInterval(pv,1e3)),tv=1,lv(fv)))}function gv(e,t,n){var r=new hv;return t=null==t?0:+t,r.restart((n=>{r.stop(),e(n+t)}),t,n),r}hv.prototype=dv.prototype={constructor:hv,restart:function(e,t,n){if("function"!==typeof e)throw new TypeError("callback is not a function");n=(null==n?cv():+n)+(null==t?0:+t),this._next||ev===this||(ev?ev._next=this:Zg=this,ev=this),this._call=e,this._time=n,mv()},stop:function(){this._call&&(this._call=null,this._time=1/0,mv())}};var vv=$g("start","end","cancel","interrupt"),yv=[];function bv(e,t,n,r,i,a){var s=e.__transition;if(s){if(n in s)return}else e.__transition={};!function(e,t,n){var r,i=e.__transition;function a(e){n.state=1,n.timer.restart(s,n.delay,n.time),n.delay<=e&&s(e-n.delay)}function s(a){var c,u,h,d;if(1!==n.state)return l();for(c in i)if((d=i[c]).name===n.name){if(3===d.state)return gv(s);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",e,e.__data__,d.index,d.group),delete i[c]):+c<t&&(d.state=6,d.timer.stop(),d.on.call("cancel",e,e.__data__,d.index,d.group),delete i[c])}if(gv((function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(a))})),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(e,e.__data__,n.index,n.group))&&(r[++u]=d);r.length=u+1}}function o(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(l),n.state=5,1),a=-1,s=r.length;++a<s;)r[a].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){for(var r in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=dv(a,0,n.time)}(e,n,{name:t,index:r,group:i,on:vv,tween:yv,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function wv(e,t){var n=xv(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function _v(e,t){var n=xv(e,t);if(n.state>3)throw new Error("too late; already running");return n}function xv(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Sv(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var kv,Ev=180/Math.PI,Cv={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Nv(e,t,n,r,i,a){var s,o,l;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,s=-s),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*Ev,skewX:Math.atan(l)*Ev,scaleX:s,scaleY:o}}function Tv(e,t,n,r){function i(e){return e.length?e.pop()+" ":""}return function(a,s){var o=[],l=[];return a=e(a),s=e(s),function(e,r,i,a,s,o){if(e!==i||r!==a){var l=s.push("translate(",null,t,null,n);o.push({i:l-4,x:Sv(e,i)},{i:l-2,x:Sv(r,a)})}else(i||a)&&s.push("translate("+i+t+a+n)}(a.translateX,a.translateY,s.translateX,s.translateY,o,l),function(e,t,n,a){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:Sv(e,t)})):t&&n.push(i(n)+"rotate("+t+r)}(a.rotate,s.rotate,o,l),function(e,t,n,a){e!==t?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:Sv(e,t)}):t&&n.push(i(n)+"skewX("+t+r)}(a.skewX,s.skewX,o,l),function(e,t,n,r,a,s){if(e!==n||t!==r){var o=a.push(i(a)+"scale(",null,",",null,")");s.push({i:o-4,x:Sv(e,n)},{i:o-2,x:Sv(t,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,s.scaleX,s.scaleY,o,l),a=s=null,function(e){for(var t,n=-1,r=l.length;++n<r;)o[(t=l[n]).i]=t.x(e);return o.join("")}}}var Iv=Tv((function(e){const t=new("function"===typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Cv:Nv(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),Av=Tv((function(e){return null==e?Cv:(kv||(kv=document.createElementNS("http://www.w3.org/2000/svg","g")),kv.setAttribute("transform",e),(e=kv.transform.baseVal.consolidate())?Nv((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):Cv)}),", ",")",")");function jv(e,t){var n,r;return function(){var i=_v(this,e),a=i.tween;if(a!==n)for(var s=0,o=(r=n=a).length;s<o;++s)if(r[s].name===t){(r=r.slice()).splice(s,1);break}i.tween=r}}function Dv(e,t,n){var r,i;if("function"!==typeof n)throw new Error;return function(){var a=_v(this,e),s=a.tween;if(s!==r){i=(r=s).slice();for(var o={name:t,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===t){i[l]=o;break}l===c&&i.push(o)}a.tween=i}}function Pv(e,t,n){var r=e._id;return e.each((function(){var e=_v(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)})),function(e){return xv(e,r).value[t]}}function Rv(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ov(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Lv(){}var Mv=.7,Fv=1/Mv,Uv="\\s*([+-]?\\d+)\\s*",Vv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Bv=/^#([0-9a-f]{3,8})$/,qv=new RegExp("^rgb\\(".concat(Uv,",").concat(Uv,",").concat(Uv,"\\)$")),Hv=new RegExp("^rgb\\(".concat(zv,",").concat(zv,",").concat(zv,"\\)$")),Wv=new RegExp("^rgba\\(".concat(Uv,",").concat(Uv,",").concat(Uv,",").concat(Vv,"\\)$")),Gv=new RegExp("^rgba\\(".concat(zv,",").concat(zv,",").concat(zv,",").concat(Vv,"\\)$")),Kv=new RegExp("^hsl\\(".concat(Vv,",").concat(zv,",").concat(zv,"\\)$")),Qv=new RegExp("^hsla\\(".concat(Vv,",").concat(zv,",").concat(zv,",").concat(Vv,"\\)$")),Yv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Xv(){return this.rgb().formatHex()}function Jv(){return this.rgb().formatRgb()}function $v(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Bv.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Zv(t):3===n?new ny(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?ey(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?ey(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=qv.exec(e))?new ny(t[1],t[2],t[3],1):(t=Hv.exec(e))?new ny(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Wv.exec(e))?ey(t[1],t[2],t[3],t[4]):(t=Gv.exec(e))?ey(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Kv.exec(e))?ly(t[1],t[2]/100,t[3]/100,1):(t=Qv.exec(e))?ly(t[1],t[2]/100,t[3]/100,t[4]):Yv.hasOwnProperty(e)?Zv(Yv[e]):"transparent"===e?new ny(NaN,NaN,NaN,0):null}function Zv(e){return new ny(e>>16&255,e>>8&255,255&e,1)}function ey(e,t,n,r){return r<=0&&(e=t=n=NaN),new ny(e,t,n,r)}function ty(e,t,n,r){return 1===arguments.length?((i=e)instanceof Lv||(i=$v(i)),i?new ny((i=i.rgb()).r,i.g,i.b,i.opacity):new ny):new ny(e,t,n,null==r?1:r);var i}function ny(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function ry(){return"#".concat(oy(this.r)).concat(oy(this.g)).concat(oy(this.b))}function iy(){const e=ay(this.opacity);return"".concat(1===e?"rgb(":"rgba(").concat(sy(this.r),", ").concat(sy(this.g),", ").concat(sy(this.b)).concat(1===e?")":", ".concat(e,")"))}function ay(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function sy(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function oy(e){return((e=sy(e))<16?"0":"")+e.toString(16)}function ly(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new uy(e,t,n,r)}function cy(e){if(e instanceof uy)return new uy(e.h,e.s,e.l,e.opacity);if(e instanceof Lv||(e=$v(e)),!e)return new uy;if(e instanceof uy)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),s=NaN,o=a-i,l=(a+i)/2;return o?(s=t===a?(n-r)/o+6*(n<r):n===a?(r-t)/o+2:(t-n)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new uy(s,o,l,e.opacity)}function uy(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function hy(e){return(e=(e||0)%360)<0?e+360:e}function dy(e){return Math.max(0,Math.min(1,e||0))}function fy(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function py(e,t,n,r,i){var a=e*e,s=a*e;return((1-3*e+3*a-s)*t+(4-6*a+3*s)*n+(1+3*e+3*a-3*s)*r+s*i)/6}Rv(Lv,$v,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Xv,formatHex:Xv,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return cy(this).formatHsl()},formatRgb:Jv,toString:Jv}),Rv(ny,ty,Ov(Lv,{brighter(e){return e=null==e?Fv:Math.pow(Fv,e),new ny(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?Mv:Math.pow(Mv,e),new ny(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ny(sy(this.r),sy(this.g),sy(this.b),ay(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ry,formatHex:ry,formatHex8:function(){return"#".concat(oy(this.r)).concat(oy(this.g)).concat(oy(this.b)).concat(oy(255*(isNaN(this.opacity)?1:this.opacity)))},formatRgb:iy,toString:iy})),Rv(uy,(function(e,t,n,r){return 1===arguments.length?cy(e):new uy(e,t,n,null==r?1:r)}),Ov(Lv,{brighter(e){return e=null==e?Fv:Math.pow(Fv,e),new uy(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?Mv:Math.pow(Mv,e),new uy(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new ny(fy(e>=240?e-240:e+120,i,r),fy(e,i,r),fy(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new uy(hy(this.h),dy(this.s),dy(this.l),ay(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ay(this.opacity);return"".concat(1===e?"hsl(":"hsla(").concat(hy(this.h),", ").concat(100*dy(this.s),"%, ").concat(100*dy(this.l),"%").concat(1===e?")":", ".concat(e,")"))}}));const my=e=>()=>e;function gy(e,t){return function(n){return e+n*t}}function vy(e){return 1===(e=+e)?yy:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):my(isNaN(t)?n:t)}}function yy(e,t){var n=t-e;return n?gy(e,n):my(isNaN(e)?t:e)}const by=function e(t){var n=vy(t);function r(e,t){var r=n((e=ty(e)).r,(t=ty(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),s=yy(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=s(t),e+""}}return r.gamma=e,r}(1);function wy(e){return function(t){var n,r,i=t.length,a=new Array(i),s=new Array(i),o=new Array(i);for(n=0;n<i;++n)r=ty(t[n]),a[n]=r.r||0,s[n]=r.g||0,o[n]=r.b||0;return a=e(a),s=e(s),o=e(o),r.opacity=1,function(e){return r.r=a(e),r.g=s(e),r.b=o(e),r+""}}}wy((function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],s=r>0?e[r-1]:2*i-a,o=r<t-1?e[r+2]:2*a-i;return py((n-r/t)*t,s,i,a,o)}})),wy((function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],s=e[(r+1)%t],o=e[(r+2)%t];return py((n-r/t)*t,i,a,s,o)}}));var _y=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xy=new RegExp(_y.source,"g");function Sy(e,t){var n,r,i,a=_y.lastIndex=xy.lastIndex=0,s=-1,o=[],l=[];for(e+="",t+="";(n=_y.exec(e))&&(r=xy.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(r=r[0])?o[s]?o[s]+=r:o[++s]=r:(o[++s]=null,l.push({i:s,x:Sv(n,r)})),a=xy.lastIndex;return a<t.length&&(i=t.slice(a),o[s]?o[s]+=i:o[++s]=i),o.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var n,r=0;r<t;++r)o[(n=l[r]).i]=n.x(e);return o.join("")})}function ky(e,t){var n;return("number"===typeof t?Sv:t instanceof $v?by:(n=$v(t))?(t=n,by):Sy)(e,t)}function Ey(e){return function(){this.removeAttribute(e)}}function Cy(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ny(e,t,n){var r,i,a=n+"";return function(){var s=this.getAttribute(e);return s===a?null:s===r?i:i=t(r=s,n)}}function Ty(e,t,n){var r,i,a=n+"";return function(){var s=this.getAttributeNS(e.space,e.local);return s===a?null:s===r?i:i=t(r=s,n)}}function Iy(e,t,n){var r,i,a;return function(){var s,o,l=n(this);if(null!=l)return(s=this.getAttribute(e))===(o=l+"")?null:s===r&&o===i?a:(i=o,a=t(r=s,l));this.removeAttribute(e)}}function Ay(e,t,n){var r,i,a;return function(){var s,o,l=n(this);if(null!=l)return(s=this.getAttributeNS(e.space,e.local))===(o=l+"")?null:s===r&&o===i?a:(i=o,a=t(r=s,l));this.removeAttributeNS(e.space,e.local)}}function jy(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}(e,i)),n}return i._value=t,i}function Dy(e,t){var n,r;function i(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&function(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}(e,i)),n}return i._value=t,i}function Py(e,t){return function(){wv(this,e).delay=+t.apply(this,arguments)}}function Ry(e,t){return t=+t,function(){wv(this,e).delay=t}}function Oy(e,t){return function(){_v(this,e).duration=+t.apply(this,arguments)}}function Ly(e,t){return t=+t,function(){_v(this,e).duration=t}}var My=Gg.prototype.constructor;function Fy(e){return function(){this.style.removeProperty(e)}}var Uy=0;function Vy(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function zy(){return++Uy}var By=Gg.prototype;Vy.prototype=function(e){return Gg().transition(e)}.prototype={constructor:Vy,select:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=Om(e));for(var r=this._groups,i=r.length,a=new Array(i),s=0;s<i;++s)for(var o,l,c=r[s],u=c.length,h=a[s]=new Array(u),d=0;d<u;++d)(o=c[d])&&(l=e.call(o,o.__data__,d,c))&&("__data__"in o&&(l.__data__=o.__data__),h[d]=l,bv(h[d],t,n,d,h,xv(o,n)));return new Vy(a,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!==typeof e&&(e=Mm(e));for(var r=this._groups,i=r.length,a=[],s=[],o=0;o<i;++o)for(var l,c=r[o],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,f=e.call(l,l.__data__,h,c),p=xv(l,n),m=0,g=f.length;m<g;++m)(d=f[m])&&bv(d,t,n,m,f,p);a.push(f),s.push(l)}return new Vy(a,s,t,n)},selectChild:By.selectChild,selectChildren:By.selectChildren,filter:function(e){"function"!==typeof e&&(e=Um(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,s=t[i],o=s.length,l=r[i]=[],c=0;c<o;++c)(a=s[c])&&e.call(a,a.__data__,c,s)&&l.push(a);return new Vy(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),s=new Array(r),o=0;o<a;++o)for(var l,c=t[o],u=n[o],h=c.length,d=s[o]=new Array(h),f=0;f<h;++f)(l=c[f]||u[f])&&(d[f]=l);for(;o<r;++o)s[o]=t[o];return new Vy(s,this._parents,this._name,this._id)},selection:function(){return new My(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=zy(),r=this._groups,i=r.length,a=0;a<i;++a)for(var s,o=r[a],l=o.length,c=0;c<l;++c)if(s=o[c]){var u=xv(s,t);bv(s,e,n,c,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Vy(r,this._parents,e,n)},call:By.call,nodes:By.nodes,node:By.node,size:By.size,empty:By.empty,each:By.each,on:function(e,t){var n=this._id;return arguments.length<2?xv(this.node(),n).on.on(e):this.each(function(e,t,n){var r,i,a=function(e){return(e+"").trim().split(/^|\s+/).every((function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e}))}(t)?wv:_v;return function(){var s=a(this,e),o=s.on;o!==r&&(i=(r=o).copy()).on(t,n),s.on=i}}(n,e,t))},attr:function(e,t){var n=eg(e),r="transform"===n?Av:ky;return this.attrTween(e,"function"===typeof t?(n.local?Ay:Iy)(n,r,Pv(this,"attr."+e,t)):null==t?(n.local?Cy:Ey)(n):(n.local?Ty:Ny)(n,r,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!==typeof t)throw new Error;var r=eg(e);return this.tween(n,(r.local?jy:Dy)(r,t))},style:function(e,t,n){var r="transform"===(e+="")?Iv:ky;return null==t?this.styleTween(e,function(e,t){var n,r,i;return function(){var a=hg(this,e),s=(this.style.removeProperty(e),hg(this,e));return a===s?null:a===n&&s===r?i:i=t(n=a,r=s)}}(e,r)).on("end.style."+e,Fy(e)):"function"===typeof t?this.styleTween(e,function(e,t,n){var r,i,a;return function(){var s=hg(this,e),o=n(this),l=o+"";return null==o&&(this.style.removeProperty(e),l=o=hg(this,e)),s===l?null:s===r&&l===i?a:(i=l,a=t(r=s,o))}}(e,r,Pv(this,"style."+e,t))).each(function(e,t){var n,r,i,a,s="style."+t,o="end."+s;return function(){var l=_v(this,e),c=l.on,u=null==l.value[s]?a||(a=Fy(t)):void 0;c===n&&i===u||(r=(n=c).copy()).on(o,i=u),l.on=r}}(this._id,e)):this.styleTween(e,function(e,t,n){var r,i,a=n+"";return function(){var s=hg(this,e);return s===a?null:s===r?i:i=t(r=s,n)}}(e,r,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!==typeof t)throw new Error;return this.tween(r,function(e,t,n){var r,i;function a(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&function(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}(e,a,n)),r}return a._value=t,a}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"===typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(Pv(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!==typeof e)throw new Error;return this.tween(t,function(e){var t,n;function r(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&function(e){return function(t){this.textContent=e.call(this,t)}}(r)),t}return r._value=e,r}(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=xv(this.node(),n).tween,a=0,s=i.length;a<s;++a)if((r=i[a]).name===e)return r.value;return null}return this.each((null==t?jv:Dv)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?Py:Ry)(t,e)):xv(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"===typeof e?Oy:Ly)(t,e)):xv(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function(e,t){if("function"!==typeof t)throw new Error;return function(){_v(this,e).ease=t}}(t,e)):xv(this.node(),t).ease},easeVarying:function(e){if("function"!==typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!==typeof n)throw new Error;_v(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,r=n._id,i=n.size();return new Promise((function(a,s){var o={value:s},l={value:function(){0===--i&&a()}};n.each((function(){var n=_v(this,r),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(o),t._.interrupt.push(o),t._.end.push(l)),n.on=t})),0===i&&a()}))},[Symbol.iterator]:By[Symbol.iterator]};var qy={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function Hy(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error("transition ".concat(t," not found"));return n}Gg.prototype.interrupt=function(e){return this.each((function(){!function(e,t){var n,r,i,a=e.__transition,s=!0;if(a){for(i in t=null==t?null:t+"",a)(n=a[i]).name===t?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete a[i]):s=!1;s&&delete e.__transition}}(this,e)}))},Gg.prototype.transition=function(e){var t,n;e instanceof Vy?(t=e._id,e=e._name):(t=zy(),(n=qy).time=cv(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var s,o=r[a],l=o.length,c=0;c<l;++c)(s=o[c])&&bv(s,e,t,c,o,n||Hy(s,t));return new Vy(r,this._parents,e,t)};const{abs:Wy,max:Gy,min:Ky}=Math;function Qy(e){return[+e[0],+e[1]]}function Yy(e){return[Qy(e[0]),Qy(e[1])]}["w","e"].map(Xy),["n","s"].map(Xy),["n","w","e","s","nw","ne","sw","se"].map(Xy);function Xy(e){return{type:e}}function Jy(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}const $y=Symbol("implicit");function Zy(){var e=new pm,t=[],n=[],r=$y;function i(i){let a=e.get(i);if(void 0===a){if(r!==$y)return r;e.set(i,a=t.push(i)-1)}return n[a%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new pm;for(const r of n)e.has(r)||e.set(r,t.push(r)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return Zy(t,n).unknown(r)},Jy.apply(i,arguments),i}function eb(){var e,t,n=Zy().unknown(void 0),r=n.domain,i=n.range,a=0,s=1,o=!1,l=0,c=0,u=.5;function h(){var n=r().length,h=s<a,d=h?s:a,f=h?a:s;e=(f-d)/Math.max(1,n-l+2*c),o&&(e=Math.floor(e)),d+=(f-d-e*(n-l))*u,t=e*(1-l),o&&(d=Math.round(d),t=Math.round(t));var p=function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),a=new Array(i);++r<i;)a[r]=e+r*n;return a}(n).map((function(t){return d+e*t}));return i(h?p.reverse():p)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),h()):r()},n.range=function(e){return arguments.length?([a,s]=e,a=+a,s=+s,h()):[a,s]},n.rangeRound=function(e){return[a,s]=e,a=+a,s=+s,o=!0,h()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(o=!!e,h()):o},n.padding=function(e){return arguments.length?(l=Math.min(1,c=+e),h()):l},n.paddingInner=function(e){return arguments.length?(l=Math.min(1,e),h()):l},n.paddingOuter=function(e){return arguments.length?(c=+e,h()):c},n.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),h()):u},n.copy=function(){return eb(r(),[a,s]).round(o).paddingInner(l).paddingOuter(c).align(u)},Jy.apply(h(),arguments)}const tb=Math.sqrt(50),nb=Math.sqrt(10),rb=Math.sqrt(2);function ib(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),s=a>=tb?10:a>=nb?5:a>=rb?2:1;let o,l,c;return i<0?(c=Math.pow(10,-i)/s,o=Math.round(e*c),l=Math.round(t*c),o/c<e&&++o,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*s,o=Math.round(e/c),l=Math.round(t/c),o*c<e&&++o,l*c>t&&--l),l<o&&.5<=n&&n<2?ib(e,t,2*n):[o,l,c]}function ab(e,t,n){return ib(e=+e,t=+t,n=+n)[2]}function sb(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ob(e,t){return null==e||null==t?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function lb(e){let t,n,r;function i(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<a){if(0!==t(r,r))return a;do{const t=i+a>>>1;n(e[t],r)<0?i=t+1:a=t}while(i<a)}return i}return 2!==e.length?(t=sb,n=(t,n)=>sb(e(t),n),r=(t,n)=>e(t)-n):(t=e===sb||e===ob?e:cb,n=e,r=e),{left:i,center:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const a=i(e,t,n,(arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length)-1);return a>n&&r(e[a-1],t)>-r(e[a],t)?a-1:a},right:function(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(i<a){if(0!==t(r,r))return a;do{const t=i+a>>>1;n(e[t],r)<=0?i=t+1:a=t}while(i<a)}return i}}}function cb(){return 0}const ub=lb(sb),hb=ub.right,db=(ub.left,lb((function(e){return null===e?NaN:+e})).center,hb);function fb(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,a=new Array(i),s=new Array(r);for(n=0;n<i;++n)a[n]=vb(e[n],t[n]);for(;n<r;++n)s[n]=t[n];return function(e){for(n=0;n<i;++n)s[n]=a[n](e);return s}}function pb(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function mb(e,t){var n,r={},i={};for(n in null!==e&&"object"===typeof e||(e={}),null!==t&&"object"===typeof t||(t={}),t)n in e?r[n]=vb(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}function gb(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,i=t.slice();return function(a){for(n=0;n<r;++n)i[n]=e[n]*(1-a)+t[n]*a;return i}}function vb(e,t){var n,r=typeof t;return null==t||"boolean"===r?my(t):("number"===r?Sv:"string"===r?(n=$v(t))?(t=n,by):Sy:t instanceof $v?by:t instanceof Date?pb:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(t)?gb:Array.isArray(t)?fb:"function"!==typeof t.valueOf&&"function"!==typeof t.toString||isNaN(t)?mb:Sv)(e,t)}function yb(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function bb(e){return+e}var wb=[0,1];function _b(e){return e}function xb(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:function(e){return function(){return e}}(isNaN(t)?NaN:.5)}function Sb(e,t,n){var r=e[0],i=e[1],a=t[0],s=t[1];return i<r?(r=xb(i,r),a=n(s,a)):(r=xb(r,i),a=n(a,s)),function(e){return a(r(e))}}function kb(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),a=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<r;)i[s]=xb(e[s],e[s+1]),a[s]=n(t[s],t[s+1]);return function(t){var n=db(e,t,1,r)-1;return a[n](i[n](t))}}function Eb(){var e,t,n,r,i,a,s=wb,o=wb,l=vb,c=_b;function u(){var e=Math.min(s.length,o.length);return c!==_b&&(c=function(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}(s[0],s[e-1])),r=e>2?kb:Sb,i=a=null,h}function h(t){return null==t||isNaN(t=+t)?n:(i||(i=r(s.map(e),o,l)))(e(c(t)))}return h.invert=function(n){return c(t((a||(a=r(o,s.map(e),Sv)))(n)))},h.domain=function(e){return arguments.length?(s=Array.from(e,bb),u()):s.slice()},h.range=function(e){return arguments.length?(o=Array.from(e),u()):o.slice()},h.rangeRound=function(e){return o=Array.from(e),l=yb,u()},h.clamp=function(e){return arguments.length?(c=!!e||_b,u()):c!==_b},h.interpolate=function(e){return arguments.length?(l=e,u()):l},h.unknown=function(e){return arguments.length?(n=e,h):n},function(n,r){return e=n,t=r,u()}}var Cb,Nb=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Tb(e){if(!(t=Nb.exec(e)))throw new Error("invalid format: "+e);var t;return new Ib({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function Ib(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Ab(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function jb(e){return(e=Ab(Math.abs(e)))?e[1]:NaN}function Db(e,t){var n=Ab(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}Tb.prototype=Ib.prototype,Ib.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Pb={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Db(100*e,t),r:Db,s:function(e,t){var n=Ab(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(Cb=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return a===s?r:a>s?r+new Array(a-s+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Ab(e,Math.max(0,t+a-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Rb(e){return e}var Ob,Lb,Mb,Fb=Array.prototype.map,Ub=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Vb(e){var t,n,r=void 0===e.grouping||void 0===e.thousands?Rb:(t=Fb.call(e.grouping,Number),n=e.thousands+"",function(e,r){for(var i=e.length,a=[],s=0,o=t[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),a.push(e.substring(i-=o,i+o)),!((l+=o+1)>r));)o=t[s=(s+1)%t.length];return a.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",a=void 0===e.currency?"":e.currency[1]+"",s=void 0===e.decimal?".":e.decimal+"",o=void 0===e.numerals?Rb:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(Fb.call(e.numerals,String)),l=void 0===e.percent?"%":e.percent+"",c=void 0===e.minus?"\u2212":e.minus+"",u=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=Tb(e)).fill,n=e.align,h=e.sign,d=e.symbol,f=e.zero,p=e.width,m=e.comma,g=e.precision,v=e.trim,y=e.type;"n"===y?(m=!0,y="g"):Pb[y]||(void 0===g&&(g=12),v=!0,y="g"),(f||"0"===t&&"="===n)&&(f=!0,t="0",n="=");var b="$"===d?i:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",w="$"===d?a:/[%p]/.test(y)?l:"",_=Pb[y],x=/[defgprs%]/.test(y);function S(e){var i,a,l,d=b,S=w;if("c"===y)S=_(e)+S,e="";else{var k=(e=+e)<0||1/e<0;if(e=isNaN(e)?u:_(Math.abs(e),g),v&&(e=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(!+e[r])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),k&&0===+e&&"+"!==h&&(k=!1),d=(k?"("===h?h:c:"-"===h||"("===h?"":h)+d,S=("s"===y?Ub[8+Cb/3]:"")+S+(k&&"("===h?")":""),x)for(i=-1,a=e.length;++i<a;)if(48>(l=e.charCodeAt(i))||l>57){S=(46===l?s+e.slice(i+1):e.slice(i))+S,e=e.slice(0,i);break}}m&&!f&&(e=r(e,1/0));var E=d.length+e.length+S.length,C=E<p?new Array(p-E+1).join(t):"";switch(m&&f&&(e=r(C+e,C.length?p-S.length:1/0),C=""),n){case"<":e=d+e+S+C;break;case"=":e=d+C+e+S;break;case"^":e=C.slice(0,E=C.length>>1)+d+e+S+C.slice(E);break;default:e=C+d+e+S}return o(e)}return g=void 0===g?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),S.toString=function(){return e+""},S}return{format:h,formatPrefix:function(e,t){var n=h(((e=Tb(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(jb(t)/3))),i=Math.pow(10,-r),a=Ub[8+r/3];return function(e){return n(i*e)+a}}}}function zb(e,t,n,r){var i,a=function(e,t,n){n=+n;const r=(t=+t)<(e=+e),i=r?ab(t,e,n):ab(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}(e,t,n);switch((r=Tb(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(e),Math.abs(t));return null!=r.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(jb(t)/3)))-jb(Math.abs(e)))}(a,s))||(r.precision=i),Mb(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,jb(t)-jb(e))+1}(a,Math.max(Math.abs(e),Math.abs(t))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=function(e){return Math.max(0,-jb(Math.abs(e)))}(a))||(r.precision=i-2*("%"===r.type))}return Lb(r)}function Bb(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){if(!((n=+n)>0))return[];if((e=+e)===(t=+t))return[e];const r=t<e,[i,a,s]=r?ib(t,e,n):ib(e,t,n);if(!(a>=i))return[];const o=a-i+1,l=new Array(o);if(r)if(s<0)for(let c=0;c<o;++c)l[c]=(a-c)/-s;else for(let c=0;c<o;++c)l[c]=(a-c)*s;else if(s<0)for(let c=0;c<o;++c)l[c]=(i+c)/-s;else for(let c=0;c<o;++c)l[c]=(i+c)*s;return l}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return zb(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var r,i,a=t(),s=0,o=a.length-1,l=a[s],c=a[o],u=10;for(c<l&&(i=l,l=c,c=i,i=s,s=o,o=i);u-- >0;){if((i=ab(l,c,n))===r)return a[s]=l,a[o]=c,t(a);if(i>0)l=Math.floor(l/i)*i,c=Math.ceil(c/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,c=Math.floor(c*i)/i}r=i}return e},e}function qb(){var e=Eb()(_b,_b);return e.copy=function(){return t=e,qb().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown());var t},Jy.apply(e,arguments),Bb(e)}function Hb(e){return"string"===typeof e?new Hg([[document.querySelector(e)]],[document.documentElement]):new Hg([[e]],qg)}Ob=Vb({thousands:",",grouping:[3],currency:["$",""]}),Lb=Ob.format,Mb=Ob.formatPrefix;var Wb,Gb,Kb,Qb,Yb,Xb,Jb,$b,Zb,ew,tw,nw,rw,iw;Array.prototype.slice;function aw(e){return function(){return e}}function sw(e){this._context=e}function ow(e){return new sw(e)}function lw(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}sw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};const cw=Math.PI,uw=2*cw,hw=1e-6,dw=uw-hw;function fw(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class pw{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?fw:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error("invalid digits: ".concat(e));if(t>15)return fw;const n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append(Wb||(Wb=lw(["M",",",""])),this._x0=this._x1=+e,this._y0=this._y1=+t)}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append(Gb||(Gb=lw(["Z"]))))}lineTo(e,t){this._append(Kb||(Kb=lw(["L",",",""])),this._x1=+e,this._y1=+t)}quadraticCurveTo(e,t,n,r){this._append(Qb||(Qb=lw(["Q",",",",",",",""])),+e,+t,this._x1=+n,this._y1=+r)}bezierCurveTo(e,t,n,r,i,a){this._append(Yb||(Yb=lw(["C",",",",",",",",",",",""])),+e,+t,+n,+r,this._x1=+i,this._y1=+a)}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,(i=+i)<0)throw new Error("negative radius: ".concat(i));let a=this._x1,s=this._y1,o=n-e,l=r-t,c=a-e,u=s-t,h=c*c+u*u;if(null===this._x1)this._append(Xb||(Xb=lw(["M",",",""])),this._x1=e,this._y1=t);else if(h>hw)if(Math.abs(u*o-l*c)>hw&&i){let d=n-a,f=r-s,p=o*o+l*l,m=d*d+f*f,g=Math.sqrt(p),v=Math.sqrt(h),y=i*Math.tan((cw-Math.acos((p+h-m)/(2*g*v)))/2),b=y/v,w=y/g;Math.abs(b-1)>hw&&this._append($b||($b=lw(["L",",",""])),e+b*c,t+b*u),this._append(Zb||(Zb=lw(["A",",",",0,0,",",",",",""])),i,i,+(u*d>c*f),this._x1=e+w*o,this._y1=t+w*l)}else this._append(Jb||(Jb=lw(["L",",",""])),this._x1=e,this._y1=t);else;}arc(e,t,n,r,i,a){if(e=+e,t=+t,a=!!a,(n=+n)<0)throw new Error("negative radius: ".concat(n));let s=n*Math.cos(r),o=n*Math.sin(r),l=e+s,c=t+o,u=1^a,h=a?r-i:i-r;null===this._x1?this._append(ew||(ew=lw(["M",",",""])),l,c):(Math.abs(this._x1-l)>hw||Math.abs(this._y1-c)>hw)&&this._append(tw||(tw=lw(["L",",",""])),l,c),n&&(h<0&&(h=h%uw+uw),h>dw?this._append(nw||(nw=lw(["A",",",",0,1,",",",",","A",",",",0,1,",",",",",""])),n,n,u,e-s,t-o,n,n,u,this._x1=l,this._y1=c):h>hw&&this._append(rw||(rw=lw(["A",",",",0,",",",",",",",""])),n,n,+(h>=cw),u,this._x1=e+n*Math.cos(i),this._y1=t+n*Math.sin(i)))}rect(e,t,n,r){this._append(iw||(iw=lw(["M",",","h","v","h","Z"])),this._x0=this._x1=+e,this._y0=this._y1=+t,n=+n,+r,-n)}toString(){return this._}}function mw(e){return e[0]}function gw(e){return e[1]}function vw(e,t){var n=aw(!0),r=null,i=ow,a=null,s=function(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError("invalid digits: ".concat(n));t=e}return e},()=>new pw(t)}(o);function o(o){var l,c,u,h=(o=function(e){return"object"===typeof e&&"length"in e?e:Array.from(e)}(o)).length,d=!1;for(null==r&&(a=i(u=s())),l=0;l<=h;++l)!(l<h&&n(c=o[l],l,o))===d&&((d=!d)?a.lineStart():a.lineEnd()),d&&a.point(+e(c,l,o),+t(c,l,o));if(u)return a=null,u+""||null}return e="function"===typeof e?e:void 0===e?mw:aw(e),t="function"===typeof t?t:void 0===t?gw:aw(t),o.x=function(t){return arguments.length?(e="function"===typeof t?t:aw(+t),o):e},o.y=function(e){return arguments.length?(t="function"===typeof e?e:aw(+e),o):t},o.defined=function(e){return arguments.length?(n="function"===typeof e?e:aw(!!e),o):n},o.curve=function(e){return arguments.length?(i=e,null!=r&&(a=i(r)),o):i},o.context=function(e){return arguments.length?(null==e?r=a=null:a=i(r=e),o):r},o}function yw(e){return e<0?-1:1}function bw(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),s=(n-e._y1)/(i||r<0&&-0),o=(a*i+s*r)/(r+i);return(yw(a)+yw(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(o))||0}function ww(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function _w(e,t,n){var r=e._x0,i=e._y0,a=e._x1,s=e._y1,o=(a-r)/3;e._context.bezierCurveTo(r+o,i+o*t,a-o,s-o*n,a,s)}function xw(e){this._context=e}function Sw(e){this._context=new kw(e)}function kw(e){this._context=e}function Ew(e){return new xw(e)}function Cw(e,t,n){this.k=e,this.x=t,this.y=n}xw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:_w(this,this._t0,ww(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,_w(this,ww(this,n=bw(this,e,t)),n);break;default:_w(this,this._t0,n=bw(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Sw.prototype=Object.create(xw.prototype)).point=function(e,t){xw.prototype.point.call(this,t,e)},kw.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}},Cw.prototype={constructor:Cw,scale:function(e){return 1===e?this:new Cw(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new Cw(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};new Cw(1,0,0);Cw.prototype;const Nw=function(){var e;const t=ee(),[n,r]=(0,i.useState)(null),[a,s]=(0,i.useState)(!0),o=(0,i.useRef)(null),l=(0,i.useCallback)((async()=>{try{const e=localStorage.getItem("userData");if(!e)return void t("/login");const n=JSON.parse(e);if(n.id){const e=Qf(am,"users",n.id),t=await Yp(e);t.exists()?r(Le({id:n.id},t.data())):r(n)}else r(n)}catch(e){console.error("Error checking authentication:",e),t("/login")}finally{s(!1)}}),[t]);(0,i.useEffect)((()=>{l()}),[l]),(0,i.useEffect)((()=>{if(!o.current||a||null===n)return;o.current.innerHTML="",c();const e=()=>{o.current&&(o.current.innerHTML="",c())};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[a,n]);const c=()=>{const e=20,t=20,n=30,r=40,i=o.current.clientWidth-r-t,a=200-e-n,s=Hb(o.current).append("svg").attr("width",i+r+t).attr("height",a+e+n).append("g").attr("transform","translate(".concat(r,", ").concat(e,")")),l=["8AM","10AM","12PM","2PM","4PM","6PM","8PM"],c=[{hour:"8AM",value:90,actual:!0},{hour:"10AM",value:78,actual:!0},{hour:"12PM",value:62,actual:!1},{hour:"2PM",value:75,actual:!1},{hour:"4PM",value:68,actual:!1},{hour:"6PM",value:55,actual:!1},{hour:"8PM",value:40,actual:!1}],u=eb().range([0,i]).domain(l).padding(.2);s.append("g").attr("transform","translate(0, ".concat(a,")")).call(Dm(u));const h=qb().domain([0,100]).range([a,0]);s.append("g").call(Pm(h));const d=vw().x((e=>u(e.hour)+u.bandwidth()/2)).y((e=>h(e.value))).curve(Ew);s.append("path").datum(c).attr("fill","none").attr("stroke","#4299e1").attr("stroke-width",3).attr("d",d),s.selectAll(".dot").data(c).enter().append("circle").attr("class","dot").attr("cx",(e=>u(e.hour)+u.bandwidth()/2)).attr("cy",(e=>h(e.value))).attr("r",5).attr("fill",(e=>e.actual?"#4299e1":"#E2E8F0")).attr("stroke","#4299e1").attr("stroke-width",2);const f=(new Date).getHours();let p=Math.floor((f-8)/2);if(p>=0&&p<l.length-1){const e=u(l[p])+u.bandwidth()/2,t=e+f%2/2*(u(l[p+1])+u.bandwidth()/2-e);s.append("line").attr("x1",t).attr("x2",t).attr("y1",0).attr("y2",a).attr("stroke","#FC8181").attr("stroke-width",2).attr("stroke-dasharray","5,5"),s.append("text").attr("x",t).attr("y",10).attr("text-anchor","middle").style("font-size","10px").style("fill","#FC8181").text("Now")}},u=()=>{t("/fitbit-dashboard")},h="fitbit"===(null===n||void 0===n?void 0:n.selectedDevice)&&!0===(null===n||void 0===n?void 0:n.deviceConnected);return a?(0,sm.jsxs)("div",{className:"loading-container",children:[(0,sm.jsx)("div",{className:"loading-spinner"}),(0,sm.jsx)("p",{children:"Loading your dashboard..."})]}):(0,sm.jsxs)("div",{className:"dashboard-container",children:[(0,sm.jsxs)("div",{className:"header",children:[(0,sm.jsx)("h1",{children:"Energy Management Dashboard"}),(0,sm.jsxs)("div",{className:"user-info",children:[(0,sm.jsxs)("span",{children:["Welcome, ",(null===n||void 0===n?void 0:n.name)||"User","!"]}),(0,sm.jsx)("button",{onClick:async()=>{console.log("Logout clicked - starting complete logout process");try{im.currentUser?(console.log("Signing out Firebase user:",im.currentUser.email),await Zi(im),console.log("Firebase signOut successful")):console.log("No Firebase user to sign out"),console.log("Clearing localStorage userData"),localStorage.removeItem("userData"),sessionStorage.clear(),console.log("Cleared sessionStorage"),r(null),s(!1),console.log("Complete logout finished, navigating to login..."),t("/login",{replace:!0})}catch(e){console.error("Error during logout:",e),localStorage.removeItem("userData"),sessionStorage.clear(),r(null),t("/login",{replace:!0})}},className:"logout-btn",children:"Logout"})]}),(0,sm.jsx)("div",{className:"date",id:"current-date",children:(new Date).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,sm.jsxs)("div",{className:"dashboard",children:[(0,sm.jsxs)("div",{className:"card energy-gauge-container",children:[(0,sm.jsxs)("h3",{className:"card-title",children:["Daily Energy Forecast",(0,sm.jsx)("span",{className:"info-icon",title:"Predicts how your energy levels will change throughout the day based on planned activities and historical patterns.",children:"\u24d8"})]}),(0,sm.jsx)("div",{id:"forecast-chart",ref:o,className:"forecast-chart"})]}),(0,sm.jsxs)("div",{className:"card status-summary-container",children:[(0,sm.jsxs)("h3",{className:"card-title",children:["Quick Actions",(0,sm.jsx)("span",{className:"info-icon",title:"One-tap access to common activities for logging your day and managing your condition.",children:"\u24d8"})]}),(0,sm.jsxs)("div",{className:"quick-actions",children:[(0,sm.jsx)("button",{className:"action-button meal",onClick:()=>{t("/food-tracker")},children:"Track Meal"}),h&&(0,sm.jsx)("button",{className:"action-button fitbit",onClick:u,children:"\ud83d\udcca View Fitbit Data"})]})]}),h&&(0,sm.jsxs)("div",{className:"card fitbit-status",children:[(0,sm.jsx)("h3",{className:"card-title",children:"Fitbit Connection"}),(0,sm.jsxs)("div",{className:"fitbit-info",children:[(0,sm.jsxs)("p",{children:["\u2705 Connected via ",n.selectedDevice]}),(0,sm.jsxs)("p",{children:["\ud83d\udcc5 Connected on: ",new Date(n.createdAt).toLocaleDateString()]}),(null===(e=n.fitbitData)||void 0===e?void 0:e.scope)&&(0,sm.jsxs)("p",{children:["\ud83d\udd10 Permissions: ",n.fitbitData.scope.split(" ").slice(0,3).join(", "),"..."]}),n.latestFitbitData&&(0,sm.jsxs)("div",{className:"latest-data-preview",children:[(0,sm.jsx)("h4",{children:"Latest Data:"}),(0,sm.jsxs)("div",{className:"data-preview-grid",children:[n.latestFitbitData.heartRate&&(0,sm.jsxs)("div",{className:"data-item",children:[(0,sm.jsx)("span",{className:"data-label",children:"Heart Rate:"}),(0,sm.jsxs)("span",{className:"data-value",children:[n.latestFitbitData.heartRate," bpm"]})]}),n.latestFitbitData.steps&&(0,sm.jsxs)("div",{className:"data-item",children:[(0,sm.jsx)("span",{className:"data-label",children:"Steps:"}),(0,sm.jsx)("span",{className:"data-value",children:n.latestFitbitData.steps.toLocaleString()})]}),n.latestFitbitData.lastSync&&(0,sm.jsxs)("div",{className:"data-item",children:[(0,sm.jsx)("span",{className:"data-label",children:"Last Sync:"}),(0,sm.jsx)("span",{className:"data-value",children:new Date(n.latestFitbitData.lastSync).toLocaleString()})]})]})]}),(0,sm.jsx)("button",{className:"fitbit-dashboard-btn",onClick:u,style:{backgroundColor:"#00b0b9",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"500",marginTop:"15px",width:"100%"},children:"\ud83d\udcca View Full Fitbit Dashboard"})]})]}),!h&&n&&(0,sm.jsxs)("div",{className:"card fitbit-status",children:[(0,sm.jsx)("h3",{className:"card-title",children:"Connect Wearable Device"}),(0,sm.jsx)("p",{children:"Connect a Fitbit device to track your heart rate, activity, and sleep data for better energy management."}),(0,sm.jsx)("button",{className:"connect-fitbit-btn",onClick:()=>t("/register"),style:{backgroundColor:"#28a745",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"500",marginTop:"10px"},children:"Connect Fitbit"})]})]})]})};const Tw=function(){var e,t;const[n,r]=(0,i.useState)(""),[a,s]=(0,i.useState)(""),[o,l]=(0,i.useState)(""),[c,u]=(0,i.useState)(!1),h=ee(),d=$(),f=null===(e=d.state)||void 0===e?void 0:e.message,p=null===(t=d.state)||void 0===t?void 0:t.email;return i.useEffect((()=>{p&&r(p)}),[p]),(0,sm.jsx)("div",{className:"signin-container",children:(0,sm.jsxs)("div",{className:"signin-card",children:[(0,sm.jsxs)("div",{className:"signin-header",children:[(0,sm.jsx)("h1",{children:"Welcome Back"}),(0,sm.jsx)("p",{children:"Sign in to your Energy Balance account"})]}),f&&(0,sm.jsx)("div",{className:"success-message",children:f}),o&&(0,sm.jsx)("div",{className:"error-message",children:o}),(0,sm.jsxs)("form",{className:"signin-form",onSubmit:async e=>{e.preventDefault(),l(""),u(!0);try{var t,r,i;const e=n.toLowerCase().trim(),o=a.trim();if(!e||!o)throw new Error("Please enter both email and password");if(o.length<6)throw new Error("Password must be at least 6 characters long");if(!im)throw new Error("Firebase Auth not properly configured");console.log("Attempting Firebase Auth login for:",e),console.log("Password length:",o.length),console.log("Firebase Auth config:",{apiKey:null!==(t=im.config)&&void 0!==t&&t.apiKey?"Present":"Missing",authDomain:null===(r=im.config)||void 0===r?void 0:r.authDomain,projectId:null===(i=im.config)||void 0===i?void 0:i.projectId}),im.currentUser&&(console.log("Clearing previous auth state for:",im.currentUser.email),await Zi(im)),localStorage.removeItem("userData"),console.log("Cleared localStorage userData"),console.log("Calling signInWithEmailAndPassword...");const c=await function(e,t,n){return Fn(e.app)?Promise.reject(ur(e)):Xi(Et(e),Oi.credential(t,n)).catch((async t=>{throw t.code==="auth/".concat("password-does-not-meet-requirements")&&Ji(e),t}))}(im,e,o),d=c.user;if(console.log("Firebase Auth successful for:",d.email),console.log("New user UID:",d.uid),console.log("Email verified:",d.emailVerified),d.email.toLowerCase()!==e)throw console.error("Email mismatch!"),console.error("Requested:",e),console.error("Authenticated:",d.email),new Error("Authentication error - email mismatch");console.log("Looking for Firestore document with UID:",d.uid);const f=Qf(am,"users",d.uid),p=await Yp(f);if(!p.exists())return console.error("User document not found in Firestore for UID:",d.uid),console.error("Firebase Auth email:",d.email),console.error("Firebase Auth UID:",d.uid),l("User profile not found. Please contact support or try registering again."),await Zi(im),void u(!1);const m=p.data();console.log("User profile loaded from Firestore"),console.log("Firestore email:",m.email),console.log("Auth email match:",m.email===d.email),m.email&&m.email.toLowerCase()!==d.email.toLowerCase()&&(console.warn("Email mismatch between Firebase Auth and Firestore"),console.warn("Firebase Auth:",d.email),console.warn("Firestore:",m.email));const g={id:d.uid,uid:d.uid,email:d.email,emailVerified:d.emailVerified,name:m.name,age:m.age,gender:m.gender,selectedDevice:m.selectedDevice,deviceConnected:m.deviceConnected,authorizationGiven:m.authorizationGiven,energyProfile:m.energyProfile,preferences:m.preferences,createdAt:m.createdAt,lastLoginAt:(new Date).toISOString(),device:m.selectedDevice,devicePermission:m.authorizationGiven,registrationComplete:!0,accountStatus:"active"};console.log("Setting localStorage with secure session data"),console.log("Session data being stored:",{id:g.id,uid:g.uid,email:g.email,name:g.name}),localStorage.setItem("userData",JSON.stringify(g));const v=JSON.parse(localStorage.getItem("userData"));console.log("Verification - data actually stored in localStorage:",{id:v.id,uid:v.uid,email:v.email,name:v.name});try{await Zp(Qf(am,"users",d.uid),{lastLoginAt:(new Date).toISOString(),lastUpdated:(new Date).toISOString()})}catch(s){console.warn("Could not update last login time:",s)}console.log("Login successful, navigating to dashboard"),h("/dashboard",{replace:!0})}catch(o){console.error("Firebase Auth error:",o),console.error("Error code:",o.code),console.error("Error message:",o.message),console.error("Full error object:",JSON.stringify(o,null,2));try{im.currentUser&&await Zi(im),localStorage.removeItem("userData")}catch(c){console.warn("Error during cleanup:",c)}let t="An error occurred during sign in. Please try again.";switch(o.code){case"auth/user-not-found":t="No account found with this email address. Please check your email or register first.";break;case"auth/wrong-password":t="Incorrect password. Please try again.";break;case"auth/invalid-email":t="Invalid email address format.";break;case"auth/user-disabled":t="This account has been disabled. Please contact support.";break;case"auth/too-many-requests":t="Too many failed login attempts. Please wait a few minutes and try again.";break;case"auth/network-request-failed":t="Network error. Please check your internet connection and try again.";break;case"auth/invalid-credential":t="Invalid login credentials. Please check your email and password.";break;case"auth/operation-not-allowed":t="Email/password authentication is not enabled. Please contact support.";break;case"auth/weak-password":t="Password is too weak. Please choose a stronger password.";break;default:o.message.includes("User profile not found")?t=o.message:o.message.includes("email mismatch")?t="Authentication error. Please try again.":o.code&&(t="Authentication failed: ".concat(o.code,". Please try again or contact support."))}console.error("Final error message shown to user:",t),l(t)}finally{u(!1)}},children:[(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{htmlFor:"email",children:"Email Address"}),(0,sm.jsx)("input",{id:"email",type:"email",value:n,onChange:e=>r(e.target.value),placeholder:"Enter your email",required:!0,autoComplete:"email"})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{htmlFor:"password",children:"Password"}),(0,sm.jsx)("input",{id:"password",type:"password",value:a,onChange:e=>s(e.target.value),placeholder:"Enter your password",required:!0,autoComplete:"current-password",minLength:"6"}),(0,sm.jsx)("div",{className:"forgot-password",children:(0,sm.jsx)("a",{href:"#forgot",children:"Forgot your password?"})})]}),(0,sm.jsxs)("button",{type:"submit",className:"signin-button",disabled:c,children:[c&&(0,sm.jsx)("span",{className:"loading-spinner"}),c?"Signing in...":"Sign In"]})]}),(0,sm.jsx)("div",{className:"divider",children:"or"}),(0,sm.jsxs)("div",{className:"signup-link",children:["Don't have an account? ",(0,sm.jsx)(Ie,{to:"/register",children:"Sign up here"})]}),(0,sm.jsxs)("div",{className:"about-section",children:[(0,sm.jsx)("h3",{children:"About Energy Balance"}),(0,sm.jsx)("p",{children:"Energy Balance is a comprehensive health management system designed to help individuals recovering from Long COVID. Our platform helps you track and manage your energy levels, physical activity, and overall well-being through seamless integration with your wearable devices."}),(0,sm.jsx)("p",{children:"By monitoring your daily activities and energy expenditure, we help you maintain a healthy balance and prevent post-exertional malaise (PEM) episodes."}),(0,sm.jsxs)("div",{className:"supported-devices",children:[(0,sm.jsx)("h4",{children:"Supported Devices"}),(0,sm.jsxs)("div",{className:"device-icons",children:[(0,sm.jsxs)("div",{className:"device-item",children:[(0,sm.jsx)("span",{className:"device-icon",children:"\u231a"}),(0,sm.jsx)("span",{children:"Apple Watch"})]}),(0,sm.jsxs)("div",{className:"device-item",children:[(0,sm.jsx)("span",{className:"device-icon",children:"\ud83d\udcf1"}),(0,sm.jsx)("span",{children:"Fitbit"})]}),(0,sm.jsxs)("div",{className:"device-item",children:[(0,sm.jsx)("span",{className:"device-icon",children:"\u231a"}),(0,sm.jsx)("span",{children:"Garmin"})]}),(0,sm.jsxs)("div",{className:"device-item",children:[(0,sm.jsx)("span",{className:"device-icon",children:"\ud83d\udcf1"}),(0,sm.jsx)("span",{children:"Samsung Health"})]}),(0,sm.jsxs)("div",{className:"device-item",children:[(0,sm.jsx)("span",{className:"device-icon",children:"\ud83d\udcca"}),(0,sm.jsx)("span",{children:"Manual Entry"})]})]})]})]}),!1]})})},Iw=(e,t)=>{const n=e.time,r=n.match(/(\d+):/),i=r?parseInt(r[1],10):12,a=n.toLowerCase().includes("pm");let s=i;a&&12!==i&&(s+=12),a||12!==i||(s=0);const o=.2*(parseFloat(e.protein)||0),l=.1*(parseFloat(e.carbs)||0),c=.15*(parseFloat(e.fat)||0);let u=1;s<6||s>20?u=.7:s>=7&&s<=10?u=1.2:s>=17&&s<=19&&(u=.9);const h={Breakfast:1.3,"Morning Snack":.9,Lunch:1.1,"Afternoon Snack":.8,Dinner:.9,"Late Night Snack":.6}[e.mealType]||1;let d=Math.min(100,10*(o+l+c))*u*h;if(e.longCovidAdjust&&null!==t&&void 0!==t&&t.hasLongCovid){d*={mild:.95,moderate:.85,severe:.75,"very severe":.65}[null===(f=t.longCovidSeverity)||void 0===f?void 0:f.toLowerCase()]||.85,e.longCovidBenefits&&e.longCovidBenefits.length>0&&(d*=1.1),e.longCovidCautions&&e.longCovidCautions.length>0&&(d*=.9)}var f;return Math.min(100,Math.max(0,d))},Aw=e=>{const t=e.split("-");return new Date(parseInt(t[0]),parseInt(t[1])-1,parseInt(t[2]))},jw=e=>{const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)};console.log("Testing with sample data:");const Dw=((e,t)=>{console.log("=== DEBUGGING EFFICIENCY CALCULATION ==="),console.log("Input mealData:",e),console.log("Input userProfile:",t);const n=e.time;console.log("Time string:",n);const r=n.match(/(\d+):/),i=r?parseInt(r[1],10):12,a=n.toLowerCase().includes("pm");console.log("Parsed hour:",i,"isPM:",a);let s=i;a&&12!==i&&(s+=12),a||12!==i||(s=0),console.log("24-hour format:",s);const o=parseFloat(e.protein)||0,l=parseFloat(e.carbs)||0,c=parseFloat(e.fat)||0;console.log("Macros - Protein:",o,"Carbs:",l,"Fat:",c);const u=.2*o,h=.1*l,d=.15*c;console.log("Macro factors - Protein:",u,"Carbs:",h,"Fat:",d);let f=1;s<6||s>20?f=.7:s>=7&&s<=10?f=1.2:s>=17&&s<=19&&(f=.9),console.log("Time factor:",f);const p={Breakfast:1.3,"Morning Snack":.9,Lunch:1.1,"Afternoon Snack":.8,Dinner:.9,"Late Night Snack":.6,Snack:.8}[e.mealType]||1;console.log("Meal type:",e.mealType,"Factor:",p);const m=Math.min(100,10*(u+h+d));console.log("Macro balance:",m);let g=m*f*p;if(console.log("Base efficiency:",g),e.longCovidAdjust&&null!==t&&void 0!==t&&t.hasLongCovid){var v;console.log("Applying Long COVID adjustments...");const n={mild:.95,moderate:.85,severe:.75,"very severe":.65}[(null===(v=t.longCovidSeverity)||void 0===v?void 0:v.toLowerCase())||"moderate"]||.85;console.log("Severity factor:",n),g*=n,console.log("After severity adjustment:",g),e.longCovidBenefits&&e.longCovidBenefits.length>0&&(g*=1.1,console.log("After benefits boost:",g)),e.longCovidCautions&&e.longCovidCautions.length>0&&(g*=.9,console.log("After cautions reduction:",g))}const y=Math.min(100,Math.max(0,g));return console.log("Final efficiency:",y),console.log("=== END DEBUGGING ===\n"),y})({name:"Greek Yogurt with Berries",protein:20,carbs:35,fat:8,calories:320,mealType:"Breakfast",time:"8:00 AM",longCovidAdjust:!0,longCovidBenefits:["High protein for recovery","Probiotics for gut health"]},{hasLongCovid:!0,longCovidSeverity:"moderate"});function Pw(e){let{userData:t,userIntake:n={}}=e;const r=(0,i.useRef)(null),[a,s]=(0,i.useState)(null),o=(0,i.useCallback)((e=>{const t=(e,t)=>e&&t?e/Math.pow(t/100,2):null,n=(e=>{const{age:n,gender:r,weight:i,height:a,activity_level:s}=e;if(!n||!i||!a)return 2e3;let o;o="female"===r?10*i+6.25*a-5*n-161:10*i+6.25*a-5*n+5;let l=o*({sedentary:1.2,light:1.375,moderate:1.55,very:1.725,extreme:1.9}[s]||1.375);e.covid_condition&&(l*=1.07);const c=t(i,a);return c&&(c<18.5?l*=1.1:c>30&&(l*=.9)),Math.round(l)})(e),r=((e,n)=>{if(!e)return null;let r=.25,i=.45,a=.3;n.covid_condition&&(r=.3,i=.4,a=.3);const s=t(n.weight,n.height);if(s&&s<18.5&&(a=.35,i=.45,r=.2),s&&s>30&&(r=.35,i=.35,a=.3),n.age>65){r=Math.min(r+.05,.4);const e=1-r;i=e*(i/(i+a)),a=e*(a/(i+a))}return{protein:r,carbs:i,fat:a}})(n,e),i=(n*r.protein/4).toFixed(1),a=(n*r.carbs/4).toFixed(1),s=(n*r.fat/9).toFixed(1),o="Increased to support immune function and tissue repair",l="Focus on complex carbs with anti-inflammatory properties",c="Higher proportion of omega-3s recommended to reduce inflammation";return{protein:{value:parseFloat(i),covidNote:e.covid_condition?o:null},carbs:{value:parseFloat(a),covidNote:e.covid_condition?l:null},fat:{value:parseFloat(s),covidNote:e.covid_condition?c:null},calories:{value:n}}}),[]);return(0,i.useEffect)((()=>{if(t){const e=o(t);s(e)}}),[t,o]),(0,i.useEffect)((()=>{if(!r.current||!a||!n)return;Hb(r.current).selectAll("*").remove();const e=40,i=180,s=60,o=70,l=700-o-i,c=350-e-s,u=Hb(r.current).append("svg").attr("width",l+o+i).attr("height",c+e+s).append("g").attr("transform","translate(".concat(o,",").concat(e,")")),h=["protein","carbs","fat"],d=[Le({name:"Current Intake"},n),{name:"Recommended",protein:a.protein.value,carbs:a.carbs.value,fat:a.fat.value}],f={protein:"#22c55e",carbs:"#3b82f6",fat:"#f59e0b"},p=eb().domain(d.map((e=>e.name))).range([0,l]).padding(.3),m=xm(d,(e=>e.protein+e.carbs+e.fat)),g=qb().domain([0,1.1*m]).range([c,0]);u.append("g").attr("transform","translate(0,".concat(c,")")).call(Dm(p)).selectAll("text").attr("font-size","12px").attr("font-weight",(e=>"Recommended"===e?"bold":"normal")),u.append("g").call(Pm(g).ticks(5)).selectAll("text").attr("font-size","12px"),u.append("text").attr("transform","rotate(-90)").attr("y",20-o).attr("x",-c/2).attr("font-size","14px").attr("text-anchor","middle").attr("fill","#666").text("Grams");const v=(new Date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});u.append("text").attr("x",l/2).attr("y",-e/2).attr("text-anchor","middle").attr("font-size","16px").attr("font-weight","bold").attr("fill","#333").text("Long COVID Macronutrient Analysis - ".concat(v)),d.forEach((e=>{let t=0;e.stackedData=h.map((n=>({nutrient:n,y0:t,y1:t+=e[n]||0})))}));const y=Hb("body").append("div").attr("class","d3-tooltip").style("position","absolute").style("background-color","white").style("border","1px solid #ddd").style("border-radius","4px").style("padding","8px").style("font-size","12px").style("pointer-events","none").style("opacity",0).style("box-shadow","0 2px 4px rgba(0,0,0,0.1)").style("z-index",100);u.selectAll(".bar-group").data(d).join("g").attr("class","bar-group").attr("transform",(e=>"translate(".concat(p(e.name),",0)"))).selectAll("rect").data((e=>e.stackedData)).join("rect").attr("width",p.bandwidth()).attr("y",(e=>g(e.y1))).attr("height",(e=>g(e.y0)-g(e.y1))).attr("fill",(e=>f[e.nutrient])).attr("stroke","white").attr("stroke-width",1).on("mouseover",(function(e,t){const n=Hb(this.parentNode).datum(),r=n[t.nutrient].toFixed(1),i=(n[t.nutrient]/(n.protein+n.carbs+n.fat)*100).toFixed(1),s="fat"===t.nutrient?9:4,o=(n[t.nutrient]*s).toFixed(0),l="Recommended"===n.name&&a[t.nutrient].covidNote?'<br><span style="color:#6366f1;font-style:italic">'.concat(a[t.nutrient].covidNote,"</span>"):"";y.style("opacity",1).html('\n          <div style="font-weight:bold;text-transform:capitalize;color:'.concat(f[t.nutrient],'">').concat(t.nutrient,'</div>\n          <div style="margin:4px 0">\n            <b>Amount:</b> ').concat(r,"g\n            <br><b>Percentage:</b> ").concat(i,"%\n            <br><b>Calories:</b> ").concat(o," kcal\n            ").concat(l,"\n          </div>\n        ")).style("left",e.pageX+10+"px").style("top",e.pageY-28+"px"),Hb(this).attr("stroke","#333").attr("stroke-width",2)})).on("mouseout",(function(){y.style("opacity",0),Hb(this).attr("stroke","white").attr("stroke-width",1)}));const b=u.append("g").attr("class","legend").attr("transform","translate(".concat(l+20,", 0)"));h.forEach(((e,t)=>{const n=b.append("g").attr("transform","translate(0, ".concat(25*t,")"));n.append("rect").attr("width",15).attr("height",15).attr("fill",f[e]),n.append("text").attr("x",24).attr("y",12).attr("text-anchor","start").style("text-transform","capitalize").style("font-size","14px").text(e)})),null!==t&&void 0!==t&&t.covid_condition&&u.append("text").attr("x",l/2).attr("y",c+40).attr("text-anchor","middle").attr("font-size","12px").attr("font-style","italic").attr("fill","#6366f1").text("Note: RDA values adjusted for Long COVID recovery needs");const w=u.append("g").attr("class","calorie-info").attr("transform","translate(".concat(l+20,", ").concat(25*h.length+20,")"));return w.append("text").attr("font-size","14px").attr("font-weight","bold").text("Total Calories:"),w.append("text").attr("y",25).attr("font-size","14px").text("Intake: ".concat((e=>(4*e.protein+4*e.carbs+9*e.fat).toFixed(0))(n)," kcal")),w.append("text").attr("y",50).attr("font-size","14px").text("Recommended: ".concat(a.calories.value.toFixed(0)," kcal")),()=>{Hb(".d3-tooltip").remove()}}),[r,a,n,t]),(0,sm.jsx)("div",{className:"w-full",children:(0,sm.jsx)("div",{ref:r,className:"macro-chart mx-auto overflow-visible",style:{minHeight:"350px"}})})}function Rw(e){let{data:t,userData:n,foodDatabase:r}=e;const a=(0,i.useRef)(null),[s,o]=(0,i.useState)([]);return(0,i.useEffect)((()=>{if(!t||0===t.length)return;const e=new Date,r=new Date;r.setDate(e.getDate()-7);const i=jw(r),a=t.filter((e=>{try{return t=e.date,n=i,Aw(t)>=Aw(n)}catch(r){return console.warn("Error parsing date:",e.date),!1}var t,n})).map(((e,t)=>{try{let t=e.efficiency||e.metabolicEfficiency;return!t||t<=0?(console.log("Recalculating efficiency for ".concat(e.name," (was ").concat(t,")")),t=Iw(e,n)):console.log("Using existing efficiency for ".concat(e.name,": ").concat(t)),Le(Le({},e),{},{originalEfficiency:e.efficiency||80,efficiency:t,actualEnergy:Math.round(e.calories*(t/100)),wastedEnergy:Math.round(e.calories*((100-t)/100))})}catch(r){console.warn("Error processing meal ".concat(t,":"),r);const n=e.efficiency||e.metabolicEfficiency||80;return Le(Le({},e),{},{efficiency:n,actualEnergy:Math.round(e.calories*(n/100)),wastedEnergy:Math.round(e.calories*((100-n)/100))})}})),s=a.filter((e=>"Pre-workout"!==e.mealType&&"Post-workout"!==e.mealType));console.log("ProcessedData with preserved efficiency:",s),o(s)}),[t,n,r]),(0,i.useEffect)((()=>{if(!a.current||!s||0===s.length)return;Hb(a.current).selectAll("*").remove();const e=60,t=120,n=140,r=70,i=800-r-t,o=500-e-n,l=Hb(a.current).append("svg").attr("width",i+r+t).attr("height",o+e+n).append("g").attr("transform","translate(".concat(r,",").concat(e,")"));l.append("text").attr("x",i/2).attr("y",-30).attr("text-anchor","middle").style("font-size","18px").style("font-weight","bold").text("Metabolic Efficiency Chart"),l.append("text").attr("x",i/2).attr("y",-10).attr("text-anchor","middle").style("font-size","14px").style("font-style","italic").text("How efficiently your body converts food into usable energy");const c=Hb("body").append("div").attr("class","chart-tooltip").style("position","absolute").style("visibility","hidden").style("background-color","white").style("border","1px solid #ddd").style("border-radius","5px").style("padding","12px").style("font-size","14px").style("box-shadow","0 3px 14px rgba(0,0,0,0.25)").style("z-index","10").style("max-width","300px"),u=[],h=new Date;for(let a=6;a>=0;a--){const e=new Date;e.setDate(h.getDate()-a);const t=jw(e);u.push(t)}console.log("=== CHART DEBUG ==="),console.log("processedData:",s);const d=[],f=wm(s,(e=>e.date)),p=u;p.forEach((e=>{const t=f.get(e)||[];if(t.length>0){wm(t,(e=>e.mealType)).forEach(((t,n)=>{const r=Sm(t,(e=>e.calories)),i=t.reduce(((e,t)=>{const n=t.efficiency||0,i=r>0?t.calories/r:0;return console.log("Meal: ".concat(t.name,", efficiency: ").concat(n,", calories: ").concat(t.calories,", weight: ").concat(i)),e+n*i}),0);console.log("Combined efficiency for ".concat(n," on ").concat(e,": ").concat(i));const a=Sm(t,(e=>e.actualEnergy||e.calories*(e.efficiency/100))),s=r-a;d.push({date:e,mealType:n,time:t[0].time,name:"".concat(n," (").concat(t.length," items)"),efficiency:Math.round(i),calories:r,actualEnergy:a,wastedEnergy:s,originalMeals:t})}))}})),console.log("Final combinedData:",d),console.log("=== END CHART DEBUG ===");const m=[...d].sort(((e,t)=>e.date!==t.date?e.date.localeCompare(t.date):e.time.localeCompare(t.time))),g=eb().domain(p).range([0,i]).padding(.2),v=eb().domain(["Breakfast","Morning Snack","Lunch","Afternoon Snack","Dinner","Late Night Snack"]).range([0,g.bandwidth()]).padding(.1),y=xm(d,(e=>e.calories))||1e3,b=qb().domain([0,y]).range([o,0]),w=qb().domain([0,100]).range([o,0]);var _;l.append("g").attr("transform","translate(0,".concat(o,")")).call(Dm(g).tickFormat((e=>{const t=e.split("-");return"".concat(parseInt(t[1]),"/").concat(parseInt(t[2]))}))).selectAll("text").style("text-anchor","end").attr("dx","-.8em").attr("dy",".15em").attr("transform","rotate(-45)"),l.append("g").call(Pm(b)).append("text").attr("transform","rotate(-90)").attr("y",-50).attr("x",-o/2).attr("text-anchor","middle").style("fill","#000").text("Calories"),l.append("g").attr("transform","translate(".concat(i,", 0)")).call((_=w,jm(2,_))).append("text").attr("transform","rotate(-90)").attr("y",50).attr("x",-o/2).attr("text-anchor","middle").style("fill","#000").text("Metabolic Efficiency (%)");const x={Breakfast:"#FF9F1C","Morning Snack":"#FFB84D",Lunch:"#2EC4B6","Afternoon Snack":"#4ECDC4",Dinner:"#E71D36","Late Night Snack":"#FF6B6B"};if(d.forEach((e=>{const t=x[e.mealType]||"#999999",n=g(e.date)+v(e.mealType),r=v.bandwidth();l.append("rect").attr("class","actual-energy-bar").attr("x",n).attr("y",b(e.actualEnergy)).attr("width",r).attr("height",o-b(e.actualEnergy)).attr("fill",t).attr("opacity",.9).attr("stroke","#333").attr("stroke-width",1).on("mouseover",(function(t){Hb(this).attr("opacity",.7),c.style("visibility","visible").html('\n            <div style="font-weight:bold;margin-bottom:10px;font-size:15px;">'.concat(e.date," - ").concat(e.mealType,'</div>\n            <div style="margin-bottom:6px;">Total Calories: ').concat(Math.round(e.calories),'</div>\n            <div style="margin-bottom:6px;"><strong>Usable Energy: ').concat(Math.round(e.actualEnergy)," cal (").concat(e.efficiency,'% efficient)</strong></div>\n            <div style="margin-bottom:12px;">Energy Lost: ').concat(Math.round(e.wastedEnergy),' cal</div>\n            <div style="font-weight:bold;margin-bottom:5px;">Individual Items:</div>\n            <ul style="margin-top:0;padding-left:20px;">\n              ').concat(e.originalMeals.map((t=>"\n                <li>".concat(t.name," - ").concat(t.calories," cal (").concat(t.efficiency||e.efficiency,"% efficient)</li>\n              "))).join(""),"\n            </ul>\n          ")).style("left","".concat(t.pageX+15,"px")).style("top","".concat(t.pageY-10,"px"))})).on("mouseout",(function(){Hb(this).attr("opacity",.9),c.style("visibility","hidden")})),l.append("rect").attr("class","potential-energy-bar").attr("x",n).attr("y",b(e.calories)).attr("width",r).attr("height",b(e.actualEnergy)-b(e.calories)).attr("fill",t).attr("opacity",.3).attr("stroke","#333").attr("stroke-width",1).attr("stroke-dasharray","3,3").on("mouseover",(function(t){Hb(this).attr("opacity",.5),c.style("visibility","visible").html('\n            <div style="font-weight:bold;margin-bottom:10px;font-size:15px;">'.concat(e.date," - ").concat(e.mealType,'</div>\n            <div style="margin-bottom:6px;">Total Calories: ').concat(Math.round(e.calories),'</div>\n            <div style="margin-bottom:6px;">Usable Energy: ').concat(Math.round(e.actualEnergy)," cal (").concat(e.efficiency,'% efficient)</div>\n            <div style="margin-bottom:12px;"><strong>Energy Lost: ').concat(Math.round(e.wastedEnergy)," cal</strong></div>\n          ")).style("left","".concat(t.pageX+15,"px")).style("top","".concat(t.pageY-10,"px"))})).on("mouseout",(function(){Hb(this).attr("opacity",.3),c.style("visibility","hidden")}))})),m.length>0){const e=vw().x((e=>g(e.date)+v(e.mealType)+v.bandwidth()/2)).y((e=>w(e.efficiency))).defined((e=>null!=e.efficiency)).curve(Ew);l.append("path").datum(m).attr("fill","none").attr("stroke","#FF5733").attr("stroke-width",3).attr("d",e),l.selectAll(".efficiency-point").data(d).enter().append("circle").attr("class","efficiency-point").attr("cx",(e=>g(e.date)+v(e.mealType)+v.bandwidth()/2)).attr("cy",(e=>w(e.efficiency))).attr("r",5).attr("fill","#FF5733").attr("stroke","#333").attr("stroke-width",1).on("mouseover",(function(e,t){Hb(this).attr("r",8),c.style("visibility","visible").html('\n            <div style="font-weight:bold;font-size:16px;">'.concat(t.mealType," on ").concat(t.date,"</div>\n            <div>Metabolic Efficiency: <strong>").concat(t.efficiency,'%</strong></div>\n            <div style="margin-top:6px">Your body converts <strong>').concat(t.efficiency,"%</strong> of consumed calories into usable energy.</div>\n          ")).style("left","".concat(e.pageX+15,"px")).style("top","".concat(e.pageY-10,"px"))})).on("mouseout",(function(){Hb(this).attr("r",5),c.style("visibility","hidden")}))}const S=o+80;l.append("line").attr("x1",10).attr("x2",40).attr("y1",S).attr("y2",S).attr("stroke","#FF5733").attr("stroke-width",3),l.append("circle").attr("cx",25).attr("cy",S).attr("r",5).attr("fill","#FF5733").attr("stroke","#333").attr("stroke-width",1),l.append("text").attr("x",50).attr("y",S+4).style("font-size","12px").text("Efficiency (%)");const k=[{label:"Usable Energy",color:"#2EC4B6",opacity:.9},{label:"Energy Lost",color:"#2EC4B6",opacity:.3}];l.selectAll(".legend-rect").data(k).enter().append("rect").attr("x",200).attr("y",((e,t)=>S-10+20*t)).attr("width",15).attr("height",15).attr("fill",(e=>e.color)).attr("opacity",(e=>e.opacity)).attr("stroke","#333").attr("stroke-width",1),l.selectAll(".legend-text").data(k).enter().append("text").attr("x",225).attr("y",((e,t)=>S+2+20*t)).style("font-size","12px").text((e=>e.label));const E=Object.entries(x).map((e=>{let[t,n]=e;return{type:t,color:n}}));return l.selectAll(".meal-type-rect").data(E).enter().append("rect").attr("x",((e,t)=>400+130*Math.floor(t/2))).attr("y",((e,t)=>S-10+t%2*20)).attr("width",15).attr("height",15).attr("fill",(e=>e.color)).attr("stroke","#333").attr("stroke-width",1),l.selectAll(".meal-type-text").data(E).enter().append("text").attr("x",((e,t)=>425+130*Math.floor(t/2))).attr("y",((e,t)=>S+2+t%2*20)).style("font-size","11px").text((e=>e.type)),()=>{Hb(".chart-tooltip").remove()}}),[a,s,n]),s&&0!==s.length?(0,sm.jsxs)("div",{className:"chart-container",children:[(0,sm.jsx)("div",{ref:a,className:"efficiency-chart",style:{minHeight:"500px"}}),(0,sm.jsxs)("div",{className:"chart-info",children:[(0,sm.jsx)("h4",{children:"Understanding Metabolic Efficiency"}),(0,sm.jsx)("p",{children:"Metabolic efficiency refers to how effectively your body converts the calories you consume into usable energy. The chart shows both the energy your body successfully uses (solid bars) and the energy that's lost during digestion and metabolism (transparent sections)."}),(0,sm.jsx)("p",{children:(0,sm.jsx)("strong",{children:"Key insights:"})}),(0,sm.jsxs)("ul",{children:[(0,sm.jsx)("li",{children:"Higher efficiency percentages mean more of your food energy is being utilized"}),(0,sm.jsx)("li",{children:"The red line tracks your efficiency over time across different meals"}),(0,sm.jsx)("li",{children:"Different meal types and timing can affect how efficiently your body processes food"}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Snack Timing:"})," Morning snacks (90%) are more efficient than late night snacks (60%)"]})]})]})]}):(0,sm.jsx)("div",{className:"chart-container",children:(0,sm.jsx)("div",{ref:a,className:"efficiency-chart",children:(0,sm.jsx)("div",{className:"placeholder",children:(0,sm.jsx)("p",{children:"No meal data available. Please add some meals to see your metabolic efficiency chart."})})})})}console.log("Expected result: ~74 (should be > 0)"),console.log("Actual result:",Dw),console.log("\n=== COMMON ISSUES TO CHECK ==="),console.log("1. Are protein/carbs/fat values numbers or strings?"),console.log("2. Is mealType exactly matching the case in mealTypeFactors?"),console.log('3. Is time format consistent (e.g., "8:00 AM" vs "8:00 am")?'),console.log("4. Is longCovidSeverity exactly matching the case in severityFactors?"),console.log("5. Are the macro values realistic (not 0 or undefined)?");const Ow=e=>{if(!e)return"";const[t,n]=e.split(" ");if(!t||!n)return e;let[r,i]=t.split(":"),a=parseInt(r,10);"AM"===n.toUpperCase()?12===a&&(a=0):"PM"===n.toUpperCase()&&12!==a&&(a+=12);const s=a.toString().padStart(2,"0");return"".concat(s,":").concat(i)};console.log("Testing convertTo24Hour function:"),console.log("12:30 AM ->",Ow("12:30 AM")),console.log("1:30 AM  ->",Ow("1:30 AM")),console.log("11:59 AM ->",Ow("11:59 AM")),console.log("12:00 PM ->",Ow("12:00 PM")),console.log("1:30 PM  ->",Ow("1:30 PM")),console.log("11:59 PM ->",Ow("11:59 PM"));const Lw=e=>{if(console.log("prepareChartData called with:",e),!e||!Array.isArray(e))return console.warn("prepareChartData: Invalid input data"),[];try{const t=e.map(((e,t)=>{try{let t=e.time||"12:00 PM";if(t.match(/^\d{1,2}:\d{2}$/)&&!t.includes("AM")&&!t.includes("PM")){const[n,r]=t.split(":"),i=parseInt(n,10),a=i<12?"AM":"PM";t="".concat(0===i?12:i>12?i-12:i,":").concat(r," ").concat(a),console.log("Converted time from ".concat(e.time," to ").concat(t))}return Le(Le({},e),{},{time:t})}catch(n){return console.warn("Error processing meal ".concat(t," in prepareChartData:"),n),Le(Le({},e),{},{time:"12:00 PM"})}}));return(e=>{console.log("=== MEAL DATA DEBUGGER ===");const t=[...e].sort(((e,t)=>e.time.localeCompare(t.time)));t.forEach((e=>{console.log('Time: "'.concat(e.time,'" | ')+'MealType: "'.concat(e.mealType,'" | ')+'Date: "'.concat(e.date,'"'))})),console.log("=== END MEAL DATA ===")})(t),console.log("prepareChartData completed successfully:",t.length,"items"),t}catch(t){return console.error("Error in prepareChartData:",t),e||[]}},Mw=e=>{let{data:t,maxPercent:n}=e;const r=Math.min(100,t.value/t.rda*100),i=Math.min(100,100),a=(s=r)>=100?"#4CAF50":s>=70?"#8BC34A":s>=50?"#FFC107":s>=30?"#FF9800":"#F44336";var s;return(0,sm.jsxs)("div",{className:"bullet-chart",children:[(0,sm.jsxs)("div",{className:"bullet-chart-header",children:[(0,sm.jsxs)("div",{className:"bullet-chart-title",children:[(0,sm.jsx)("span",{className:"nutrient-name",children:t.name}),t.isAdjusted&&(0,sm.jsx)("span",{className:"adjusted-badge",children:"Adjusted"})]}),(0,sm.jsxs)("div",{className:"bullet-chart-values",children:[t.value," / ",t.rda," ",t.unit,(0,sm.jsxs)("span",{className:"bullet-chart-percentage",style:{color:a},children:["(",Math.round(r),"%)"]})]})]}),(0,sm.jsxs)("div",{className:"bullet-chart-track",children:[(0,sm.jsx)("div",{className:"threshold-marker",style:{left:"70%"}}),(0,sm.jsx)("div",{className:"actual-value-bar",style:{width:"".concat(r,"%"),backgroundColor:a}}),(0,sm.jsx)("div",{className:"target-line",style:{left:"".concat(i,"%")}})]})]})},Fw={vitamin_a:{value:900,unit:"mcg",femaleAdjust:.78,description:"Supports vision, immune function, and cell growth"},vitamin_c:{value:90,unit:"mg",femaleAdjust:.83,description:"Antioxidant that supports immune function and collagen production"},vitamin_d:{value:15,unit:"mcg",femaleAdjust:1,description:"Crucial for calcium absorption and bone health"},vitamin_e:{value:15,unit:"mg",femaleAdjust:1,description:"Antioxidant that protects cells from damage"},vitamin_b6:{value:1.3,unit:"mg",femaleAdjust:1,description:"Important for metabolism and brain development"},vitamin_b12:{value:2.4,unit:"mcg",femaleAdjust:1,description:"Essential for nerve function and blood cell formation"},folate:{value:400,unit:"mcg",femaleAdjust:1,description:"Critical for cell division and DNA synthesis"},iron:{value:8,unit:"mg",femaleAdjust:2.25,description:"Essential for oxygen transport in the blood"},calcium:{value:1e3,unit:"mg",femaleAdjust:1,description:"Critical for bone health and muscle function"},magnesium:{value:420,unit:"mg",femaleAdjust:.76,description:"Involved in over 300 biochemical reactions in the body"},zinc:{value:11,unit:"mg",femaleAdjust:.73,description:"Important for immune function and wound healing"},selenium:{value:55,unit:"mcg",femaleAdjust:1,description:"Antioxidant that helps protect cells from damage"},copper:{value:.9,unit:"mg",femaleAdjust:1,description:"Important for red blood cell formation and nerve function"},vitamin_b1:{value:1.2,unit:"mg",femaleAdjust:.92,description:"Essential for energy metabolism"},vitamin_b2:{value:1.3,unit:"mg",femaleAdjust:.85,description:"Important for energy production and cell function"},vitamin_b3:{value:16,unit:"mg",femaleAdjust:.875,description:"Helps convert food into energy"}};function Uw(e){let{data:t,userData:n}=e;const r={vitamin_a:{value:450,unit:"mcg"},vitamin_c:{value:45,unit:"mg"},vitamin_d:{value:8,unit:"mcg"},vitamin_e:{value:7,unit:"mg"},vitamin_b6:{value:.8,unit:"mg"},vitamin_b12:{value:1.5,unit:"mcg"},folate:{value:200,unit:"mcg"},iron:{value:12,unit:"mg"},calcium:{value:800,unit:"mg"},magnesium:{value:200,unit:"mg"},zinc:{value:6,unit:"mg"},selenium:{value:35,unit:"mcg"},copper:{value:.5,unit:"mg"},vitamin_b1:{value:.9,unit:"mg"},vitamin_b2:{value:1,unit:"mg"},vitamin_b3:{value:12,unit:"mg"}};console.log("Using test data:",r);const[a,s]=(0,i.useState)(n),[o,l]=(0,i.useState)([]),[c]=(0,i.useState)(function(e,t){const n=t;return Object.keys(e).forEach((t=>{n[t]=e[t]})),n}(r,Fw)),[u,h]=(0,i.useState)({}),[d,f]=(0,i.useState)("all"),[p,m]=(0,i.useState)(!0),[g,v]=(0,i.useState)("all"),y=(0,i.useCallback)(((e,t)=>{if(console.log("=== DEBUGGING calculatePersonalizedRDA ==="),console.log("Input baseRDAData_:",e),console.log("Input userData:",t),!e||0===Object.keys(e).length)return console.error("\u274c baseRDAData_ is empty or invalid!"),{};const n=JSON.parse(JSON.stringify(e));return Object.keys(n).forEach((r=>{if(console.log("\n--- Processing ".concat(r," ---")),console.log("Initial data:",n[r]),!n[r]||"number"!==typeof n[r].value)return void console.error("\u274c Invalid data structure for ".concat(r,":"),n[r]);let i=n[r].value;if(console.log("Starting value: ".concat(i)),t.gender&&"female"===t.gender.toLowerCase()){const e=n[r].femaleAdjust||1;i*=e,console.log("After female adjust (".concat(e,"): ").concat(i))}else console.log("No female adjustment applied (gender: ".concat(t.gender,")"));if(t.age){let e=1;t.age>=70?("vitamin_d"===r&&(e=1.2),"vitamin_b12"===r&&(e=1.1),"calcium"===r&&(e=1.15)):t.age>=50?("vitamin_d"===r&&(e=1.1),"vitamin_b12"===r&&(e=1.05)):t.age<=18&&("calcium"===r&&(e=1.15),"iron"===r&&(e=1.1)),1!==e?(i*=e,console.log("After age adjust (".concat(e,"): ").concat(i))):console.log("No age adjustment applied for ".concat(r," at age ").concat(t.age))}const a=t.covid_severity||t.longCovidSeverity,s=a&&"None"!==a&&null!==a&&void 0!==a;if(console.log('COVID check - severity: "'.concat(a,'", hasCovidCondition: ').concat(s)),s){console.log('Applying COVID adjustments for severity: "'.concat(a,'"'));const e=(e=>{if(console.log("getSeverityFactor called with:",e),!e||"None"===e||null===e||void 0===e)return console.log("Returning 1.0 for None/null severity"),1;const t=e.toString().toLowerCase(),n={mild:1.1,moderate:1.3,severe:1.5,"very severe":1.7}[t]||1;return console.log('Severity "'.concat(e,'" normalized to "').concat(t,'" -> factor: ').concat(n)),n})(a);if(console.log("Severity factor: ".concat(e)),["vitamin_c","vitamin_d","zinc","selenium"].includes(r)){const t=Math.min(1.5*e,2.5);i*=t,console.log("After COVID high-priority adjust (".concat(t,"): ").concat(i))}else if(["vitamin_a","vitamin_e","vitamin_b6","vitamin_b12","folate","iron"].includes(r)){const t=Math.min(1.3*e,2);i*=t,console.log("After COVID medium-priority adjust (".concat(t,"): ").concat(i))}else if(["magnesium","copper","vitamin_b1","vitamin_b2","vitamin_b3"].includes(r)){const t=Math.min(1.1*e,1.5);i*=t,console.log("After COVID low-priority adjust (".concat(t,"): ").concat(i))}}else console.log("No COVID adjustments applied - using baseline RDA");(isNaN(i)||!isFinite(i)||i<=0)&&(console.error("\u274c Invalid final value for ".concat(r,": ").concat(i,", resetting to base")),i=n[r].value);const o=Math.round(10*i)/10;console.log("Final rounded value: ".concat(o)),n[r]=Le(Le({},n[r]),{},{value:o,isAdjusted:o!==e[r].value})})),console.log("Final personalRDA:",n),console.log("=== END calculatePersonalizedRDA DEBUG ===\n"),n}),[]),b=(0,i.useCallback)(((e,t)=>{if(console.log("=== DEBUGGING processNutrientData ==="),console.log("Input intake:",e),console.log("Input rdaValues:",t),!t||0===Object.keys(t).length)return void console.error("No RDA values provided to processNutrientData");let r=e;if(n.covid_severity||n.longCovidSeverity){r=((e,t)=>{const n={mild:1.2,moderate:1.5,severe:1.8,"very severe":2}[null===t||void 0===t?void 0:t.toLowerCase()]||1,r={},i=["vitamin_c","vitamin_d","zinc","selenium","vitamin_b6","vitamin_b12","folate","iron","magnesium"];return Object.entries(e).forEach((e=>{let[a,s]=e;i.includes(a)?r[a]=Le(Le({},s),{},{recommendedValue:(s.value||0)*n,isEnhanced:!0,reason:"Increased for Long COVID ".concat(t," severity")}):r[a]=Le(Le({},s),{},{recommendedValue:s.value||0,isEnhanced:!1})})),r})(e,n.covid_severity||n.longCovidSeverity)}else r=((e,t)=>{const n={};return Object.entries(e).forEach((e=>{let[r,i]=e,a=1;t.age>65&&["vitamin_d","vitamin_b12","calcium"].includes(r)&&(a*=1.2),"female"===t.gender&&"iron"===r&&(a*=2.25),"high"!==t.activityLevel&&"very_high"!==t.activityLevel||["magnesium","iron","vitamin_b1","vitamin_b2"].includes(r)&&(a*=1.3),n[r]=Le(Le({},i),{},{recommendedValue:(i.value||0)*a,isEnhanced:a>1,reason:a>1?"Adjusted for demographics and activity":"Standard recommendation"})})),n})(e,n);let i=Object.entries(r).map((e=>{var n;let[r,i]=e;if(console.log("Processing ".concat(r,":"),i,"RDA:",t[r]),!t[r])return console.warn("No RDA data for ".concat(r)),null;const a="object"===typeof i?i.value||i.recommendedValue||0:i||0,s=t[r].value;if(isNaN(a)||isNaN(s)||0===s)return console.warn("Invalid values for ".concat(r,": intake=").concat(a,", rda=").concat(s)),null;const o=t[r].unit||"mg",l=a/s*100,c=r.replace(/_/g," ").replace(/\b\w/g,(e=>e.toUpperCase())),u=t[r].isAdjusted||i.isEnhanced&&i.isEnhanced,h=(null===(n=Fw[r])||void 0===n?void 0:n.value)||s,d=r.includes("vitamin")?"vitamins":"minerals",f={name:c,key:r,percentOfRDA:Math.min(l,150),fullPercent:l,value:a,unit:o,rda:s,standardRDA:h,isAdjusted:u,description:t[r].description||"",category:d,enhancementReason:i.reason||null};return console.log("".concat(r," result:"),f),f})).filter((e=>null!==e));"deficient"===d?i=i.filter((e=>e.percentOfRDA<90)):"optimal"===d&&(i=i.filter((e=>e.percentOfRDA>=90))),"all"!==g&&(i=i.filter((e=>e.category===g))),i.sort(((e,t)=>e.percentOfRDA-t.percentOfRDA)),console.log("Final processedData:",i),console.log("=== END processNutrientData DEBUG ==="),l(i)}),[d,g,n]);(0,i.useEffect)((()=>{(e=>{console.log("=== USER DATA STRUCTURE ==="),console.log("userData:",e),console.log("covid_severity:",e.covid_severity,typeof e.covid_severity),console.log("longCovidSeverity:",e.longCovidSeverity),console.log("hasLongCovid:",e.hasLongCovid),console.log("age:",e.age),console.log("gender:",e.gender),console.log("weight:",e.weight),console.log("height:",e.height),console.log("=== END USER DATA ===")})(a),setTimeout((()=>{try{const e=y(Fw,a);if(!e||0===Object.keys(e).length)return void console.error("Failed to calculate RDA values");h(e),b(c,e),m(!1)}catch(e){console.error("Error in useEffect:",e),m(!1)}}),500)}),[a,y,b,c]);const w=e=>{f(e),b(c,u)},_=e=>{v(e),b(c,u)};if(p)return(0,sm.jsx)("div",{className:"loading-container",children:(0,sm.jsxs)("div",{className:"loading-indicator",children:[(0,sm.jsx)("div",{className:"spinner"}),(0,sm.jsx)("p",{className:"loading-text",children:"Loading personalized micronutrient data..."})]})});const x=o.filter((e=>e.percentOfRDA<70)).length;return(0,sm.jsxs)("div",{className:"micronutrient-chart-container",children:[(0,sm.jsxs)("div",{className:"chart-card",children:[(0,sm.jsxs)("div",{className:"chart-header",children:[(0,sm.jsx)("h2",{className:"chart-title",children:"Micronutrient Status"}),(0,sm.jsxs)("div",{className:"display-mode-buttons",children:[(0,sm.jsx)("button",{onClick:()=>w("all"),className:"mode-button ".concat("all"===d?"mode-button-active":""),children:"All"}),(0,sm.jsx)("button",{onClick:()=>w("deficient"),className:"mode-button ".concat("deficient"===d?"mode-button-deficient":""),children:"Deficient"}),(0,sm.jsx)("button",{onClick:()=>w("optimal"),className:"mode-button ".concat("optimal"===d?"mode-button-optimal":""),children:"Optimal"})]})]}),(0,sm.jsxs)("div",{className:"category-filter",children:[(0,sm.jsx)("button",{onClick:()=>_("all"),className:"category-button ".concat("all"===g?"category-button-active":""),children:"All Nutrients"}),(0,sm.jsx)("button",{onClick:()=>_("vitamins"),className:"category-button ".concat("vitamins"===g?"category-button-active":""),children:"Vitamins"}),(0,sm.jsx)("button",{onClick:()=>_("minerals"),className:"category-button ".concat("minerals"===g?"category-button-active":""),children:"Minerals"})]}),x>0&&(0,sm.jsx)("div",{className:"deficiency-alert",children:(0,sm.jsxs)("p",{className:"deficiency-message",children:[x," ",1===x?"nutrient is":"nutrients are"," below recommended levels."]})}),a.covid_severity&&(0,sm.jsxs)("div",{className:"covid-alert ".concat((e=>{switch(e){case"Mild":return"covid-severity-mild";case"Moderate":return"covid-severity-moderate";case"Severe":return"covid-severity-severe";case"Very Severe":return"covid-severity-very-severe";default:return"covid-severity-unknown"}})(a.covid_severity)),children:[(0,sm.jsxs)("p",{className:"covid-title",children:["Long COVID Condition - ",a.covid_severity," Severity"]}),(0,sm.jsx)("p",{className:"covid-description",children:"Recommended values have been adjusted for immune system support"})]}),(0,sm.jsx)("div",{className:"chart-content",children:o.map((e=>(0,sm.jsx)(Mw,{data:e,maxPercent:150},e.key)))}),(0,sm.jsxs)("div",{className:"chart-legend",children:[(0,sm.jsxs)("div",{className:"legend-item",children:[(0,sm.jsx)("div",{className:"legend-color legend-optimal"}),(0,sm.jsx)("span",{className:"legend-text",children:"\u2265 100% (Optimal)"})]}),(0,sm.jsxs)("div",{className:"legend-item",children:[(0,sm.jsx)("div",{className:"legend-color legend-good"}),(0,sm.jsx)("span",{className:"legend-text",children:"70-99% (Good)"})]}),(0,sm.jsxs)("div",{className:"legend-item",children:[(0,sm.jsx)("div",{className:"legend-color legend-moderate"}),(0,sm.jsx)("span",{className:"legend-text",children:"50-69% (Moderate)"})]}),(0,sm.jsxs)("div",{className:"legend-item",children:[(0,sm.jsx)("div",{className:"legend-color legend-low"}),(0,sm.jsx)("span",{className:"legend-text",children:"30-49% (Low)"})]}),(0,sm.jsxs)("div",{className:"legend-item",children:[(0,sm.jsx)("div",{className:"legend-color legend-very-low"}),(0,sm.jsx)("span",{className:"legend-text",children:"0-29% (Very Low)"})]}),(0,sm.jsxs)("div",{className:"legend-item",children:[(0,sm.jsx)("div",{className:"legend-target"}),(0,sm.jsx)("span",{className:"legend-text",children:"Target (100% RDA)"})]}),(0,sm.jsxs)("div",{className:"legend-item",children:[(0,sm.jsx)("div",{className:"legend-threshold"}),(0,sm.jsx)("span",{className:"legend-text",children:"Deficiency Threshold (70%)"})]})]})]}),(0,sm.jsxs)("div",{className:"profile-card",children:[(0,sm.jsx)("h3",{className:"profile-title",children:"User Profile"}),(0,sm.jsxs)("div",{className:"profile-grid",children:[(0,sm.jsxs)("div",{className:"profile-item",children:[(0,sm.jsx)("p",{className:"profile-label",children:"Age"}),(0,sm.jsxs)("p",{className:"profile-value",children:[a.age," years"]})]}),(0,sm.jsxs)("div",{className:"profile-item",children:[(0,sm.jsx)("p",{className:"profile-label",children:"Gender"}),(0,sm.jsx)("p",{className:"profile-value",children:a.gender?a.gender.charAt(0).toUpperCase()+a.gender.slice(1):"Not specified"})]}),(0,sm.jsxs)("div",{className:"profile-item",children:[(0,sm.jsx)("p",{className:"profile-label",children:"BMI"}),(0,sm.jsx)("p",{className:"profile-value",children:a.weight&&a.height?Math.round(a.weight/Math.pow(a.height/100,2)*10)/10:"N/A"})]}),(0,sm.jsxs)("div",{className:"profile-item",children:[(0,sm.jsx)("p",{className:"profile-label",children:"Activity Level"}),(0,sm.jsx)("p",{className:"profile-value",children:a.activity_level||"Not specified"})]}),(0,sm.jsxs)("div",{className:"profile-item",children:[(0,sm.jsx)("p",{className:"profile-label",children:"Medical Conditions"}),(0,sm.jsx)("p",{className:"profile-value",children:a.medical_conditions&&a.medical_conditions.length>0?a.medical_conditions.map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(", "):"None"})]}),(0,sm.jsxs)("div",{className:"profile-item",children:[(0,sm.jsx)("p",{className:"profile-label",children:"COVID Status"}),(0,sm.jsxs)("button",{onClick:()=>{const e=[null,"mild","moderate","severe","very severe"],t=a.covid_severity||a.longCovidSeverity||null,n=e.indexOf(t),r=e[(n+1)%e.length];console.log('Toggling COVID severity from "'.concat(t,'" to "').concat(r,'"'));const i=Le(Le({},a),{},{covid_severity:r,longCovidSeverity:r,hasLongCovid:null!==r});null===r&&(delete i.covid_severity,delete i.longCovidSeverity,i.hasLongCovid=!1),console.log("Updated user info:",i),s(i)},className:"covid-toggle-button",style:{padding:"8px 12px",backgroundColor:"#e3f2fd",border:"2px solid #2196f3",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"500",color:"#1976d2",transition:"all 0.2s ease",minWidth:"120px"},onMouseEnter:e=>{e.target.style.backgroundColor="#bbdefb",e.target.style.transform="scale(1.02)"},onMouseLeave:e=>{e.target.style.backgroundColor="#e3f2fd",e.target.style.transform="scale(1)"},children:[(()=>{const e=a.covid_severity||a.longCovidSeverity;return e&&null!==e?e.charAt(0).toUpperCase()+e.slice(1):"None"})()," (Click to change)"]})]})]})]})]})}function Vw(e){let{foodLog:t,userProfile:n}=e;if(!t||!Array.isArray(t))return(0,sm.jsxs)("div",{className:"analysis-error",children:[(0,sm.jsx)("h3",{children:"Data Error"}),(0,sm.jsx)("p",{children:"Unable to load food log data. Please try refreshing the page."})]});if(!n)return(0,sm.jsxs)("div",{className:"analysis-error",children:[(0,sm.jsx)("h3",{children:"Profile Error"}),(0,sm.jsx)("p",{children:"User profile data is missing. Please check your account settings."})]});const r=jw(new Date),i=t.length>0?t[0].date:r,a=t.filter((e=>e.date===r)),{macroSums:s,microSums:o,efficiencyData:l}=(()=>{if(0===t.length)return{macroSums:{},microSums:{},efficiencyData:[]};const e=t[0].date,n=t.filter((t=>t.date===e));console.log("=== DEBUGGING getChartData ==="),console.log("lastDayEntries:",n);const r=n.reduce(((e,t)=>(e.protein=(e.protein||0)+(parseFloat(t.protein)||0),e.carbs=(e.carbs||0)+(parseFloat(t.carbs)||0),e.fat=(e.fat||0)+(parseFloat(t.fat)||0),e.calories=(e.calories||0)+(parseFloat(t.calories)||0),e)),{});n.forEach(((e,t)=>{console.log("\nEntry ".concat(t,": ").concat(e.name)),console.log("micronutrients:",e.micronutrients),e.micronutrients?Object.entries(e.micronutrients).forEach((e=>{let[t,n]=e;console.log("  ".concat(t,":"),n)})):console.warn("\u274c No micronutrients data for ".concat(e.name))}));const i=n.reduce(((e,t)=>(t.micronutrients&&Object.entries(t.micronutrients).forEach((t=>{let[n,r]=t;if(!["protein","carbs","fat","calories","name","unit"].includes(n)){const t="object"===typeof r?r.value||0:r,i=parseFloat(t)||0;e[n]=(e[n]||0)+i,console.log("Adding ".concat(n,": ").concat(i,", running total: ").concat(e[n]))}})),e)),{});console.log("Final macroSums:",r),console.log("Final microSums:",i),console.log("=== END getChartData DEBUG ===\n");return{macroSums:r,microSums:i,efficiencyData:t}})();return(0,sm.jsxs)("div",{className:"food-analysis-section",children:[(0,sm.jsxs)("div",{className:"analysis-header",children:[(0,sm.jsx)("h3",{children:"\ud83d\udcca Nutritional Analysis Dashboard"}),(0,sm.jsxs)("p",{className:"analysis-date",children:["Analysis for ",i]}),(0,sm.jsx)("div",{className:"analysis-summary",children:(0,sm.jsxs)("span",{className:"summary-stat",children:[(0,sm.jsx)("strong",{children:a.length})," meals logged today (",r,")"]})})]}),(0,sm.jsxs)("div",{className:"charts-container",children:[(0,sm.jsxs)("div",{className:"chart-wrapper",children:[(0,sm.jsxs)("div",{className:"chart-header",children:[(0,sm.jsx)("h4",{children:"\ud83c\udf4e Macronutrient Balance"}),(0,sm.jsx)("p",{className:"chart-description",children:"Your protein, carbohydrate, and fat intake compared to personalized recommendations"})]}),(0,sm.jsx)(Pw,{userData:n,userIntake:s})]}),(0,sm.jsxs)("div",{className:"chart-wrapper",children:[(0,sm.jsxs)("div",{className:"chart-header",children:[(0,sm.jsx)("h4",{children:"\ud83d\udc8a Micronutrient Status"}),(0,sm.jsx)("p",{className:"chart-description",children:"Essential vitamins and minerals as percentage of recommended daily amounts"})]}),(0,sm.jsx)(Uw,{data:o,userData:n})]}),(0,sm.jsxs)("div",{className:"chart-wrapper one",children:[(0,sm.jsxs)("div",{className:"chart-header",children:[(0,sm.jsx)("h4",{children:"\u26a1 Metabolic Efficiency"}),(0,sm.jsx)("p",{className:"chart-description",children:"How effectively your body converts food calories into usable energy"})]}),(0,sm.jsx)(Rw,{data:Lw(l),userData:n})]})]})]})}const zw=["Breakfast","Morning Snack","Lunch","Afternoon Snack","Dinner","Late Night Snack"],Bw=["Add Food","Food Journal","Analysis"];const qw=function(){var e;const t=ee(),[n,r]=(0,i.useState)([]),[a,s]=(0,i.useState)("loading"),[o,l]=(0,i.useState)(!1),[c,u]=(0,i.useState)(null),[h,d]=(0,i.useState)({age:30,gender:"female",weight:65,height:165,activityLevel:"moderate",hasLongCovid:!1,longCovidSeverity:"moderate"}),[f,p]=(0,i.useState)(!0),[m,g]=(0,i.useState)("Add Food"),[v,y]=(0,i.useState)(""),[b,w]=(0,i.useState)([]),[_,x]=(0,i.useState)(null),[S,k]=(0,i.useState)({}),[E,C]=(0,i.useState)("Breakfast"),[N,T]=(0,i.useState)((()=>(new Date).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))),[I,A]=(0,i.useState)((()=>(new Date).toISOString().slice(0,10))),[j,D]=(0,i.useState)(!0),[P,R]=(0,i.useState)(!1),[O,L]=(0,i.useState)(""),[M,F]=(0,i.useState)(""),[U,V]=(0,i.useState)([]),[z,B]=(0,i.useState)(!1),[q,H]=(0,i.useState)(""),[W,G]=(0,i.useState)(1),[K,Q]=(0,i.useState)(null),[Y,X]=(0,i.useState)(null),[J,$]=(0,i.useState)(!1),[Z,te]=(0,i.useState)({}),ne=e=>{let{entryId:t,entryName:n,onConfirm:r,onCancel:i}=e;return(0,sm.jsx)("div",{className:"modal-overlay",children:(0,sm.jsxs)("div",{className:"delete-confirm-modal",children:[(0,sm.jsx)("h3",{children:"\ud83d\uddd1\ufe0f Delete Food Entry"}),(0,sm.jsx)("p",{children:"Are you sure you want to delete this food entry?"}),(0,sm.jsx)("div",{className:"entry-preview",children:(0,sm.jsx)("strong",{children:n})}),(0,sm.jsx)("p",{className:"warning-text",children:"This action cannot be undone."}),(0,sm.jsxs)("div",{className:"modal-actions",children:[(0,sm.jsx)("button",{className:"cancel-button",onClick:i,disabled:J,children:"Cancel"}),(0,sm.jsx)("button",{className:"delete-button",onClick:()=>r(t),disabled:J,children:J?"Deleting...":"Delete Entry"})]})]})})},re=(0,i.useCallback)((async()=>{try{const e=localStorage.getItem("userData");if(!e)return void t("/login");const n=JSON.parse(e);u(n),n.id?await(async e=>{try{const t=Qf(am,"users",e),n=await Yp(t);if(n.exists()){const e=n.data();d(Le({age:e.age||30,gender:e.gender||"female",weight:e.weight||65,height:e.height||165,activityLevel:e.activityLevel||"moderate",hasLongCovid:e.hasLongCovid||!1,longCovidSeverity:e.longCovidSeverity||"moderate"},e))}else console.log("No user profile found, using defaults")}catch(t){console.error("Error fetching user profile:",t),F("Failed to load user profile")}})(n.id):d((e=>Le(Le({},e),n)))}catch(M){console.error("Error checking authentication:",M),t("/login")}finally{p(!1)}}),[t]);(0,i.useEffect)((()=>{re()}),[re]);const ie=(0,i.useCallback)((async()=>{if(!c||!c.id)return;const e=(new Date).toISOString().split("T")[0],t=new Date;t.setDate(t.getDate()-1);const n=[{name:"Greek Yogurt with Berries",protein:20,carbs:35,fat:8,calories:320,serving:200,micronutrients:{vitamin_c:{value:25,unit:"mg"},calcium:{value:200,unit:"mg"},vitamin_b12:{value:1.2,unit:"mcg"}},mealType:"Breakfast",time:"8:00 AM",date:e,longCovidAdjust:h.hasLongCovid,longCovidBenefits:["High protein for recovery","Probiotics for gut health"],longCovidCautions:[],longCovidRelevance:{antiInflammatory:"moderate"},metabolicEfficiency:85,createdAt:no.now()},{name:"Quinoa Salad with Grilled Chicken",protein:32,carbs:42,fat:15,calories:450,serving:300,micronutrients:{iron:{value:3.5,unit:"mg"},magnesium:{value:60,unit:"mg"},vitamin_b6:{value:.8,unit:"mg"},folate:{value:80,unit:"mcg"}},mealType:"Lunch",time:"12:30 PM",date:e,longCovidAdjust:h.hasLongCovid,longCovidBenefits:["Complete protein","Anti-inflammatory nutrients"],longCovidCautions:[],longCovidRelevance:{antiInflammatory:"high"},metabolicEfficiency:88,createdAt:no.now()},{name:"Grilled Salmon with Sweet Potato",protein:38,carbs:30,fat:28,calories:520,serving:250,micronutrients:{vitamin_d:{value:15,unit:"mcg"},vitamin_b12:{value:3.2,unit:"mcg"},selenium:{value:45,unit:"mcg"},vitamin_a:{value:300,unit:"mcg"}},mealType:"Dinner",time:"7:00 PM",date:e,longCovidAdjust:h.hasLongCovid,longCovidBenefits:["Omega-3 fatty acids","High vitamin D","Anti-inflammatory"],longCovidCautions:[],longCovidRelevance:{antiInflammatory:"high",brainFogImpact:"positive",energyImpact:"positive"},metabolicEfficiency:90,createdAt:no.now()}];try{const e=n.map((e=>em(Kf(am,"users",c.id,"food_journal"),e)));await Promise.all(e),V(n.map(((e,t)=>Le({id:"sample_".concat(t)},e)))),console.log("Sample food data created successfully")}catch(M){console.error("Error creating sample data:",M),V(n.map(((e,t)=>Le({id:"sample_".concat(t)},e))))}}),[c,h.hasLongCovid]),ae=(0,i.useCallback)((async()=>{if(c&&c.id)try{const e=jp(Kf(am,"users",c.id,"food_journal"),Lp("date","desc"),Lp("createdAt","desc"),Fp(20)),t=(await Jp(e)).docs.map((e=>Le({id:e.id},e.data())));t.length>0?V(t):await ie()}catch(M){console.error("Error initializing food log data:",M),await ie()}}),[c,ie]);(0,i.useEffect)((()=>{c&&c.id&&!f&&ae()}),[c,f,ae]);const se=e=>{let{foodName:t,mealData:n}=e;if(n&&(n.longCovidRelevance||n.longCovidBenefits||n.longCovidCautions)){const e=n.longCovidRelevance||{},r=n.longCovidBenefits||[],i=n.longCovidCautions||[],a=n.functionalCompounds||{};let s="neutral";r.length>i.length&&(s="beneficial"),i.length>r.length&&(s="caution");const o=e.antiInflammatory||"unknown";return(0,sm.jsxs)("div",{className:"long-covid-food-info ".concat(s),children:[(0,sm.jsxs)("div",{className:"food-info-header",children:[(0,sm.jsx)("span",{className:"category-icon ".concat(s),children:"beneficial"===s?"\u2705":"caution"===s?"\u26a0\ufe0f":"\u2139\ufe0f"}),(0,sm.jsxs)("strong",{children:["Database Analysis: ",t]})]}),(0,sm.jsxs)("div",{className:"inflammatory-level",children:[(0,sm.jsx)("h5",{children:"\ud83d\udd25 Anti-Inflammatory Level"}),(0,sm.jsxs)("div",{className:"level-indicator level-".concat(o),children:[(0,sm.jsxs)("span",{className:"level-value",children:[" ",o.toUpperCase()]}),(0,sm.jsx)("span",{className:"level-description",children:"high"===o?"Excellent for reducing inflammation":"moderate"===o?"Moderately helpful for inflammation":"low"===o?"Limited anti-inflammatory effects":"neutral"===o?"No significant inflammatory impact":"Not assessed"})]})]}),Object.keys(a).length>0&&(0,sm.jsxs)("div",{className:"functional-compounds",children:[(0,sm.jsx)("h5",{children:"\ud83e\uddec Functional Compounds"}),(0,sm.jsx)("div",{className:"compounds-grid",children:Object.entries(a).map((e=>{let[t,n]=e;return(0,sm.jsxs)("div",{className:"compound-item",children:[(0,sm.jsx)("span",{className:"compound-name",children:t.replace(/_/g," ")}),(0,sm.jsxs)("span",{className:"compound-level level-".concat(n),children:[" ",n]})]},t)}))})]}),r.length>0&&(0,sm.jsxs)("div",{className:"benefits-list",children:[(0,sm.jsx)("h5",{children:"\u2728 Benefits for Long COVID Recovery"}),(0,sm.jsx)("ul",{children:r.map(((e,t)=>(0,sm.jsx)("li",{children:e},t)))})]}),i.length>0&&(0,sm.jsxs)("div",{className:"cautions-list",children:[(0,sm.jsx)("h5",{children:"\u26a0\ufe0f Important Considerations"}),(0,sm.jsx)("ul",{children:i.map(((e,t)=>(0,sm.jsx)("li",{children:e},t)))})]})]})}return(0,sm.jsxs)("div",{className:"no-food-info",children:[(0,sm.jsx)("div",{className:"no-data-icon",children:"\ud83d\udcca"}),(0,sm.jsx)("h4",{children:"No Long COVID Data Available"}),(0,sm.jsx)("p",{children:"This food doesn't have specific Long COVID information in our database yet."}),(0,sm.jsx)("p",{children:"Consider general anti-inflammatory principles:"}),(0,sm.jsxs)("ul",{className:"general-tips",children:[(0,sm.jsx)("li",{children:"Choose whole, unprocessed versions when possible"}),(0,sm.jsx)("li",{children:"Pay attention to how it affects your symptoms"}),(0,sm.jsx)("li",{children:"Consider portion sizes and frequency"}),(0,sm.jsx)("li",{children:"Pair with known anti-inflammatory foods"})]})]})},oe=e=>{let{selectedFood:t,selectedMeal:n,foodLog:r=[],isSearching:i=!1,searchTerm:a=""}=e;return t&&n?(0,sm.jsxs)("div",{className:"long-covid-side-panel",children:[(0,sm.jsx)("h3",{children:"\ud83e\udda0 Long COVID Nutrition Guide"}),(0,sm.jsxs)("div",{className:"selected-food-analysis",children:[(0,sm.jsx)(se,{foodName:t,mealData:n}),(0,sm.jsx)("div",{className:"back-to-guide",children:(0,sm.jsx)("p",{className:"guide-hint",children:(0,sm.jsx)("em",{children:"Clear selection to see the full nutrition guide"})})})]})]}):i&&a.length>=2?(0,sm.jsxs)("div",{className:"long-covid-side-panel",children:[(0,sm.jsx)("h3",{children:"\ud83e\udda0 Long COVID Nutrition Guide"}),(0,sm.jsx)("div",{className:"search-status",children:(0,sm.jsx)("p",{className:"search-hint",children:(0,sm.jsxs)("em",{children:['Searching for "',a,'"... Select a food above to see its specific analysis.']})})}),(0,sm.jsx)("div",{className:"nutrition-categories",children:(0,sm.jsxs)("div",{className:"category-section beneficial",children:[(0,sm.jsx)("h4",{children:"\u2705 Quick Anti-Inflammatory Guide"}),(0,sm.jsx)("p",{children:"Focus on omega-3 rich fish, berries, leafy greens, and anti-inflammatory spices."})]})})]}):(0,sm.jsxs)("div",{className:"long-covid-side-panel",children:[(0,sm.jsx)("h3",{children:"\ud83e\udda0 Long COVID Nutrition Guide"}),(0,sm.jsxs)("div",{className:"nutrition-categories",children:[(0,sm.jsxs)("div",{className:"category-section beneficial",children:[(0,sm.jsx)("h4",{children:"\u2705 Anti-Inflammatory Foods"}),(0,sm.jsxs)("ul",{children:[(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Fatty Fish:"})," Salmon, mackerel, sardines (omega-3s)"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Berries:"})," Blueberries, strawberries (antioxidants)"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Leafy Greens:"})," Spinach, kale (vitamins, minerals)"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Nuts:"})," Walnuts, almonds (healthy fats)"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Turmeric:"})," Contains curcumin (anti-inflammatory)"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Ginger:"})," Natural anti-inflammatory"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Green Tea:"})," Polyphenols reduce inflammation"]})]})]}),(0,sm.jsxs)("div",{className:"category-section neutral",children:[(0,sm.jsx)("h4",{children:"\u2139\ufe0f Recommended Foods"}),(0,sm.jsxs)("ul",{children:[(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Whole Grains:"})," Oats, quinoa, brown rice"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Lean Proteins:"})," Chicken, turkey, legumes"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Citrus Fruits:"})," High in vitamin C"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Olive Oil:"})," Monounsaturated fats"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Garlic & Onions:"})," Immune support"]})]})]}),(0,sm.jsxs)("div",{className:"category-section caution",children:[(0,sm.jsx)("h4",{children:"\u26a0\ufe0f Foods to Limit"}),(0,sm.jsxs)("ul",{children:[(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Processed Foods:"})," High in inflammation-promoting ingredients"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Refined Sugars:"})," Can worsen inflammation"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Red/Processed Meat:"})," May increase inflammatory markers"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Trans Fats:"})," Found in margarine, processed foods"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Refined Carbs:"})," White bread, pastries"]}),(0,sm.jsxs)("li",{children:[(0,sm.jsx)("strong",{children:"Fried Foods:"})," High in inflammatory compounds"]})]})]})]}),(0,sm.jsxs)("div",{className:"additional-tips",children:[(0,sm.jsx)("h4",{children:"\ud83d\udca1 General Tips"}),(0,sm.jsxs)("ul",{children:[(0,sm.jsx)("li",{children:"Stay well hydrated (8+ glasses water daily)"}),(0,sm.jsx)("li",{children:"Consider vitamin D supplementation"}),(0,sm.jsx)("li",{children:"Eat regular, smaller meals to maintain energy"}),(0,sm.jsx)("li",{children:"Focus on nutrient-dense, whole foods"}),(0,sm.jsx)("li",{children:"Limit alcohol and caffeine if they worsen symptoms"})]})]})]})},le=e=>{const t=e.toLowerCase();return["salmon","mackerel","sardines","tuna","trout","blueberries","strawberries","raspberries","blackberries","spinach","kale","broccoli","brussels sprouts","walnuts","almonds","chia seeds","flax seeds","turmeric","ginger","garlic","onion","olive oil","avocado","sweet potato","green tea","dark chocolate"].some((e=>t.includes(e)))?"beneficial":["processed meat","bacon","sausage","hot dog","french fries","fried chicken","fried","white bread","white rice","pastry","candy","soda","sugar","margarine","ice cream","chips"].some((e=>t.includes(e)))?"caution":"neutral"},ce=e=>{const t=e.time,n=t.match(/(\d+):/),r=n?parseInt(n[1],10):12,i=t.toLowerCase().includes("pm");let a=r;i&&12!==r&&(a+=12),i||12!==r||(a=0);const s=.2*(parseFloat(e.protein)||0),o=.1*(parseFloat(e.carbs)||0),l=.15*(parseFloat(e.fat)||0);let c=1;a<6||a>20?c=.7:a>=7&&a<=10?c=1.2:a>=17&&a<=19&&(c=.9);const u={Breakfast:1.3,"Morning Snack":.9,Lunch:1.1,"Afternoon Snack":.8,Dinner:.9,"Late Night Snack":.6,Snack:.8}[e.mealType]||1;let d=Math.min(100,10*(s+o+l))*c*u;if(e.longCovidAdjust&&null!==h&&void 0!==h&&h.hasLongCovid){d*={mild:.95,moderate:.85,severe:.75,"very severe":.65}[h.longCovidSeverity]||.85,e.longCovidBenefits&&e.longCovidBenefits.length>0&&(d*=1.1),e.longCovidCautions&&e.longCovidCautions.length>0&&(d*=.9)}return Math.min(100,Math.max(0,d))},ue=((e,t)=>{const[n,r]=(0,i.useState)(e);return(0,i.useEffect)((()=>{const n=setTimeout((()=>{r(e)}),t);return()=>clearTimeout(n)}),[e,t]),n})(v,300),he=(0,i.useCallback)((async()=>{const e=v.toLowerCase().trim();if(e.length<2)return void w([]);if(Z[e])return void w(Z[e]);const t=(e,t)=>{const n=(e.name||"").toLowerCase(),r=(e.category||"").toLowerCase(),i=(e.description||"").toLowerCase();let a=0;n===t?a+=1:n.startsWith(t)?a+=.8:n.includes(t)&&(a+=.6),r.includes(t)&&(a+=.3),i.includes(t)&&(a+=.2);const s=n.split(" "),o=t.split(" ");let l=0;return o.forEach((e=>{s.forEach((t=>{t.startsWith(e)&&l++}))})),a+=l/Math.max(o.length,1)*.4,a},i=(e,n)=>n.filter((t=>{if(!t.name)return!1;const n=t.name.toLowerCase(),r=(t.category||"").toLowerCase(),i=(t.description||"").toLowerCase(),a=(t.longCovidBenefits||[]).join(" ").toLowerCase();return n.includes(e)||n.startsWith(e)||r.includes(e)||i.includes(e)||a.includes(e)||n.split(" ").some((t=>t.startsWith(e)))})).map((n=>Le(Le({},n),{},{searchMethod:"javascript",searchScore:t(n,e)}))).sort(((t,n)=>{const r=(t.name||"").toLowerCase(),i=(n.name||"").toLowerCase();return r===e&&i!==e?-1:i===e&&r!==e?1:r.startsWith(e)&&!i.startsWith(e)?-1:i.startsWith(e)&&!r.startsWith(e)?1:(n.searchScore||0)-(t.searchScore||0)})).slice(0,15);try{console.log('\ud83d\udd0d Enhanced search for: "'.concat(e,'"'));let t=n;if(0===t.length){console.log("\ud83d\udce5 Fetching food database...");const e=jp(Kf(am,"meals"),Fp(500));if(t=(await Jp(e)).docs.map((e=>Le({id:e.id},e.data()))),r(t),console.log("\ud83d\udcca Loaded ".concat(t.length," foods into cache")),window.pyodideReady&&!o)try{console.log("\ud83c\udfd7\ufe0f Building search index...");const e=await window.pyodide.runPython("\n            result = search_engine.build_index('".concat(JSON.stringify(t).replace(/'/g,"\\'"),"')\n            result\n          "));l(!0),window.searchIndexBuilt=!0,console.log("\u2705 Search index built:",e)}catch(M){console.error("\u274c Error building Python index:",M)}}let a=[];if(window.pyodideReady&&o)try{console.log("\ud83d\ude80 Using AI-powered search");const t=await window.pyodide.runPython('\n          results = search_engine.search("'.concat(e.replace(/"/g,'\\"'),'", 15)\n          json.dumps(results)\n        '));a=JSON.parse(t),console.log("\ud83c\udfaf AI search returned ".concat(a.length," results")),a=a.map((e=>Le(Le({},e),{},{searchMethod:"ai",searchScore:e.search_score||0})))}catch(M){console.error("\u274c Python search failed, using fallback:",M),a=i(e,t)}else console.log("\ud83d\udcdd Using fallback JavaScript search"),a=i(e,t);te((t=>Le(Le({},t),{},{[e]:a}))),w(a)}catch(a){console.error("\u274c Search error:",a),w([])}}),[v,Z,n,o]);(0,i.useEffect)((()=>{const e=()=>{window.pyodideReady?s("ready"):window.pyodide?s("loading"):s("unavailable")};e();const t=()=>{s("ready"),console.log("\ud83c\udf89 Pyodide ready event received")},n=()=>{s("unavailable"),console.log("\u26a0\ufe0f Pyodide error event received")};window.addEventListener("pyodideReady",t),window.addEventListener("pyodideError",n);const r=setInterval(e,2e3);return()=>{window.removeEventListener("pyodideReady",t),window.removeEventListener("pyodideError",n),clearInterval(r)}}),[]),(0,i.useEffect)((()=>{ue.length<2?w([]):he()}),[ue,he]);const de=e=>{var t,n,r,i,a;x(e),y(e.name),w([]);const s=(null===(t=e.nutrients)||void 0===t?void 0:t.per100g)||{};k({name:e.name,protein:(null===(n=s.protein)||void 0===n?void 0:n.value)||"",carbs:(null===(r=s.carbs)||void 0===r?void 0:r.value)||"",fat:(null===(i=s.fat)||void 0===i?void 0:i.value)||"",calories:(null===(a=s.calories)||void 0===a?void 0:a.value)||"",serving:100,micronutrients:s,longCovidBenefits:e.longCovidBenefits||[],longCovidCautions:e.longCovidCautions||[],longCovidRelevance:e.longCovidRelevance||{}})},fe=e=>{const{name:t,value:n}=e.target;"serving"===t?(k((e=>Le(Le({},e),{},{[t]:n}))),(e=>{var t;if(!_||null===(t=_.nutrients)||void 0===t||!t.per100g)return;const n=parseFloat(e)/100;isNaN(n)||k((e=>{var t,r,i,a;const s=Le({},e),o=_.nutrients.per100g;return s.protein=((null===(t=o.protein)||void 0===t?void 0:t.value)*n).toFixed(1),s.carbs=((null===(r=o.carbs)||void 0===r?void 0:r.value)*n).toFixed(1),s.fat=((null===(i=o.fat)||void 0===i?void 0:i.value)*n).toFixed(1),s.calories=((null===(a=o.calories)||void 0===a?void 0:a.value)*n).toFixed(0),s.micronutrients={},Object.entries(o).forEach((e=>{let[t,r]=e;["protein","carbs","fat","calories","name","unit"].includes(t)||(s.micronutrients[t]=Le(Le({},r),{},{value:(r.value*n).toFixed(1)}))})),s}))})(n)):k((e=>Le(Le({},e),{},{[t]:n})))},pe=(0,i.useCallback)((async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(c&&c.id){B(!0),1===e&&V([]),H("");try{const t=jp(Kf(am,"users",c.id,"food_journal"),Lp("date","desc"),Lp("createdAt","desc"),Fp(20*e)),n=(await Jp(t)).docs.map((e=>Le({id:e.id},e.data())));V(n),G(e)}catch(t){console.error("Error fetching food log:",t),H("Failed to load journal: ".concat(t.message))}finally{B(!1)}}}),[c]);(0,i.useEffect)((()=>{"Food Journal"===m&&c&&pe(1)}),[m,c,pe]);const me=()=>{t("/dashboard")};return f?(0,sm.jsx)("div",{className:"food-tracker-container",children:(0,sm.jsx)("div",{className:"loading-indicator",children:"Loading..."})}):c?(0,sm.jsxs)("div",{className:"food-tracker-container",children:[Y&&(0,sm.jsx)(ne,{entryId:Y,entryName:(null===(e=U.find((e=>e.id===Y)))||void 0===e?void 0:e.name)||"Unknown",onConfirm:async e=>{if(c&&e){$(!0),H("");try{await(t=Qf(am,"users",c.id,"food_journal",e),tm(Uf(t.firestore,Xf),[new Yc(t._key,Lc.none())])),V((t=>t.filter((t=>t.id!==e)))),L("Food entry deleted successfully!"),setTimeout((()=>L("")),3e3)}catch(n){console.error("Error deleting entry:",n),H("Failed to delete entry: ".concat(n.message))}finally{$(!1),X(null)}var t}},onCancel:()=>X(null)}),(0,sm.jsxs)("div",{className:"tracker-header",children:[(0,sm.jsx)("button",{onClick:me,className:"back-button",children:"\u2190 Back to Dashboard"}),(0,sm.jsx)("button",{onClick:async()=>{console.log("Logout clicked - starting complete logout process");try{console.log("Clearing localStorage userData"),localStorage.removeItem("userData"),sessionStorage.clear(),console.log("Cleared sessionStorage"),u(null),p(!1),console.log("Complete logout finished, navigating to login..."),t("/login",{replace:!0})}catch(M){console.error("Error during logout:",M),localStorage.removeItem("userData"),sessionStorage.clear(),u(null),t("/login",{replace:!0})}},className:"logout-btn",children:"Logout"})]}),(0,sm.jsx)("h2",{children:"Meal Tracker"}),(0,sm.jsx)("div",{className:"food-tabs",children:Bw.map((e=>(0,sm.jsx)("button",{className:"food-tab".concat(m===e?" active":""),onClick:()=>g(e),children:e},e)))}),"Add Food"===m&&(0,sm.jsxs)("div",{className:"food-form-section",children:[(0,sm.jsxs)("div",{className:"food-form-left",children:[K&&(0,sm.jsxs)("div",{className:"edit-mode-banner",children:[(0,sm.jsxs)("div",{className:"edit-indicator",children:[(0,sm.jsx)("span",{className:"edit-icon",children:"\u270f\ufe0f"}),(0,sm.jsxs)("span",{className:"edit-text",children:[(0,sm.jsx)("strong",{children:"Editing:"})," ",K.name]})]}),(0,sm.jsx)("button",{className:"cancel-edit-btn",onClick:()=>{Q(null),k({}),x(null),y(""),L(""),F("")},type:"button",children:"Cancel Edit"})]}),(0,sm.jsxs)("div",{className:"form-group long-covid-checkbox-group",children:[(0,sm.jsxs)("label",{className:"long-covid-checkbox-label",children:[(0,sm.jsx)("input",{type:"checkbox",checked:j,onChange:e=>D(e.target.checked),className:"long-covid-checkbox"}),(0,sm.jsx)("span",{className:"checkbox-text",children:"I have Long COVID - Show food recommendations and adjustments"})]}),j&&(0,sm.jsx)("div",{className:"long-covid-info-banner",children:(0,sm.jsxs)("p",{children:["\ud83d\udd2c ",(0,sm.jsx)("strong",{children:"Long COVID Mode:"})," Food recommendations will be adjusted to focus on anti-inflammatory options that may help manage symptoms and support recovery."]})})]}),(0,sm.jsxs)("div",{className:"form-group search-group",children:[(0,sm.jsx)("label",{children:"Search Food"}),(0,sm.jsxs)("div",{className:"search-input-container",children:[(0,sm.jsx)("input",{type:"text",value:v,onChange:e=>{y(e.target.value),x(null)},placeholder:"ready"===a?"AI-powered search ready...":"loading"===a?"Loading AI search...":"Search foods...",autoComplete:"off",className:"search-input enhanced-search"}),(0,sm.jsxs)("div",{className:"search-status ".concat(a),children:["ready"===a&&o&&(0,sm.jsx)("span",{className:"status-ready",children:"\ud83d\ude80 AI Search Active"}),"ready"===a&&!o&&(0,sm.jsx)("span",{className:"status-indexing",children:"\u26a1 Building Index..."}),"loading"===a&&(0,sm.jsx)("span",{className:"status-loading",children:"\ud83d\udd04 Loading AI..."}),"unavailable"===a&&(0,sm.jsx)("span",{className:"status-basic",children:"\ud83d\udcdd Basic Search"}),b.length>0&&(0,sm.jsxs)("span",{className:"result-count",children:["(",b.length," results)"]})]})]}),b.length>0&&(0,sm.jsx)("ul",{className:"suggestions-list enhanced",children:b.map(((e,t)=>(0,sm.jsxs)("li",{onClick:()=>de(e),children:[(0,sm.jsxs)("div",{className:"suggestion-main",children:[(0,sm.jsx)("div",{className:"suggestion-name",children:e.name}),e.category&&(0,sm.jsx)("div",{className:"suggestion-category",children:e.category}),(0,sm.jsxs)("div",{className:"suggestion-meta",children:[e.searchScore&&(0,sm.jsxs)("span",{className:"search-score",children:[(100*e.searchScore).toFixed(0),"% match"]}),"ai"===e.searchMethod&&(0,sm.jsx)("span",{className:"ai-badge",children:"AI"}),e.match_type&&(0,sm.jsx)("span",{className:"match-type",children:e.match_type})]})]}),(0,sm.jsx)("div",{className:"suggestion-indicators",children:j&&(0,sm.jsx)("span",{className:"covid-indicator ".concat(le(e.name)),children:"beneficial"===le(e.name)?"\u2705":"caution"===le(e.name)?"\u26a0\ufe0f":"\u2139\ufe0f"})})]},e.id||t)))})]}),(0,sm.jsxs)("div",{className:"form-row",children:[(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{children:"Protein (g)"}),(0,sm.jsx)("input",{name:"protein",value:S.protein||"",onChange:fe,type:"number",step:"0.1"})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{children:"Carbs (g)"}),(0,sm.jsx)("input",{name:"carbs",value:S.carbs||"",onChange:fe,type:"number",step:"0.1"})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{children:"Fat (g)"}),(0,sm.jsx)("input",{name:"fat",value:S.fat||"",onChange:fe,type:"number",step:"0.1"})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{children:"Serving (g)"}),(0,sm.jsx)("input",{name:"serving",value:S.serving||"",onChange:fe,type:"number",step:"1",className:"serving-input"})]})]}),(0,sm.jsxs)("div",{className:"form-row",children:[(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{children:"Meal Type"}),(0,sm.jsx)("select",{value:E,onChange:e=>C(e.target.value),children:zw.map((e=>(0,sm.jsx)("option",{value:e,children:e},e)))})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{children:"Time"}),(0,sm.jsx)("input",{type:"time",value:(e=>{if(!e)return"";const[t,n]=e.split(" ");if(!t||!n)return e;let[r,i]=t.split(":");return"12"===r&&(r="00"),"PM"===n&&(r=String(parseInt(r,10)+12)),r=String(r),"".concat(r.padStart(2,"0"),":").concat(i)})(N),onChange:e=>{const t=e.target.value;if(!t)return;const n=new Date("2000-01-01T".concat(t)).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});T(n)}})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{children:"Date"}),(0,sm.jsx)("input",{type:"date",value:I,onChange:e=>A(e.target.value)})]})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("label",{children:"Calories"}),(0,sm.jsx)("input",{name:"calories",value:S.calories||"",onChange:fe,type:"number",step:"1"})]}),(0,sm.jsxs)("div",{className:"form-group",children:[(0,sm.jsx)("button",{className:"submit-button ".concat(K?"update-mode":""),onClick:async()=>{if(c&&c.id){R(!0),F(""),L("");try{if(!S.name)throw new Error("Food name is required");const e={name:S.name,protein:parseFloat(S.protein)||0,carbs:parseFloat(S.carbs)||0,fat:parseFloat(S.fat)||0,calories:parseFloat(S.calories)||0,serving:parseFloat(S.serving)||100,micronutrients:S.micronutrients||{},mealType:E,time:N,date:I,longCovidAdjust:j,longCovidBenefits:S.longCovidBenefits||[],longCovidCautions:S.longCovidCautions||[],longCovidRelevance:S.longCovidRelevance||{},mealId:(null===_||void 0===_?void 0:_.id)||null};if(e.metabolicEfficiency=ce(e),K)await Zp(Qf(am,"users",c.id,"food_journal",K.id),Le(Le({},e),{},{updatedAt:no.now()})),V((t=>t.map((t=>t.id===K.id?Le(Le(Le({},t),e),{},{id:K.id}):t)))),L("Food entry updated successfully!"),Q(null);else{e.createdAt=no.now();const t=Le({id:(await em(Kf(am,"users",c.id,"food_journal"),e)).id},e);V((e=>[t,...e])),L("Food logged successfully!")}k({}),x(null),y("")}catch(e){console.error("Error logging food:",e),F("Failed to ".concat(K?"update":"log"," food: ").concat(e.message))}finally{R(!1)}}else F("Please log in to save your meals")},disabled:P||!S.name,children:P?K?"Updating...":"Logging...":K?"Update Food":"Log Food"}),O&&(0,sm.jsx)("div",{className:"success-message",children:O}),M&&(0,sm.jsx)("div",{className:"error-message",children:M})]})]}),(0,sm.jsxs)("div",{className:"food-form-right",children:[j&&(0,sm.jsx)(oe,{selectedFood:S.name,selectedMeal:_,foodLog:U,isSearching:v.length>=2&&!_,searchTerm:v}),!j&&(0,sm.jsxs)("div",{className:"general-nutrition-info",children:[(0,sm.jsx)("h3",{children:"\ud83d\udcca Nutrition Tips"}),(0,sm.jsx)("p",{children:"Enable Long COVID mode above to get personalized food recommendations and anti-inflammatory guidance."})]})]})]}),"Food Journal"===m&&(0,sm.jsxs)("div",{className:"food-journal-section",children:[(0,sm.jsxs)("div",{className:"journal-header",children:[(0,sm.jsx)("h3",{children:"Your Food Journal"}),(0,sm.jsx)("button",{className:"refresh-button",onClick:()=>pe(1),disabled:z,children:z?"Loading...":"Refresh"})]}),q&&(0,sm.jsx)("div",{className:"error-message",children:q}),O&&(0,sm.jsx)("div",{className:"success-message",children:O}),z&&0===U.length?(0,sm.jsx)("div",{className:"loading-indicator",children:"Loading your food journal..."}):0===U.length?(0,sm.jsxs)("div",{className:"empty-state",children:[(0,sm.jsx)("p",{children:"No entries found in your food journal."}),(0,sm.jsx)("p",{children:'Start by adding a meal in the "Add Food" tab!'})]}):(0,sm.jsxs)(sm.Fragment,{children:[(0,sm.jsx)("div",{className:"journal-summary",children:(0,sm.jsxs)("p",{children:["Showing ",U.length," meal entries"]})}),(0,sm.jsx)("div",{className:"journal-table-container",children:(0,sm.jsxs)("table",{className:"food-log-table compact",children:[(0,sm.jsx)("thead",{children:(0,sm.jsxs)("tr",{children:[(0,sm.jsx)("th",{className:"date-time-col",children:"Date/Time"}),(0,sm.jsx)("th",{className:"meal-type-col",children:"Meal"}),(0,sm.jsx)("th",{className:"food-col",children:"Food"}),(0,sm.jsx)("th",{className:"serving-col",children:"Serving"}),(0,sm.jsx)("th",{className:"macro-col",children:"P"}),(0,sm.jsx)("th",{className:"macro-col",children:"C"}),(0,sm.jsx)("th",{className:"macro-col",children:"F"}),(0,sm.jsx)("th",{className:"calories-col",children:"Cal"}),(0,sm.jsx)("th",{className:"efficiency-col",children:"Eff%"}),(0,sm.jsx)("th",{className:"actions-col",children:"Actions"})]})}),(0,sm.jsx)("tbody",{children:U.map((e=>(0,sm.jsxs)("tr",{children:[(0,sm.jsx)("td",{className:"date-time-cell",children:((e,t)=>{const n=e.split("-"),r=parseInt(n[1],10),i=parseInt(n[2],10),a=t.replace(":00","").replace(" ","");return"".concat(r,"/").concat(i," ").concat(a)})(e.date,e.time)}),(0,sm.jsx)("td",{className:"meal-type-cell",children:(0,sm.jsx)("span",{className:"meal-badge ".concat((e.mealType||"unknown").trim().toLowerCase().replace(/\s+/g,"-")),children:(e=>{switch(e){case"Breakfast":return"B";case"Morning Snack":return"MS";case"Lunch":return"L";case"Afternoon Snack":return"AS";case"Dinner":return"D";case"Late Night Snack":return"LN";case"Snack":return"S";default:return e.charAt(0)}})(e.mealType||"Unknown")})}),(0,sm.jsx)("td",{className:"food-cell",title:e.name,children:e.name.length>20?"".concat(e.name.substring(0,20),"..."):e.name}),(0,sm.jsxs)("td",{className:"serving-cell",children:[e.serving||"0","g"]}),(0,sm.jsx)("td",{className:"macro-cell",children:"number"===typeof e.protein?e.protein.toFixed(1):e.protein||"0"}),(0,sm.jsx)("td",{className:"macro-cell",children:"number"===typeof e.carbs?e.carbs.toFixed(1):e.carbs||"0"}),(0,sm.jsx)("td",{className:"macro-cell",children:"number"===typeof e.fat?e.fat.toFixed(1):e.fat||"0"}),(0,sm.jsx)("td",{className:"calories-cell",children:e.calories||"0"}),(0,sm.jsx)("td",{className:"efficiency-cell",children:(0,sm.jsx)("span",{className:"efficiency-badge ".concat("number"===typeof e.metabolicEfficiency?e.metabolicEfficiency>=80?"high":e.metabolicEfficiency>=60?"medium":"low":"unknown"),children:"number"===typeof e.metabolicEfficiency?e.metabolicEfficiency.toFixed(0):"N/A"})}),(0,sm.jsx)("td",{className:"actions-cell",children:(0,sm.jsxs)("div",{className:"action-buttons compact",children:[(0,sm.jsx)("button",{className:"edit-btn compact",onClick:()=>(e=>{k({name:e.name,protein:e.protein,carbs:e.carbs,fat:e.fat,calories:e.calories,serving:e.serving||100,micronutrients:e.micronutrients||{},longCovidBenefits:e.longCovidBenefits||[],longCovidCautions:e.longCovidCautions||[],longCovidRelevance:e.longCovidRelevance||{}}),C(e.mealType),T(e.time),A(e.date),D(e.longCovidAdjust||!1),y(e.name),Q(e),g("Add Food")})(e),title:"Edit entry",children:"\u270f\ufe0f"}),(0,sm.jsx)("button",{className:"delete-btn compact",onClick:()=>X(e.id),title:"Delete entry",children:"\ud83d\uddd1\ufe0f"})]})})]},e.id)))})]})}),U.length>=20*W&&(0,sm.jsx)("div",{className:"load-more-container",children:(0,sm.jsx)("button",{className:"load-more-button",onClick:()=>pe(W+1),disabled:z,children:z?"Loading...":"Load More Entries"})})]})]}),"Analysis"===m&&(0,sm.jsx)(Vw,{foodLog:U,userProfile:h})]}):(0,sm.jsx)("div",{className:"food-tracker-container",children:(0,sm.jsxs)("div",{className:"auth-required",children:[(0,sm.jsx)("h2",{children:"Authentication Required"}),(0,sm.jsx)("p",{children:"Please log in to use the food tracker."}),(0,sm.jsx)("button",{onClick:me,className:"back-button",children:"Back to Dashboard"})]})})},Hw=()=>{var e,t,n,r,a,s,o;const[l,c]=(0,i.useState)(null),[u,h]=(0,i.useState)(null),[d,f]=(0,i.useState)(null),[p,m]=(0,i.useState)(!0),[g,v]=(0,i.useState)(!1),[y,b]=(0,i.useState)(""),[w,_]=(0,i.useState)("checking"),x=ee(),S=$(),k="https://6zfuwxqp01.execute-api.us-east-1.amazonaws.com/dev",E=(0,i.useCallback)((async function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{console.log("\ud83d\udd04 Fetching fresh Fitbit data..."),m(!0),b("");const i=null===u||void 0===u?void 0:u.fitbitData,a=(null===i||void 0===i?void 0:i.tokenExpiresAt)&&new Date>new Date(i.tokenExpiresAt);let s=e;if(a&&n)try{console.log("\ud83d\udd04 Token expired, refreshing...");const e=await(async e=>{console.log("\ud83d\udd04 Refreshing Fitbit token...");try{const t=await fetch("".concat(k,"/refresh"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:e})});if(!t.ok){const e=await t.text();throw new Error("Token refresh failed (".concat(t.status,"): ").concat(e))}const n=await t.json();return console.log("\u2705 Token refreshed successfully"),{accessToken:n.access_token,refreshToken:n.refresh_token,expiresIn:n.expires_in,tokenExpiresAt:new Date(Date.now()+1e3*n.expires_in).toISOString()}}catch(y){throw console.error("\u274c Error refreshing token:",y),y}})(n);await $p(Qf(am,"users",t),{fitbitData:Le(Le({},i),{},{accessToken:e.accessToken,refreshToken:e.refreshToken,tokenExpiresAt:e.tokenExpiresAt})},{merge:!0}),h((t=>Le(Le({},t),{},{fitbitData:Le(Le({},t.fitbitData),{},{accessToken:e.accessToken,refreshToken:e.refreshToken,tokenExpiresAt:e.tokenExpiresAt})}))),s=e.accessToken,console.log("\u2705 Token refreshed and saved")}catch(r){return console.error("\u274c Token refresh failed:",r),b("Your Fitbit connection has expired. Please reconnect your account."),void _("needs_connection")}const o=await(async e=>{console.log("\ud83d\udce1 Fetching Fitbit data from serverless API...");try{const t=await fetch("".concat(k,"/fitbit"),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){const e=await t.text();throw new Error("API request failed (".concat(t.status,"): ").concat(e))}const n=await t.json();return console.log("\u2705 Data received from serverless API:",n),{heartRate:n.heartRate||null,steps:n.steps||0,calories:n.calories||0,distance:n.distance||0,activeMinutes:n.activeMinutes||0,sleep:n.sleep||null,weight:n.weight||null,date:n.date||(new Date).toISOString().split("T")[0],lastSync:(new Date).toISOString()}}catch(y){throw console.error("\u274c Error fetching from serverless API:",y),new Error("Failed to fetch Fitbit data: ".concat(y.message))}})(s),l=Le(Le({},o),{},{date:(new Date).toISOString().split("T")[0],lastSync:(new Date).toISOString()});await $p(Qf(am,"users",t),{latestFitbitData:l,lastUpdated:(new Date).toISOString()},{merge:!0}),f(l),console.log("\u2705 Fitbit data updated successfully")}catch(i){console.error("\u274c Error fetching Fitbit data:",i),i.message.includes("401")||i.message.includes("Unauthorized")?(b("Your Fitbit connection has expired. Please reconnect your account."),_("needs_connection")):b("Failed to fetch Fitbit data: ".concat(i.message))}finally{m(!1)}}),[null===u||void 0===u?void 0:u.fitbitData]),C=(0,i.useCallback)((async e=>{try{m(!0),console.log("\ud83d\udcca Loading user data for:",e);const r=await Yp(Qf(am,"users",e));if(r.exists()){var t,n;const e=r.data();console.log("\u2705 User data loaded:",e.email),console.log("\ud83d\udd17 Has Fitbit tokens:",!(null===(t=e.fitbitData)||void 0===t||!t.accessToken)),h(e),null!==(n=e.fitbitData)&&void 0!==n&&n.accessToken?(_("connected"),e.latestFitbitData&&f(e.latestFitbitData)):_("needs_connection")}else b("User profile not found. Please contact support."),_("error")}catch(r){console.error("\u274c Error loading user data:",r),b("Failed to load user data: ".concat(r.message)),_("error")}finally{m(!1)}}),[]),N=(0,i.useCallback)((async(e,t)=>{try{v(!0),b("");if(t!==sessionStorage.getItem("fitbitOAuthState"))throw new Error("Security validation failed. Please try again.");console.log("\ud83d\udd04 Processing OAuth callback with secure backend...");const n=await(async e=>{console.log("\ud83d\udd27 Starting secure token exchange...");const t=window.location.origin+window.location.pathname;try{console.log("\ud83d\udce1 Calling serverless token exchange endpoint...");const n=await fetch("".concat(k,"/token-exchange"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e,redirect_uri:t})});if(!n.ok){const e=await n.text();throw console.error("\u274c Token exchange failed:",e),new Error("Token exchange failed (".concat(n.status,"): ").concat(e))}const r=await n.json();return console.log("\u2705 Token exchange successful via secure backend!"),r}catch(n){throw console.error("\u274c Error during secure token exchange:",n),new Error("Token exchange failed: ".concat(n.message))}})(e);console.log("\u2705 Token exchange successful! Saving connection...");const r={accessToken:n.access_token,refreshToken:n.refresh_token,tokenExpiresAt:new Date(Date.now()+1e3*n.expires_in).toISOString(),tokenType:n.token_type,scope:n.scope,connectedAt:(new Date).toISOString()};await $p(Qf(am,"users",l.uid),{fitbitData:r,deviceConnected:!0,selectedDevice:"fitbit",lastUpdated:(new Date).toISOString()},{merge:!0}),h((e=>Le(Le({},e),{},{fitbitData:r}))),_("connected"),sessionStorage.removeItem("fitbitOAuthState"),sessionStorage.removeItem("fitbitAuthStartTime"),window.history.replaceState({},document.title,window.location.pathname),console.log("\u2705 Fitbit connection completed successfully via secure backend!"),await E(n.access_token,l.uid,n.refresh_token)}catch(n){console.error("\u274c Error processing OAuth:",n),b("Failed to connect Fitbit: ".concat(n.message)),_("error")}finally{v(!1)}}),[l,E]),T=(0,i.useCallback)((()=>{var e;null!==u&&void 0!==u&&null!==(e=u.fitbitData)&&void 0!==e&&e.accessToken&&null!==l&&void 0!==l&&l.uid&&E(u.fitbitData.accessToken,l.uid,u.fitbitData.refreshToken)}),[null===u||void 0===u||null===(e=u.fitbitData)||void 0===e?void 0:e.accessToken,null===u||void 0===u||null===(t=u.fitbitData)||void 0===t?void 0:t.refreshToken,null===l||void 0===l?void 0:l.uid,E]);(0,i.useEffect)((()=>{const e=function(e,t,n,r){return Et(e).onAuthStateChanged(t,n,r)}(im,(async e=>{e?(console.log("\u2705 User authenticated:",e.uid),c(e),await C(e.uid)):(console.log("\u274c No authenticated user, redirecting to login"),x("/login"))}));return()=>e()}),[x,C]),(0,i.useEffect)((()=>{l&&S.search&&(async()=>{const e=new URLSearchParams(S.search),t=e.get("code"),n=e.get("state"),r=e.get("error");t&&n&&l?(console.log("\ud83d\udd04 Processing OAuth callback..."),await N(t,n)):r&&(b("Fitbit authorization failed: ".concat(r)),_("error"),v(!1))})()}),[l,S.search,N]);const I=e=>{let{title:t,value:n,unit:r,icon:i,color:a="#007bff"}=e;return(0,sm.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 12px rgba(0,0,0,0.1)",border:"3px solid ".concat(a),textAlign:"center"},children:[(0,sm.jsx)("div",{style:{fontSize:"32px",marginBottom:"8px"},children:i}),(0,sm.jsx)("h3",{style:{color:a,margin:"0 0 8px 0",fontSize:"18px"},children:t}),(0,sm.jsx)("div",{style:{fontSize:"32px",fontWeight:"bold",color:"#333",marginBottom:"4px"},children:n}),(0,sm.jsx)("div",{style:{color:"#666",fontSize:"14px"},children:r})]})},A=e=>{let{error:t,onRetry:n}=e;return(0,sm.jsx)("div",{style:{backgroundColor:"#f8d7da",border:"1px solid #f5c6cb",borderRadius:"8px",padding:"16px",marginBottom:"24px",color:"#721c24"},children:(0,sm.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[(0,sm.jsxs)("div",{children:[(0,sm.jsx)("strong",{children:"\u26a0\ufe0f Error:"}),(0,sm.jsx)("div",{style:{marginTop:"8px",fontSize:"14px"},children:t})]}),n&&(0,sm.jsx)("button",{onClick:n,style:{backgroundColor:"#dc3545",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",fontSize:"12px",marginLeft:"16px"},children:"Retry"})]})})};return p&&"checking"===w?(0,sm.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",backgroundColor:"#f8f9fa"},children:(0,sm.jsxs)("div",{style:{textAlign:"center"},children:[(0,sm.jsx)("div",{style:{border:"4px solid #e9ecef",borderTop:"4px solid #007bff",borderRadius:"50%",width:"50px",height:"50px",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),(0,sm.jsx)("h2",{style:{color:"#495057"},children:"Loading your dashboard..."})]})}):(0,sm.jsxs)("div",{style:{minHeight:"100vh",backgroundColor:"#f8f9fa",padding:"20px"},children:[(0,sm.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[(0,sm.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"24px",marginBottom:"24px",boxShadow:"0 2px 12px rgba(0,0,0,0.1)"},children:[(0,sm.jsx)("h1",{style:{margin:"0 0 8px 0",color:"#333"},children:"Fitbit Dashboard \ud83d\udcf1"}),(0,sm.jsxs)("p",{style:{margin:"0",color:"#666"},children:[(null===u||void 0===u?void 0:u.email)||"Loading..."," \u2022 ","connected"===w?"Connected via Secure Serverless API":"Not Connected"]})]}),y&&(0,sm.jsx)(A,{error:y,onRetry:null!==u&&void 0!==u&&null!==(n=u.fitbitData)&&void 0!==n&&n.accessToken?T:null}),"needs_connection"===w&&(0,sm.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"40px",textAlign:"center",boxShadow:"0 2px 12px rgba(0,0,0,0.1)",marginBottom:"24px"},children:[(0,sm.jsx)("h2",{style:{color:"#333",marginBottom:"16px"},children:"Connect Your Fitbit"}),(0,sm.jsx)("p",{style:{color:"#666",marginBottom:"24px",fontSize:"16px"},children:"To view your health data, we need to connect to your Fitbit account."}),(0,sm.jsx)("button",{onClick:()=>{if(null===l||void 0===l||!l.uid)return void b("User not authenticated");v(!0),b("");const e="23Q9SZ";const t=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);sessionStorage.setItem("fitbitOAuthState",t),sessionStorage.setItem("fitbitAuthStartTime",Date.now().toString());const n=window.location.origin+window.location.pathname,r="https://www.fitbit.com/oauth2/authorize?response_type=code&"+"client_id=".concat(e,"&")+"redirect_uri=".concat(encodeURIComponent(n),"&")+"scope=".concat(encodeURIComponent("activity heartrate sleep weight profile"),"&")+"state=".concat(t);console.log("\ud83d\ude80 Starting Fitbit OAuth flow"),console.log("Auth URL:",r),console.log("Redirect URI:",n),window.location.href=r},disabled:g,style:{backgroundColor:"#00B2A9",color:"white",border:"none",padding:"16px 32px",borderRadius:"8px",cursor:g?"not-allowed":"pointer",fontSize:"18px",fontWeight:"600",opacity:g?.6:1,boxShadow:"0 4px 12px rgba(0,178,169,0.3)"},children:g?"\ud83d\udd04 Connecting...":"\ud83d\udd17 Connect Fitbit"})]}),"connected"===w&&(!d||!d.steps&&!d.calories)&&(0,sm.jsxs)("div",{style:{backgroundColor:"#d4edda",border:"1px solid #c3e6cb",borderRadius:"8px",padding:"16px",marginBottom:"24px",color:"#155724"},children:[(0,sm.jsx)("strong",{children:"\ud83c\udf89 Fitbit Connected Successfully!"}),(0,sm.jsx)("br",{}),'Your Fitbit account is now linked through our secure serverless API. Click the "Refresh" button below to load your latest health data.']}),"connected"===w&&(0,sm.jsxs)(sm.Fragment,{children:[(0,sm.jsx)("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"20px",marginBottom:"24px",boxShadow:"0 2px 12px rgba(0,0,0,0.1)"},children:(0,sm.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"10px"},children:[(0,sm.jsxs)("div",{children:[(0,sm.jsx)("h3",{style:{margin:"0 0 8px 0",color:"#333"},children:"\u2705 Fitbit Connected (Secure Serverless API)"}),(0,sm.jsx)("p",{style:{margin:"0",color:"#666",fontSize:"14px"},children:null!==d&&void 0!==d&&d.lastSync?"Last sync: ".concat(new Date(d.lastSync).toLocaleString()):"Click refresh to load your data"})]}),(0,sm.jsx)("div",{style:{display:"flex",gap:"10px"},children:(0,sm.jsx)("button",{onClick:T,disabled:p,style:{backgroundColor:"#007bff",color:"white",border:"none",padding:"10px 20px",borderRadius:"6px",cursor:p?"not-allowed":"pointer",fontSize:"14px",opacity:p?.6:1},children:p?"\ud83d\udd04 Loading...":"\ud83d\udd04 Refresh"})})]})}),d&&(0,sm.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"24px"},children:[(0,sm.jsx)(I,{title:"Steps Today",value:(null===(r=d.steps)||void 0===r?void 0:r.toLocaleString())||"N/A",unit:"steps",icon:"\ud83d\udc5f",color:"#28a745"}),(0,sm.jsx)(I,{title:"Calories Burned",value:(null===(a=d.calories)||void 0===a?void 0:a.toLocaleString())||"N/A",unit:"calories",icon:"\ud83d\udd25",color:"#dc3545"}),(0,sm.jsx)(I,{title:"Distance",value:d.distance?"".concat(d.distance.toFixed(2)):"N/A",unit:"miles",icon:"\ud83d\udccf",color:"#007bff"}),(0,sm.jsx)(I,{title:"Active Minutes",value:d.activeMinutes||"N/A",unit:"minutes",icon:"\u26a1",color:"#ffc107"}),d.heartRate&&(0,sm.jsx)(I,{title:"Resting Heart Rate",value:d.heartRate,unit:"bpm",icon:"\u2764\ufe0f",color:"#e83e8c"}),d.sleep&&(0,sm.jsxs)(sm.Fragment,{children:[(0,sm.jsx)(I,{title:"Sleep Duration",value:Math.round(d.sleep.totalMinutesAsleep/60*10)/10,unit:"hours",icon:"\ud83d\ude34",color:"#6f42c1"}),(0,sm.jsx)(I,{title:"Sleep Efficiency",value:d.sleep.efficiency,unit:"%",icon:"\u2b50",color:"#20c997"})]}),d.weight&&(0,sm.jsx)(I,{title:"Weight",value:d.weight.weight,unit:"lbs",icon:"\u2696\ufe0f",color:"#fd7e14"})]})]}),(0,sm.jsxs)("div",{style:{backgroundColor:"#e7f3ff",border:"1px solid #b8daff",borderRadius:"8px",padding:"16px",marginTop:"24px",color:"#004085"},children:[(0,sm.jsx)("strong",{children:"\ud83d\udd12 Secure Serverless Deployment:"}),(0,sm.jsx)("br",{}),"This app uses secure serverless API endpoints where your Fitbit client secret is safely stored on the backend, never exposed to the frontend.",(0,sm.jsx)("br",{}),(0,sm.jsx)("strong",{children:"API:"})," ",k]}),(0,sm.jsxs)("div",{style:{backgroundColor:"#f8f9fa",border:"1px solid #dee2e6",borderRadius:"8px",padding:"16px",marginTop:"24px",fontSize:"12px",fontFamily:"monospace",color:"#495057"},children:[(0,sm.jsx)("strong",{children:"Debug Info:"}),(0,sm.jsx)("br",{}),"Status: ",w,(0,sm.jsx)("br",{}),"User ID: ",null===l||void 0===l?void 0:l.uid,(0,sm.jsx)("br",{}),"Email: ",null===u||void 0===u?void 0:u.email,(0,sm.jsx)("br",{}),"Has Fitbit Tokens: ",null!==u&&void 0!==u&&null!==(s=u.fitbitData)&&void 0!==s&&s.accessToken?"Yes":"No",(0,sm.jsx)("br",{}),"Token Expires: ",null!==u&&void 0!==u&&null!==(o=u.fitbitData)&&void 0!==o&&o.tokenExpiresAt?new Date(u.fitbitData.tokenExpiresAt).toLocaleString():"N/A",(0,sm.jsx)("br",{}),"Environment: ",window.location.hostname,(0,sm.jsx)("br",{}),"Current URL: ",window.location.href,(0,sm.jsx)("br",{}),"API Endpoint: ",k,(0,sm.jsx)("br",{}),"Deployment: Secure Serverless (AWS Lambda)"]})]}),(0,sm.jsx)("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "})]})};const Ww=function(){const e=()=>{const e=localStorage.getItem("userData");if(console.log("Checking authentication, userData exists:",!!e),!e)return!1;try{const t=JSON.parse(e);return console.log("Parsed user ID:",t.id),t&&t.id}catch(t){return console.error("Error parsing user data:",t),!1}},t=t=>{let{children:n}=t;const r=e();return console.log("ProtectedRoute - isAuthenticated:",r),r?n:(0,sm.jsx)(me,{to:"/login",replace:!0})},n=t=>{let{children:n}=t;const r=e();return console.log("PublicRoute - isAuthenticated:",r),r?(0,sm.jsx)(me,{to:"/dashboard",replace:!0}):n};return console.log("App rendering, checking routes..."),(0,sm.jsx)(Ce,{basename:"/energy_balance",children:(0,sm.jsx)("div",{className:"App",children:(0,sm.jsxs)(ye,{children:[(0,sm.jsx)(ge,{path:"/login",element:(0,sm.jsx)(n,{children:(0,sm.jsx)(Tw,{})})}),(0,sm.jsx)(ge,{path:"/register",element:(0,sm.jsx)(n,{children:(0,sm.jsx)(hm,{})})}),(0,sm.jsx)(ge,{path:"/fitbit/callback",element:(0,sm.jsx)(fm,{})}),(0,sm.jsx)(ge,{path:"/fitbit-dashboard",element:(0,sm.jsx)(Hw,{})}),(0,sm.jsx)(ge,{path:"/dashboard",element:(0,sm.jsx)(t,{children:(0,sm.jsx)(Nw,{})})}),(0,sm.jsx)(ge,{path:"/food-tracker",element:(0,sm.jsx)(t,{children:(0,sm.jsx)(qw,{})})}),(0,sm.jsx)(ge,{path:"/",element:e()?(0,sm.jsx)(me,{to:"/dashboard",replace:!0}):(0,sm.jsx)(me,{to:"/login",replace:!0})}),(0,sm.jsx)(ge,{path:"*",element:(0,sm.jsxs)("div",{className:"not-found",children:[(0,sm.jsx)("h2",{children:"Page Not Found"}),(0,sm.jsx)("p",{children:"The page you're looking for doesn't exist."}),(0,sm.jsxs)("p",{children:["Current path: ",window.location.pathname]}),(0,sm.jsx)("button",{onClick:()=>window.location.href="/",children:"Go Home"})]})})]})})})},Gw=e=>{e&&e instanceof Function&&n.e(488).then(n.bind(n,488)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:a,getTTFB:s}=t;n(e),r(e),i(e),a(e),s(e)}))};s.createRoot(document.getElementById("root")).render((0,sm.jsx)(i.StrictMode,{children:(0,sm.jsx)(Ww,{})})),Gw()})();
//# sourceMappingURL=main.0167f25c.js.map